PRINT '********************** BEGIN - Refresh AR TEMPORARY TABLES **********************'
GO

IF(OBJECT_ID('tempdb..##ARPostInvoiceHeader') IS NOT NULL) DROP TABLE ##ARPostInvoiceHeader
IF(OBJECT_ID('tempdb..##ARPostInvoiceDetail') IS NOT NULL) DROP TABLE ##ARPostInvoiceDetail
IF(OBJECT_ID('tempdb..##ARInvoiceItemAccount') IS NOT NULL) DROP TABLE ##ARInvoiceItemAccount
IF(OBJECT_ID('tempdb..##ARInvalidInvoiceData') IS NOT NULL) DROP TABLE ##ARInvalidInvoiceData
IF(OBJECT_ID('tempdb..##ARItemsForCosting') IS NOT NULL) DROP TABLE ##ARItemsForCosting
IF(OBJECT_ID('tempdb..##ARItemsForInTransitCosting') IS NOT NULL) DROP TABLE ##ARItemsForInTransitCosting
IF(OBJECT_ID('tempdb..##ARItemsForStorageCosting') IS NOT NULL) DROP TABLE ##ARItemsForStorageCosting
IF(OBJECT_ID('tempdb..##ARItemsForContracts') IS NOT NULL) DROP TABLE ##ARItemsForContracts
IF(OBJECT_ID('tempdb..##ARInvoiceGLEntries') IS NOT NULL) DROP TABLE ##ARInvoiceGLEntries

IF EXISTS (SELECT * FROM sys.objects WHERE type = 'P' AND name = 'uspARInitializeTempTableForPosting')
BEGIN
	EXEC [dbo].[uspARInitializeTempTableForPosting]
END

IF(OBJECT_ID('tempdb..##ARPOSTEDPAYMENT') IS NOT NULL) DROP TABLE ##ARPOSTEDPAYMENT
IF(OBJECT_ID('tempdb..##INVOICETOTALPREPAYMENTS') IS NOT NULL) DROP TABLE ##INVOICETOTALPREPAYMENTS
IF(OBJECT_ID('tempdb..##POSTEDINVOICES') IS NOT NULL) DROP TABLE ##POSTEDINVOICES
IF(OBJECT_ID('tempdb..##CASHREFUNDS') IS NOT NULL) DROP TABLE ##CASHREFUNDS
IF(OBJECT_ID('tempdb..##CASHRETURNS') IS NOT NULL) DROP TABLE ##CASHRETURNS
IF(OBJECT_ID('tempdb..##FORGIVENSERVICECHARGE') IS NOT NULL) DROP TABLE ##FORGIVENSERVICECHARGE
IF(OBJECT_ID('tempdb..##AGINGSTAGING') IS NOT NULL) DROP TABLE ##AGINGSTAGING
IF(OBJECT_ID('tempdb..##GLACCOUNTS') IS NOT NULL) DROP TABLE ##GLACCOUNTS
IF(OBJECT_ID('tempdb..##ADCUSTOMERS') IS NOT NULL) DROP TABLE ##ADCUSTOMERS
IF(OBJECT_ID('tempdb..##ADSALESPERSON') IS NOT NULL) DROP TABLE ##ADSALESPERSON
IF(OBJECT_ID('tempdb..##ADLOCATION') IS NOT NULL) DROP TABLE ##ADLOCATION
IF(OBJECT_ID('tempdb..##ADACCOUNTSTATUS') IS NOT NULL) DROP TABLE ##ADACCOUNTSTATUS
IF(OBJECT_ID('tempdb..##DELCUSTOMERS') IS NOT NULL) DROP TABLE ##DELCUSTOMERS
IF(OBJECT_ID('tempdb..##DELLOCATION') IS NOT NULL) DROP TABLE ##DELLOCATION
IF(OBJECT_ID('tempdb..##DELACCOUNTSTATUS') IS NOT NULL) DROP TABLE ##DELACCOUNTSTATUS
IF(OBJECT_ID('tempdb..##CREDITMEMOPAIDREFUNDED') IS NOT NULL) DROP TABLE ##CREDITMEMOPAIDREFUNDED

IF EXISTS (SELECT * FROM sys.objects WHERE type = 'P' AND name = 'uspARInitializeTempTableForAging')
BEGIN
	EXEC [dbo].[uspARInitializeTempTableForAging]
END

PRINT ' ********************** END - Refresh AR TEMPORARY TABLES  **********************'
GO