GO
IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[agordmst]') AND type IN (N'U'))
BEGIN 
	EXEC('
		IF EXISTS (SELECT 1 FROM sys.objects WHERE name = ''uspARImportInvoiceBackupAGORDMST'' and type = ''P'') 
			DROP PROCEDURE [dbo].[uspARImportInvoiceBackupAGORDMST];
	')


IF EXISTS (SELECT 1 FROM sys.objects WHERE name = 'agordmst' and type = 'U') 
BEGIN
	IF EXISTS (SELECT 1 FROM sys.columns WHERE name = 'agord_no_of_months') AND EXISTS (SELECT 1 FROM sys.columns WHERE name = 'agord_final_due_dt') 
	BEGIN 
		EXEC('
			CREATE PROCEDURE [dbo].[uspARImportInvoiceBackupAGORDMST]
				@DateFrom DATETIME = NULL,
				@DateTo DATETIME = NULL,
				@totalagordmst INT OUTPUT
			AS

			SET QUOTED_IDENTIFIER OFF
			SET ANSI_NULLS ON
			SET NOCOUNT ON
			SET XACT_ABORT ON
			SET ANSI_WARNINGS OFF

			BEGIN TRY

			DECLARE @transCount INT = @@TRANCOUNT;

			IF @transCount = 0 BEGIN TRANSACTION

			--BACK UP agordmst
			IF OBJECT_ID(''dbo.tmp_agordmstImport'') IS NOT NULL DROP TABLE tmp_agordmstImport

			CREATE TABLE tmp_agordmstImport(
				[agord_cus_no] [char](10) NOT NULL,
				[agord_ord_no] [char](8) NOT NULL,
				[agord_loc_no] [char](3) NOT NULL,
				[agord_line_no] [smallint] NOT NULL,
				[agord_ivc_no] [char](8) NOT NULL,
				[agord_batch_no] [smallint] NULL,
				[agord_ord_rev_dt] [int] NULL,
				[agord_req_ship_rev_dt] [int] NULL,
				[agord_ship_rev_dt] [int] NULL,
				[agord_type] [char](1) NULL,
				[agord_bill_to_cus] [char](10) NULL,
				[agord_bill_to_split] [char](4) NULL,
				[agord_cash_tendered] [decimal](11, 2) NULL,
				[agord_order_total] [decimal](11, 2) NULL,
				[agord_ship_total] [decimal](11, 2) NULL,
				[agord_disc_total] [decimal](9, 2) NULL,
				[agord_slsmn_id] [char](3) NULL,
				[agord_po_no] [char](15) NOT NULL,
				[agord_terms_cd] [tinyint] NULL,
				[agord_comments] [char](30) NULL,
				[agord_ship_type] [char](1) NULL,
				[agord_srv_chg_cd] [tinyint] NULL,
				[agord_adj_inv_yn] [char](1) NULL,
				[agord_tank_no] [char](4) NULL,
				[agord_lp_pct_full] [smallint] NULL,
				[agord_itm_no] [char](13) NOT NULL,
				[agord_dtl_comments] [char](33) NULL,
				[agord_un_prc] [decimal](11, 5) NULL,
				[agord_pkg_sold] [decimal](11, 4) NULL,
				[agord_un_sold] [decimal](11, 4) NULL,
				[agord_fet_amt] [decimal](11, 2) NULL,
				[agord_fet_rt] [decimal](9, 6) NULL,
				[agord_set_amt] [decimal](11, 2) NULL,
				[agord_set_rt] [decimal](9, 6) NULL,
				[agord_sst_amt] [decimal](11, 2) NULL,
				[agord_sst_rt] [decimal](9, 6) NULL,
				[agord_sst_pu] [char](1) NULL,
				[agord_sst_on_net] [decimal](11, 2) NULL,
				[agord_sst_on_fet] [decimal](11, 2) NULL,
				[agord_sst_on_set] [decimal](11, 2) NULL,
				[agord_sst_on_lc1] [decimal](11, 2) NULL,
				[agord_sst_on_lc2] [decimal](11, 2) NULL,
				[agord_sst_on_lc3] [decimal](11, 2) NULL,
				[agord_sst_on_lc4] [decimal](11, 2) NULL,
				[agord_sst_on_lc5] [decimal](11, 2) NULL,
				[agord_sst_on_lc6] [decimal](11, 2) NULL,
				[agord_lc1_amt] [decimal](11, 2) NULL,
				[agord_lc1_rt] [decimal](9, 6) NULL,
				[agord_lc1_pu] [char](1) NULL,
				[agord_lc1_on_net] [decimal](11, 2) NULL,
				[agord_lc1_on_fet] [decimal](11, 2) NULL,
				[agord_lc2_amt] [decimal](11, 2) NULL,
				[agord_lc2_rt] [decimal](9, 6) NULL,
				[agord_lc2_pu] [char](1) NULL,
				[agord_lc2_on_net] [decimal](11, 2) NULL,
				[agord_lc2_on_fet] [decimal](11, 2) NULL,
				[agord_lc3_amt] [decimal](11, 2) NULL,
				[agord_lc3_rt] [decimal](9, 6) NULL,
				[agord_lc3_pu] [char](1) NULL,
				[agord_lc3_on_net] [decimal](11, 2) NULL,
				[agord_lc3_on_fet] [decimal](11, 2) NULL,
				[agord_lc4_amt] [decimal](11, 2) NULL,
				[agord_lc4_rt] [decimal](9, 6) NULL,
				[agord_lc4_pu] [char](1) NULL,
				[agord_lc4_on_net] [decimal](11, 2) NULL,
				[agord_lc4_on_fet] [decimal](11, 2) NULL,
				[agord_lc5_amt] [decimal](11, 2) NULL,
				[agord_lc5_rt] [decimal](9, 6) NULL,
				[agord_lc5_pu] [char](1) NULL,
				[agord_lc5_on_net] [decimal](11, 2) NULL,
				[agord_lc5_on_fet] [decimal](11, 2) NULL,
				[agord_lc6_amt] [decimal](11, 2) NULL,
				[agord_lc6_rt] [decimal](9, 6) NULL,
				[agord_lc6_pu] [char](1) NULL,
				[agord_lc6_on_net] [decimal](11, 2) NULL,
				[agord_lc6_on_fet] [decimal](11, 2) NULL,
				[agord_pkg_ship] [decimal](11, 4) NULL,
				[agord_un_ship] [decimal](11, 4) NULL,
				[agord_ship_fet_amt] [decimal](11, 2) NULL,
				[agord_ship_fet_rt] [decimal](9, 6) NULL,
				[agord_ship_set_amt] [decimal](11, 2) NULL,
				[agord_ship_set_rt] [decimal](9, 6) NULL,
				[agord_ship_sst_amt] [decimal](11, 2) NULL,
				[agord_ship_sst_rt] [decimal](9, 6) NULL,
				[agord_ship_sst_pu] [char](1) NULL,
				[ship_sst_on_net] [decimal](11, 2) NULL,
				[ship_sst_on_fet] [decimal](11, 2) NULL,
				[ship_sst_on_set] [decimal](11, 2) NULL,
				[ship_sst_on_lc1] [decimal](11, 2) NULL,
				[ship_sst_on_lc2] [decimal](11, 2) NULL,
				[ship_sst_on_lc3] [decimal](11, 2) NULL,
				[ship_sst_on_lc4] [decimal](11, 2) NULL,
				[ship_sst_on_lc5] [decimal](11, 2) NULL,
				[ship_sst_on_lc6] [decimal](11, 2) NULL,
				[agord_ship_lc1_amt] [decimal](11, 2) NULL,
				[agord_ship_lc1_rt] [decimal](9, 6) NULL,
				[agord_ship_lc1_pu] [char](1) NULL,
				[ship_lc1_on_net] [decimal](11, 2) NULL,
				[ship_lc1_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc2_amt] [decimal](11, 2) NULL,
				[agord_ship_lc2_rt] [decimal](9, 6) NULL,
				[agord_ship_lc2_pu] [char](1) NULL,
				[ship_lc2_on_net] [decimal](11, 2) NULL,
				[ship_lc2_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc3_amt] [decimal](11, 2) NULL,
				[agord_ship_lc3_rt] [decimal](9, 6) NULL,
				[agord_ship_lc3_pu] [char](1) NULL,
				[ship_lc3_on_net] [decimal](11, 2) NULL,
				[ship_lc3_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc4_amt] [decimal](11, 2) NULL,
				[agord_ship_lc4_rt] [decimal](9, 6) NULL,
				[agord_ship_lc4_pu] [char](1) NULL,
				[ship_lc4_on_net] [decimal](11, 2) NULL,
				[ship_lc4_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc5_amt] [decimal](11, 2) NULL,
				[agord_ship_lc5_rt] [decimal](9, 6) NULL,
				[agord_ship_lc5_pu] [char](1) NULL,
				[ship_lc5_on_net] [decimal](11, 2) NULL,
				[ship_lc5_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc6_amt] [decimal](11, 2) NULL,
				[agord_ship_lc6_rt] [decimal](9, 6) NULL,
				[agord_ship_lc6_pu] [char](1) NULL,
				[ship_lc6_on_net] [decimal](11, 2) NULL,
				[ship_lc6_on_fet] [decimal](11, 2) NULL,
				[agord_tax_state] [char](2) NULL,
				[agord_tax_auth_id1] [char](3) NULL,
				[agord_tax_auth_id2] [char](3) NULL,
				[agord_county] [char](3) NULL,
				[agord_ppd_dep_per_un] [decimal](11, 5) NULL,
				[agord_lot_no_yn] [char](1) NULL,
				[agord_load_no] [char](8) NULL,
				[agord_bckord_yn] [char](1) NULL,
				[agord_cnt_cus_no] [char](10) NULL,
				[agord_cnt_no] [char](8) NULL,
				[agord_cnt_line_no] [smallint] NULL,
				[agord_blend_yn] [char](1) NULL,
				[agord_disc_amt] [decimal](9, 2) NULL,
				[agord_ppd_cnt_yndm] [char](1) NULL,
				[agord_gl_acct] [decimal](16, 8) NULL,
				[agord_applicator_no] [char](10) NULL,
				[agord_acct_stat] [char](1) NULL,
				[agord_sst_ynp] [char](1) NULL,
				[agord_un_cost] [decimal](11, 5) NULL,
				[agord_src_sys] [char](3) NULL,
				[agord_pay_pat_yn] [char](1) NULL,
				[agord_prc_lvl] [tinyint] NULL,
				[agord_dlvr_pkup_ind] [char](1) NULL,
				[agord_currency] [char](3) NULL,
				[agord_currency_rt] [decimal](15, 8) NULL,
				[agord_currency_cnt] [char](8) NULL,
				[agord_hide_price_ynq] [char](1) NULL,
				[agord_order_taker] [char](3) NULL,
				[agord_xfer_exp_yn] [char](1) NULL,
				[agord_ingr_on_ivc_yn] [char](1) NULL,
				[agord_gb_updated_yn] [char](1) NULL,
				[agord_tm_mtr_read] [decimal](11, 4) NULL,
				[agord_tm_perf_id] [char](3) NULL,
				[agord_nutri_file_name] [char](50) NULL,
				[agord_user_id] [char](16) NULL,
				[agord_user_rev_dt] [int] NULL,
				[agord_user_time] [int] NULL,
				[agord_no_of_months] [tinyint] NULL,
				[agord_final_due_dt] [int] NULL,
				[A4GLIdentity] [numeric](9, 0) NOT NULL,
				[intBackupId]			INT NULL, --Use this to update the linking between the back up and created voucher
				[intId]			INT IDENTITY(1,1) NOT NULL,
				CONSTRAINT [k_tmpagordmst] PRIMARY KEY NONCLUSTERED (
						[agord_cus_no] ASC,
						[agord_ord_no] ASC,
						[agord_loc_no] ASC,
						[agord_line_no] ASC
				)
			)

			--BACK UP RECORDS TO BE IMPORTED FROM agordmst
			IF @DateFrom IS NULL --ONE TIME IMPORT
			BEGIN
				INSERT INTO tmp_agordmstImport
				(      [agord_ord_no]                
						,[agord_loc_no]				 
						,[agord_line_no]				 
						,[agord_ivc_no]				 
						,[agord_batch_no]			     
						,[agord_ord_rev_dt]			 
						,[agord_req_ship_rev_dt]		 
						,[agord_ship_rev_dt]			 
						,[agord_type]				     
						,[agord_bill_to_cus]			 
						,[agord_bill_to_split]		 
						,[agord_cash_tendered]		 
						,[agord_order_total]		     
						,[agord_ship_total]			 
						,[agord_disc_total]			 
						,[agord_slsmn_id]				 
						,[agord_po_no]			     
						,[agord_terms_cd]				 
						,[agord_comments]				 
						,[agord_ship_type]			 
						,[agord_srv_chg_cd]		     
						,[agord_adj_inv_yn]			 
						,[agord_tank_no]				 
						,[agord_lp_pct_full]			 
						,[agord_itm_no]			     
						,[agord_dtl_comments]			 
						,[agord_un_prc]				 
						,[agord_pkg_sold]				 
						,[agord_un_sold]			     
						,[agord_fet_amt]				 
						,[agord_fet_rt]				 
						,[agord_set_amt]				 
						,[agord_set_rt]			     
						,[agord_sst_amt]				 
						,[agord_sst_rt]				 
						,[agord_sst_pu]				 
						,[agord_sst_on_net]		     
						,[agord_sst_on_fet]			 
						,[agord_sst_on_set]			 
						,[agord_sst_on_lc1]			 
						,[agord_sst_on_lc2]		     
						,[agord_sst_on_lc3]			 
						,[agord_sst_on_lc4]			 
						,[agord_sst_on_lc5]			 
						,[agord_sst_on_lc6]		     
						,[agord_lc1_amt]				 
						,[agord_lc1_rt]				 
						,[agord_lc1_pu]				 
						,[agord_lc1_on_net]		     
						,[agord_lc1_on_fet]			 
						,[agord_lc2_amt]				 
						,[agord_lc2_rt]				 
						,[agord_lc2_pu]			     
						,[agord_lc2_on_net]			 
						,[agord_lc2_on_fet]			 
						,[agord_lc3_amt]				 
						,[agord_lc3_rt]			     
						,[agord_lc3_pu]				 
						,[agord_lc3_on_net]			 
						,[agord_lc3_on_fet]			 
						,[agord_lc4_amt]			     
						,[agord_lc4_rt]				 
						,[agord_lc4_pu]				 
						,[agord_lc4_on_net]			 
						,[agord_lc4_on_fet]		     
						,[agord_lc5_amt]				 
						,[agord_lc5_rt]				 
						,[agord_lc5_pu]				 
						,[agord_lc5_on_net]		     
						,[agord_lc5_on_fet]			 
						,[agord_lc6_amt]				 
						,[agord_lc6_rt]				 
						,[agord_lc6_pu]			     
						,[agord_lc6_on_net]			 
						,[agord_lc6_on_fet]			 
						,[agord_pkg_ship]				 
						,[agord_un_ship]			     
						,[agord_ship_fet_amt]			 
						,[agord_ship_fet_rt]			 
						,[agord_ship_set_amt]			 
						,[agord_ship_set_rt]		     
						,[agord_ship_sst_amt]			 
						,[agord_ship_sst_rt]			 
						,[agord_ship_sst_pu]			 
						,[ship_sst_on_net]		     
						,[ship_sst_on_fet]			 
						,[ship_sst_on_set]			 
						,[ship_sst_on_lc1]			 
						,[ship_sst_on_lc2]		     
						,[ship_sst_on_lc3]			 
						,[ship_sst_on_lc4]			 
						,[ship_sst_on_lc5]			 
						,[ship_sst_on_lc6]		     
						,[agord_ship_lc1_amt]			 
						,[agord_ship_lc1_rt]			 
						,[agord_ship_lc1_pu]			 
						,[ship_lc1_on_net]		     
						,[ship_lc1_on_fet]			 
						,[agord_ship_lc2_amt]			 
						,[agord_ship_lc2_rt]			 
						,[agord_ship_lc2_pu]		     
						,[ship_lc2_on_net]			 
						,[ship_lc2_on_fet]			 
						,[agord_ship_lc3_amt]			 
						,[agord_ship_lc3_rt]		     
						,[agord_ship_lc3_pu]			 
						,[ship_lc3_on_net]			 
						,[ship_lc3_on_fet]			 
						,[agord_ship_lc4_amt]		     
						,[agord_ship_lc4_rt]			 
						,[agord_ship_lc4_pu]			 
						,[ship_lc4_on_net]			 
						,[ship_lc4_on_fet]		     
						,[agord_ship_lc5_amt]			 
						,[agord_ship_lc5_rt]			 
						,[agord_ship_lc5_pu]			 
						,[ship_lc5_on_net]		     
						,[ship_lc5_on_fet]			 
						,[agord_ship_lc6_amt]			 
						,[agord_ship_lc6_rt]			 
						,[agord_ship_lc6_pu]		     
						,[ship_lc6_on_net]			 
						,[ship_lc6_on_fet]			 
						,[agord_tax_state]			 
						,[agord_tax_auth_id1]		     
						,[agord_tax_auth_id2]			 
						,[agord_county]				 
						,[agord_ppd_dep_per_un]		 
						,[agord_lot_no_yn]		     
						,[agord_load_no]				 
						,[agord_bckord_yn]			 
						,[agord_cnt_cus_no]			 
						,[agord_cnt_no]			     
						,[agord_cnt_line_no]			 
						,[agord_blend_yn]				 
						,[agord_disc_amt]				 
						,[agord_ppd_cnt_yndm]		     
						,[agord_gl_acct]				 
						,[agord_applicator_no]		 
						,[agord_acct_stat]			 
						,[agord_sst_ynp]			     
						,[agord_un_cost]				 
						,[agord_src_sys]				 
						,[agord_pay_pat_yn]			 
						,[agord_prc_lvl]			     
						,[agord_dlvr_pkup_ind]		 
						,[agord_currency]				 
						,[agord_currency_rt]			 
						,[agord_currency_cnt]		     
						,[agord_hide_price_ynq]		 
						,[agord_order_taker]			 
						,[agord_xfer_exp_yn]			 
						,[agord_ingr_on_ivc_yn]	     
						,[agord_gb_updated_yn]		 
						,[agord_tm_mtr_read]			 
						,[agord_tm_perf_id]			 
						,[agord_nutri_file_name]	     
						,[agord_user_id]				 
						,[agord_user_rev_dt]			 
						,[agord_user_time]			 
						,[agord_no_of_months]		     
						,[agord_final_due_dt]			 
						,[A4GLIdentity])				 
										 
				SELECT
						[agord_ord_no]                =   A.[agord_ord_no]
						,[agord_loc_no]				 =	 A.[agord_loc_no]
						,[agord_line_no]				 =   A.[agord_line_no]
						,[agord_ivc_no]				 =	 A.[agord_ivc_no]
						,[agord_batch_no]			     =   A.[agord_batch_no]
						,[agord_ord_rev_dt]			 =	 A.[agord_ord_rev_dt]
						,[agord_req_ship_rev_dt]		 =   A.[agord_req_ship_rev_dt]
						,[agord_ship_rev_dt]			 =	 A.[agord_ship_rev_dt]
						,[agord_type]				     =   A.[agord_type]
						,[agord_bill_to_cus]			 =	 A.[agord_bill_to_cus]
						,[agord_bill_to_split]		 =   A.[agord_bill_to_split]
						,[agord_cash_tendered]		 =	 A.[agord_cash_tendered]
						,[agord_order_total]		     =   A.[agord_order_total]
						,[agord_ship_total]			 =	 A.[agord_ship_total]
						,[agord_disc_total]			 =   A.[agord_disc_total]
						,[agord_slsmn_id]				 =	 A.[agord_slsmn_id]
						,[agord_po_no]			     =   A.[agord_po_no]
						,[agord_terms_cd]				 =	 A.[agord_terms_cd]
						,[agord_comments]				 =   A.[agord_comments]
						,[agord_ship_type]			 =	 A.[agord_ship_type]
						,[agord_srv_chg_cd]		     =   A.[agord_srv_chg_cd]
						,[agord_adj_inv_yn]			 =	 A.[agord_adj_inv_yn]
						,[agord_tank_no]				 =   A.[agord_tank_no]
						,[agord_lp_pct_full]			 =	 A.[agord_lp_pct_full]
						,[agord_itm_no]			     =   A.[agord_itm_no]
						,[agord_dtl_comments]			 =	 A.[agord_dtl_comments]
						,[agord_un_prc]				 =   A.[agord_un_prc]
						,[agord_pkg_sold]				 =	 A.[agord_pkg_sold]
						,[agord_un_sold]			     =   A.[agord_un_sold]
						,[agord_fet_amt]				 =	 A.[agord_fet_amt]
						,[agord_fet_rt]				 =   A.[agord_fet_rt]
						,[agord_set_amt]				 =	 A.[agord_set_amt]
						,[agord_set_rt]			     =   A.[agord_set_rt]
						,[agord_sst_amt]				 =	 A.[agord_sst_amt]
						,[agord_sst_rt]				 =   A.[agord_sst_rt]
						,[agord_sst_pu]				 =	 A.[agord_sst_pu]
						,[agord_sst_on_net]		     =   A.[agord_sst_on_net]
						,[agord_sst_on_fet]			 =	 A.[agord_sst_on_fet]
						,[agord_sst_on_set]			 =   A.[agord_sst_on_set]
						,[agord_sst_on_lc1]			 =	 A.[agord_sst_on_lc1]
						,[agord_sst_on_lc2]		     =   A.[agord_sst_on_lc2]
						,[agord_sst_on_lc3]			 =	 A.[agord_sst_on_lc3]
						,[agord_sst_on_lc4]			 =   A.[agord_sst_on_lc4]
						,[agord_sst_on_lc5]			 =	 A.[agord_sst_on_lc5]
						,[agord_sst_on_lc6]		     =   A.[agord_sst_on_lc6]
						,[agord_lc1_amt]				 =	 A.[agord_lc1_amt]
						,[agord_lc1_rt]				 =   A.[agord_lc1_rt]
						,[agord_lc1_pu]				 =	 A.[agord_lc1_pu]
						,[agord_lc1_on_net]		     =   A.[agord_lc1_on_net]
						,[agord_lc1_on_fet]			 =	 A.[agord_lc1_on_fet]
						,[agord_lc2_amt]				 =   A.[agord_lc2_amt]
						,[agord_lc2_rt]				 =	 A.[agord_lc2_rt]
						,[agord_lc2_pu]			     =   A.[agord_lc2_pu]
						,[agord_lc2_on_net]			 =	 A.[agord_lc2_on_net]
						,[agord_lc2_on_fet]			 =   A.[agord_lc2_on_fet]
						,[agord_lc3_amt]				 =	 A.[agord_lc3_amt]
						,[agord_lc3_rt]			     =   A.[agord_lc3_rt]
						,[agord_lc3_pu]				 =	 A.[agord_lc3_pu]
						,[agord_lc3_on_net]			 =   A.[agord_lc3_on_net]
						,[agord_lc3_on_fet]			 =	 A.[agord_lc3_on_fet]
						,[agord_lc4_amt]			     =   A.[agord_lc4_amt]
						,[agord_lc4_rt]				 =	 A.[agord_lc4_rt]
						,[agord_lc4_pu]				 =   A.[agord_lc4_pu]
						,[agord_lc4_on_net]			 =	 A.[agord_lc4_on_net]
						,[agord_lc4_on_fet]		     =   A.[agord_lc4_on_fet]
						,[agord_lc5_amt]				 =	 A.[agord_lc5_amt]
						,[agord_lc5_rt]				 =   A.[agord_lc5_rt]
						,[agord_lc5_pu]				 =	 A.[agord_lc5_pu]
						,[agord_lc5_on_net]		     =   A.[agord_lc5_on_net]
						,[agord_lc5_on_fet]			 =	 A.[agord_lc5_on_fet]
						,[agord_lc6_amt]				 =   A.[agord_lc6_amt]
						,[agord_lc6_rt]				 =	 A.[agord_lc6_rt]
						,[agord_lc6_pu]			     =   A.[agord_lc6_pu]
						,[agord_lc6_on_net]			 =	 A.[agord_lc6_on_net]
						,[agord_lc6_on_fet]			 =   A.[agord_lc6_on_fet]
						,[agord_pkg_ship]				 =	 A.[agord_pkg_ship]
						,[agord_un_ship]			     =   A.[agord_un_ship]
						,[agord_ship_fet_amt]			 =	 A.[agord_ship_fet_amt]
						,[agord_ship_fet_rt]			 =   A.[agord_ship_fet_rt]
						,[agord_ship_set_amt]			 =	 A.[agord_ship_set_amt]
						,[agord_ship_set_rt]		     =   A.[agord_ship_set_rt]
						,[agord_ship_sst_amt]			 =	 A.[agord_ship_sst_amt]
						,[agord_ship_sst_rt]			 =   A.[agord_ship_sst_rt]
						,[agord_ship_sst_pu]			 =	 A.[agord_ship_sst_pu]
						,[ship_sst_on_net]		     =   A.[ship_sst_on_net]
						,[ship_sst_on_fet]			 =	 A.[ship_sst_on_fet]
						,[ship_sst_on_set]			 =   A.[ship_sst_on_set]
						,[ship_sst_on_lc1]			 =	 A.[ship_sst_on_lc1]
						,[ship_sst_on_lc2]		     =   A.[ship_sst_on_lc2]
						,[ship_sst_on_lc3]			 =	 A.[ship_sst_on_lc3]
						,[ship_sst_on_lc4]			 =   A.[ship_sst_on_lc4]
						,[ship_sst_on_lc5]			 =	 A.[ship_sst_on_lc5]
						,[ship_sst_on_lc6]		     =   A.[ship_sst_on_lc6]
						,[agord_ship_lc1_amt]			 =	 A.[agord_ship_lc1_amt]
						,[agord_ship_lc1_rt]			 =   A.[agord_ship_lc1_rt]
						,[agord_ship_lc1_pu]			 =	 A.[agord_ship_lc1_pu]
						,[ship_lc1_on_net]		     =   A.[ship_lc1_on_net]
						,[ship_lc1_on_fet]			 =	 A.[ship_lc1_on_fet]
						,[agord_ship_lc2_amt]			 =   A.[agord_ship_lc2_amt]
						,[agord_ship_lc2_rt]			 =	 A.[agord_ship_lc2_rt]
						,[agord_ship_lc2_pu]		     =   A.[agord_ship_lc2_pu]
						,[ship_lc2_on_net]			 =	 A.[ship_lc2_on_net]
						,[ship_lc2_on_fet]			 =   A.[ship_lc2_on_fet]
						,[agord_ship_lc3_amt]			 =	 A.[agord_ship_lc3_amt]
						,[agord_ship_lc3_rt]		     =   A.[agord_ship_lc3_rt]
						,[agord_ship_lc3_pu]			 =	 A.[agord_ship_lc3_pu]
						,[ship_lc3_on_net]			 =   A.[ship_lc3_on_net]
						,[ship_lc3_on_fet]			 =	 A.[ship_lc3_on_fet]
						,[agord_ship_lc4_amt]		     =   A.[agord_ship_lc4_amt]
						,[agord_ship_lc4_rt]			 =	 A.[agord_ship_lc4_rt]
						,[agord_ship_lc4_pu]			 =   A.[agord_ship_lc4_pu]
						,[ship_lc4_on_net]			 =	 A.[ship_lc4_on_net]
						,[ship_lc4_on_fet]		     =   A.[ship_lc4_on_fet]
						,[agord_ship_lc5_amt]			 =	 A.[agord_ship_lc5_amt]
						,[agord_ship_lc5_rt]			 =   A.[agord_ship_lc5_rt]
						,[agord_ship_lc5_pu]			 =	 A.[agord_ship_lc5_pu]
						,[ship_lc5_on_net]		     =   A.[ship_lc5_on_net]
						,[ship_lc5_on_fet]			 =	 A.[ship_lc5_on_fet]
						,[agord_ship_lc6_amt]			 =   A.[agord_ship_lc6_amt]
						,[agord_ship_lc6_rt]			 =	 A.[agord_ship_lc6_rt]
						,[agord_ship_lc6_pu]		     =   A.[agord_ship_lc6_pu]
						,[ship_lc6_on_net]			 =	 A.[ship_lc6_on_net]
						,[ship_lc6_on_fet]			 =   A.[ship_lc6_on_fet]
						,[agord_tax_state]			 =	 A.[agord_tax_state]
						,[agord_tax_auth_id1]		     =   A.[agord_tax_auth_id1]
						,[agord_tax_auth_id2]			 =	 A.[agord_tax_auth_id2]
						,[agord_county]				 =   A.[agord_county]
						,[agord_ppd_dep_per_un]		 =	 A.[agord_ppd_dep_per_un]
						,[agord_lot_no_yn]		     =   A.[agord_lot_no_yn]
						,[agord_load_no]				 =	 A.[agord_load_no]
						,[agord_bckord_yn]			 =   A.[agord_bckord_yn]
						,[agord_cnt_cus_no]			 =	 A.[agord_cnt_cus_no]
						,[agord_cnt_no]			     =   A.[agord_cnt_no]
						,[agord_cnt_line_no]			 =	 A.[agord_cnt_line_no]
						,[agord_blend_yn]				 =   A.[agord_blend_yn]
						,[agord_disc_amt]				 =	 A.[agord_disc_amt]
						,[agord_ppd_cnt_yndm]		     =   A.[agord_ppd_cnt_yndm]
						,[agord_gl_acct]				 =	 A.[agord_gl_acct]
						,[agord_applicator_no]		 =   A.[agord_applicator_no]
						,[agord_acct_stat]			 =	 A.[agord_acct_stat]
						,[agord_sst_ynp]			     =   A.[agord_sst_ynp]
						,[agord_un_cost]				 =	 A.[agord_un_cost]
						,[agord_src_sys]				 =   A.[agord_src_sys]
						,[agord_pay_pat_yn]			 =	 A.[agord_pay_pat_yn]
						,[agord_prc_lvl]			     =   A.[agord_prc_lvl]
						,[agord_dlvr_pkup_ind]		 =	 A.[agord_dlvr_pkup_ind]
						,[agord_currency]				 =   A.[agord_currency]
						,[agord_currency_rt]			 =	 A.[agord_currency_rt]
						,[agord_currency_cnt]		     =   A.[agord_currency_cnt]
						,[agord_hide_price_ynq]		 =	 A.[agord_hide_price_ynq]
						,[agord_order_taker]			 =   A.[agord_order_taker]
						,[agord_xfer_exp_yn]			 =	 A.[agord_xfer_exp_yn]
						,[agord_ingr_on_ivc_yn]	     =   A.[agord_ingr_on_ivc_yn]
						,[agord_gb_updated_yn]		 =	 A.[agord_gb_updated_yn]
						,[agord_tm_mtr_read]			 =   A.[agord_tm_mtr_read]
						,[agord_tm_perf_id]			 =	 A.[agord_tm_perf_id]
						,[agord_nutri_file_name]	     =   A.[agord_nutri_file_name]
						,[agord_user_id]				 =	 A.[agord_user_id]
						,[agord_user_rev_dt]			 =   A.[agord_user_rev_dt]
						,[agord_user_time]			 =	 A.[agord_user_time] 
						,[agord_no_of_months]			 =  A.[agord_no_of_months]
						,[agord_final_due_dt]			 =  A.[agord_final_due_dt]		  
						,[A4GLIdentity]				 =   A.[A4GLIdentity]			
				FROM agordmst A
				WHERE A.agord_type <> ''O''
			END
			ELSE
			BEGIN
				INSERT INTO tmp_agordmstImport
				(      [agord_ord_no]
						,[agord_loc_no]
						,[agord_line_no]
						,[agord_ivc_no]
						,[agord_batch_no]
						,[agord_ord_rev_dt]
						,[agord_req_ship_rev_dt]
						,[agord_ship_rev_dt]
						,[agord_type]
						,[agord_bill_to_cus]
						,[agord_bill_to_split]
						,[agord_cash_tendered]
						,[agord_order_total]
						,[agord_ship_total]
						,[agord_disc_total]
						,[agord_slsmn_id]
						,[agord_po_no]
						,[agord_terms_cd]
						,[agord_comments]
						,[agord_ship_type]
						,[agord_srv_chg_cd]
						,[agord_adj_inv_yn]
						,[agord_tank_no]
						,[agord_lp_pct_full]
						,[agord_itm_no]
						,[agord_dtl_comments]
						,[agord_un_prc]
						,[agord_pkg_sold]
						,[agord_un_sold]
						,[agord_fet_amt]
						,[agord_fet_rt]
						,[agord_set_amt]
						,[agord_set_rt]
						,[agord_sst_amt]
						,[agord_sst_rt]
						,[agord_sst_pu]
						,[agord_sst_on_net]
						,[agord_sst_on_fet]
						,[agord_sst_on_set]
						,[agord_sst_on_lc1]
						,[agord_sst_on_lc2]
						,[agord_sst_on_lc3]
						,[agord_sst_on_lc4]
						,[agord_sst_on_lc5]
						,[agord_sst_on_lc6]
						,[agord_lc1_amt]
						,[agord_lc1_rt]
						,[agord_lc1_pu]
						,[agord_lc1_on_net]
						,[agord_lc1_on_fet]
						,[agord_lc2_amt]
						,[agord_lc2_rt]
						,[agord_lc2_pu]
						,[agord_lc2_on_net]
						,[agord_lc2_on_fet]
						,[agord_lc3_amt]
						,[agord_lc3_rt]
						,[agord_lc3_pu]
						,[agord_lc3_on_net]
						,[agord_lc3_on_fet]
						,[agord_lc4_amt]
						,[agord_lc4_rt]
						,[agord_lc4_pu]
						,[agord_lc4_on_net]
						,[agord_lc4_on_fet]
						,[agord_lc5_amt]
						,[agord_lc5_rt]
						,[agord_lc5_pu]
						,[agord_lc5_on_net]
						,[agord_lc5_on_fet]
						,[agord_lc6_amt]
						,[agord_lc6_rt]
						,[agord_lc6_pu]
						,[agord_lc6_on_net]
						,[agord_lc6_on_fet]
						,[agord_pkg_ship]
						,[agord_un_ship]
						,[agord_ship_fet_amt]
						,[agord_ship_fet_rt]
						,[agord_ship_set_amt]
						,[agord_ship_set_rt]
						,[agord_ship_sst_amt]
						,[agord_ship_sst_rt]
						,[agord_ship_sst_pu]
						,[ship_sst_on_net]
						,[ship_sst_on_fet]
						,[ship_sst_on_set]
						,[ship_sst_on_lc1]
						,[ship_sst_on_lc2]
						,[ship_sst_on_lc3]
						,[ship_sst_on_lc4]
						,[ship_sst_on_lc5]
						,[ship_sst_on_lc6]
						,[agord_ship_lc1_amt]
						,[agord_ship_lc1_rt]
						,[agord_ship_lc1_pu]
						,[ship_lc1_on_net]
						,[ship_lc1_on_fet]
						,[agord_ship_lc2_amt]
						,[agord_ship_lc2_rt]
						,[agord_ship_lc2_pu]
						,[ship_lc2_on_net]
						,[ship_lc2_on_fet]
						,[agord_ship_lc3_amt]
						,[agord_ship_lc3_rt]
						,[agord_ship_lc3_pu]
						,[ship_lc3_on_net]
						,[ship_lc3_on_fet]
						,[agord_ship_lc4_amt]
						,[agord_ship_lc4_rt]
						,[agord_ship_lc4_pu]
						,[ship_lc4_on_net]
						,[ship_lc4_on_fet]
						,[agord_ship_lc5_amt]
						,[agord_ship_lc5_rt]
						,[agord_ship_lc5_pu]
						,[ship_lc5_on_net]
						,[ship_lc5_on_fet]
						,[agord_ship_lc6_amt]
						,[agord_ship_lc6_rt]
						,[agord_ship_lc6_pu]
						,[ship_lc6_on_net]
						,[ship_lc6_on_fet]
						,[agord_tax_state]
						,[agord_tax_auth_id1]
						,[agord_tax_auth_id2]
						,[agord_county]
						,[agord_ppd_dep_per_un]
						,[agord_lot_no_yn]
						,[agord_load_no]
						,[agord_bckord_yn]
						,[agord_cnt_cus_no]
						,[agord_cnt_no]
						,[agord_cnt_line_no]
						,[agord_blend_yn]
						,[agord_disc_amt]
						,[agord_ppd_cnt_yndm]
						,[agord_gl_acct]
						,[agord_applicator_no]
						,[agord_acct_stat]
						,[agord_sst_ynp]
						,[agord_un_cost]
						,[agord_src_sys]
						,[agord_pay_pat_yn]
						,[agord_prc_lvl]
						,[agord_dlvr_pkup_ind]
						,[agord_currency]
						,[agord_currency_rt]
						,[agord_currency_cnt]
						,[agord_hide_price_ynq]
						,[agord_order_taker]
						,[agord_xfer_exp_yn]
						,[agord_ingr_on_ivc_yn]
						,[agord_gb_updated_yn]
						,[agord_tm_mtr_read]
						,[agord_tm_perf_id]
						,[agord_nutri_file_name]
						,[agord_user_id]
						,[agord_user_rev_dt]
						,[agord_user_time]
						,[agord_no_of_months]
						,[agord_final_due_dt]
						,[A4GLIdentity])

				SELECT
						[agord_ord_no]                =   A.[agord_ord_no]
						,[agord_loc_no]				 =	 A.[agord_loc_no]
						,[agord_line_no]				 =   A.[agord_line_no]
						,[agord_ivc_no]				 =	 A.[agord_ivc_no]
						,[agord_batch_no]			     =   A.[agord_batch_no]
						,[agord_ord_rev_dt]			 =	 A.[agord_ord_rev_dt]
						,[agord_req_ship_rev_dt]		 =   A.[agord_req_ship_rev_dt]
						,[agord_ship_rev_dt]			 =	 A.[agord_ship_rev_dt]
						,[agord_type]				     =   A.[agord_type]
						,[agord_bill_to_cus]			 =	 A.[agord_bill_to_cus]
						,[agord_bill_to_split]		 =   A.[agord_bill_to_split]
						,[agord_cash_tendered]		 =	 A.[agord_cash_tendered]
						,[agord_order_total]		     =   A.[agord_order_total]
						,[agord_ship_total]			 =	 A.[agord_ship_total]
						,[agord_disc_total]			 =   A.[agord_disc_total]
						,[agord_slsmn_id]				 =	 A.[agord_slsmn_id]
						,[agord_po_no]			     =   A.[agord_po_no]
						,[agord_terms_cd]				 =	 A.[agord_terms_cd]
						,[agord_comments]				 =   A.[agord_comments]
						,[agord_ship_type]			 =	 A.[agord_ship_type]
						,[agord_srv_chg_cd]		     =   A.[agord_srv_chg_cd]
						,[agord_adj_inv_yn]			 =	 A.[agord_adj_inv_yn]
						,[agord_tank_no]				 =   A.[agord_tank_no]
						,[agord_lp_pct_full]			 =	 A.[agord_lp_pct_full]
						,[agord_itm_no]			     =   A.[agord_itm_no]
						,[agord_dtl_comments]			 =	 A.[agord_dtl_comments]
						,[agord_un_prc]				 =   A.[agord_un_prc]
						,[agord_pkg_sold]				 =	 A.[agord_pkg_sold]
						,[agord_un_sold]			     =   A.[agord_un_sold]
						,[agord_fet_amt]				 =	 A.[agord_fet_amt]
						,[agord_fet_rt]				 =   A.[agord_fet_rt]
						,[agord_set_amt]				 =	 A.[agord_set_amt]
						,[agord_set_rt]			     =   A.[agord_set_rt]
						,[agord_sst_amt]				 =	 A.[agord_sst_amt]
						,[agord_sst_rt]				 =   A.[agord_sst_rt]
						,[agord_sst_pu]				 =	 A.[agord_sst_pu]
						,[agord_sst_on_net]		     =   A.[agord_sst_on_net]
						,[agord_sst_on_fet]			 =	 A.[agord_sst_on_fet]
						,[agord_sst_on_set]			 =   A.[agord_sst_on_set]
						,[agord_sst_on_lc1]			 =	 A.[agord_sst_on_lc1]
						,[agord_sst_on_lc2]		     =   A.[agord_sst_on_lc2]
						,[agord_sst_on_lc3]			 =	 A.[agord_sst_on_lc3]
						,[agord_sst_on_lc4]			 =   A.[agord_sst_on_lc4]
						,[agord_sst_on_lc5]			 =	 A.[agord_sst_on_lc5]
						,[agord_sst_on_lc6]		     =   A.[agord_sst_on_lc6]
						,[agord_lc1_amt]				 =	 A.[agord_lc1_amt]
						,[agord_lc1_rt]				 =   A.[agord_lc1_rt]
						,[agord_lc1_pu]				 =	 A.[agord_lc1_pu]
						,[agord_lc1_on_net]		     =   A.[agord_lc1_on_net]
						,[agord_lc1_on_fet]			 =	 A.[agord_lc1_on_fet]
						,[agord_lc2_amt]				 =   A.[agord_lc2_amt]
						,[agord_lc2_rt]				 =	 A.[agord_lc2_rt]
						,[agord_lc2_pu]			     =   A.[agord_lc2_pu]
						,[agord_lc2_on_net]			 =	 A.[agord_lc2_on_net]
						,[agord_lc2_on_fet]			 =   A.[agord_lc2_on_fet]
						,[agord_lc3_amt]				 =	 A.[agord_lc3_amt]
						,[agord_lc3_rt]			     =   A.[agord_lc3_rt]
						,[agord_lc3_pu]				 =	 A.[agord_lc3_pu]
						,[agord_lc3_on_net]			 =   A.[agord_lc3_on_net]
						,[agord_lc3_on_fet]			 =	 A.[agord_lc3_on_fet]
						,[agord_lc4_amt]			     =   A.[agord_lc4_amt]
						,[agord_lc4_rt]				 =	 A.[agord_lc4_rt]
						,[agord_lc4_pu]				 =   A.[agord_lc4_pu]
						,[agord_lc4_on_net]			 =	 A.[agord_lc4_on_net]
						,[agord_lc4_on_fet]		     =   A.[agord_lc4_on_fet]
						,[agord_lc5_amt]				 =	 A.[agord_lc5_amt]
						,[agord_lc5_rt]				 =   A.[agord_lc5_rt]
						,[agord_lc5_pu]				 =	 A.[agord_lc5_pu]
						,[agord_lc5_on_net]		     =   A.[agord_lc5_on_net]
						,[agord_lc5_on_fet]			 =	 A.[agord_lc5_on_fet]
						,[agord_lc6_amt]				 =   A.[agord_lc6_amt]
						,[agord_lc6_rt]				 =	 A.[agord_lc6_rt]
						,[agord_lc6_pu]			     =   A.[agord_lc6_pu]
						,[agord_lc6_on_net]			 =	 A.[agord_lc6_on_net]
						,[agord_lc6_on_fet]			 =   A.[agord_lc6_on_fet]
						,[agord_pkg_ship]				 =	 A.[agord_pkg_ship]
						,[agord_un_ship]			     =   A.[agord_un_ship]
						,[agord_ship_fet_amt]			 =	 A.[agord_ship_fet_amt]
						,[agord_ship_fet_rt]			 =   A.[agord_ship_fet_rt]
						,[agord_ship_set_amt]			 =	 A.[agord_ship_set_amt]
						,[agord_ship_set_rt]		     =   A.[agord_ship_set_rt]
						,[agord_ship_sst_amt]			 =	 A.[agord_ship_sst_amt]
						,[agord_ship_sst_rt]			 =   A.[agord_ship_sst_rt]
						,[agord_ship_sst_pu]			 =	 A.[agord_ship_sst_pu]
						,[ship_sst_on_net]		     =   A.[ship_sst_on_net]
						,[ship_sst_on_fet]			 =	 A.[ship_sst_on_fet]
						,[ship_sst_on_set]			 =   A.[ship_sst_on_set]
						,[ship_sst_on_lc1]			 =	 A.[ship_sst_on_lc1]
						,[ship_sst_on_lc2]		     =   A.[ship_sst_on_lc2]
						,[ship_sst_on_lc3]			 =	 A.[ship_sst_on_lc3]
						,[ship_sst_on_lc4]			 =   A.[ship_sst_on_lc4]
						,[ship_sst_on_lc5]			 =	 A.[ship_sst_on_lc5]
						,[ship_sst_on_lc6]		     =   A.[ship_sst_on_lc6]
						,[agord_ship_lc1_amt]			 =	 A.[agord_ship_lc1_amt]
						,[agord_ship_lc1_rt]			 =   A.[agord_ship_lc1_rt]
						,[agord_ship_lc1_pu]			 =	 A.[agord_ship_lc1_pu]
						,[ship_lc1_on_net]		     =   A.[ship_lc1_on_net]
						,[ship_lc1_on_fet]			 =	 A.[ship_lc1_on_fet]
						,[agord_ship_lc2_amt]			 =   A.[agord_ship_lc2_amt]
						,[agord_ship_lc2_rt]			 =	 A.[agord_ship_lc2_rt]
						,[agord_ship_lc2_pu]		     =   A.[agord_ship_lc2_pu]
						,[ship_lc2_on_net]			 =	 A.[ship_lc2_on_net]
						,[ship_lc2_on_fet]			 =   A.[ship_lc2_on_fet]
						,[agord_ship_lc3_amt]			 =	 A.[agord_ship_lc3_amt]
						,[agord_ship_lc3_rt]		     =   A.[agord_ship_lc3_rt]
						,[agord_ship_lc3_pu]			 =	 A.[agord_ship_lc3_pu]
						,[ship_lc3_on_net]			 =   A.[ship_lc3_on_net]
						,[ship_lc3_on_fet]			 =	 A.[ship_lc3_on_fet]
						,[agord_ship_lc4_amt]		     =   A.[agord_ship_lc4_amt]
						,[agord_ship_lc4_rt]			 =	 A.[agord_ship_lc4_rt]
						,[agord_ship_lc4_pu]			 =   A.[agord_ship_lc4_pu]
						,[ship_lc4_on_net]			 =	 A.[ship_lc4_on_net]
						,[ship_lc4_on_fet]		     =   A.[ship_lc4_on_fet]
						,[agord_ship_lc5_amt]			 =	 A.[agord_ship_lc5_amt]
						,[agord_ship_lc5_rt]			 =   A.[agord_ship_lc5_rt]
						,[agord_ship_lc5_pu]			 =	 A.[agord_ship_lc5_pu]
						,[ship_lc5_on_net]		     =   A.[ship_lc5_on_net]
						,[ship_lc5_on_fet]			 =	 A.[ship_lc5_on_fet]
						,[agord_ship_lc6_amt]			 =   A.[agord_ship_lc6_amt]
						,[agord_ship_lc6_rt]			 =	 A.[agord_ship_lc6_rt]
						,[agord_ship_lc6_pu]		     =   A.[agord_ship_lc6_pu]
						,[ship_lc6_on_net]			 =	 A.[ship_lc6_on_net]
						,[ship_lc6_on_fet]			 =   A.[ship_lc6_on_fet]
						,[agord_tax_state]			 =	 A.[agord_tax_state]
						,[agord_tax_auth_id1]		     =   A.[agord_tax_auth_id1]
						,[agord_tax_auth_id2]			 =	 A.[agord_tax_auth_id2]
						,[agord_county]				 =   A.[agord_county]
						,[agord_ppd_dep_per_un]		 =	 A.[agord_ppd_dep_per_un]
						,[agord_lot_no_yn]		     =   A.[agord_lot_no_yn]
						,[agord_load_no]				 =	 A.[agord_load_no]
						,[agord_bckord_yn]			 =   A.[agord_bckord_yn]
						,[agord_cnt_cus_no]			 =	 A.[agord_cnt_cus_no]
						,[agord_cnt_no]			     =   A.[agord_cnt_no]
						,[agord_cnt_line_no]			 =	 A.[agord_cnt_line_no]
						,[agord_blend_yn]				 =   A.[agord_blend_yn]
						,[agord_disc_amt]				 =	 A.[agord_disc_amt]
						,[agord_ppd_cnt_yndm]		     =   A.[agord_ppd_cnt_yndm]
						,[agord_gl_acct]				 =	 A.[agord_gl_acct]
						,[agord_applicator_no]		 =   A.[agord_applicator_no]
						,[agord_acct_stat]			 =	 A.[agord_acct_stat]
						,[agord_sst_ynp]			     =   A.[agord_sst_ynp]
						,[agord_un_cost]				 =	 A.[agord_un_cost]
						,[agord_src_sys]				 =   A.[agord_src_sys]
						,[agord_pay_pat_yn]			 =	 A.[agord_pay_pat_yn]
						,[agord_prc_lvl]			     =   A.[agord_prc_lvl]
						,[agord_dlvr_pkup_ind]		 =	 A.[agord_dlvr_pkup_ind]
						,[agord_currency]				 =   A.[agord_currency]
						,[agord_currency_rt]			 =	 A.[agord_currency_rt]
						,[agord_currency_cnt]		     =   A.[agord_currency_cnt]
						,[agord_hide_price_ynq]		 =	 A.[agord_hide_price_ynq]
						,[agord_order_taker]			 =   A.[agord_order_taker]
						,[agord_xfer_exp_yn]			 =	 A.[agord_xfer_exp_yn]
						,[agord_ingr_on_ivc_yn]	     =   A.[agord_ingr_on_ivc_yn]
						,[agord_gb_updated_yn]		 =	 A.[agord_gb_updated_yn]
						,[agord_tm_mtr_read]			 =   A.[agord_tm_mtr_read]
						,[agord_tm_perf_id]			 =	 A.[agord_tm_perf_id]
						,[agord_nutri_file_name]	     =   A.[agord_nutri_file_name]
						,[agord_user_id]				 =	 A.[agord_user_id]
						,[agord_user_rev_dt]			 =   A.[agord_user_rev_dt]
						,[agord_user_time]			 =	 A.[agord_user_time]
						,[agord_no_of_months]			 =   A.[agord_no_of_months]
						,[agord_final_due_dt]			 =   A.[agord_final_due_dt]
						,[A4GLIdentity]				 =   A.[A4GLIdentity]			
				FROM agordmst A
				WHERE A.agord_type <> ''O''
				AND 1 = (CASE WHEN CONVERT(DATE, CAST(A.agord_ord_rev_dt AS CHAR(12)), 112) BETWEEN @DateFrom AND @DateTo THEN 1 ELSE 0 END)
			END

			IF OBJECT_ID(''tempdb..#tmpUnostedInvoiceBackupId'') IS NOT NULL DROP TABLE #tmpUnostedInvoiceBackupId
			CREATE TABLE #tmpUnostedInvoiceBackupId(intBackupId INT, intId INT)

			MERGE INTO tblARagordmst AS destination
			USING
			(
			SELECT 
					[agord_ord_no]
					,[agord_loc_no]
					,[agord_line_no]
					,[agord_ivc_no]
					,[agord_batch_no]
					,[agord_ord_rev_dt]
					,[agord_req_ship_rev_dt]
					,[agord_ship_rev_dt]
					,[agord_type]
					,[agord_bill_to_cus]
					,[agord_bill_to_split]
					,[agord_cash_tendered]
					,[agord_order_total]
					,[agord_ship_total]
					,[agord_disc_total]
					,[agord_slsmn_id]
					,[agord_po_no]
					,[agord_terms_cd]
					,[agord_comments]
					,[agord_ship_type]
					,[agord_srv_chg_cd]
					,[agord_adj_inv_yn]
					,[agord_tank_no]
					,[agord_lp_pct_full]
					,[agord_itm_no]
					,[agord_dtl_comments]
					,[agord_un_prc]
					,[agord_pkg_sold]
					,[agord_un_sold]
					,[agord_fet_amt]
					,[agord_fet_rt]
					,[agord_set_amt]
					,[agord_set_rt]
					,[agord_sst_amt]
					,[agord_sst_rt]
					,[agord_sst_pu]
					,[agord_sst_on_net]
					,[agord_sst_on_fet]
					,[agord_sst_on_set]
					,[agord_sst_on_lc1]
					,[agord_sst_on_lc2]
					,[agord_sst_on_lc3]
					,[agord_sst_on_lc4]
					,[agord_sst_on_lc5]
					,[agord_sst_on_lc6]
					,[agord_lc1_amt]
					,[agord_lc1_rt]
					,[agord_lc1_pu]
					,[agord_lc1_on_net]
					,[agord_lc1_on_fet]
					,[agord_lc2_amt]
					,[agord_lc2_rt]
					,[agord_lc2_pu]
					,[agord_lc2_on_net]
					,[agord_lc2_on_fet]
					,[agord_lc3_amt]
					,[agord_lc3_rt]
					,[agord_lc3_pu]
					,[agord_lc3_on_net]
					,[agord_lc3_on_fet]
					,[agord_lc4_amt]
					,[agord_lc4_rt]
					,[agord_lc4_pu]
					,[agord_lc4_on_net]
					,[agord_lc4_on_fet]
					,[agord_lc5_amt]
					,[agord_lc5_rt]
					,[agord_lc5_pu]
					,[agord_lc5_on_net]
					,[agord_lc5_on_fet]
					,[agord_lc6_amt]
					,[agord_lc6_rt]
					,[agord_lc6_pu]
					,[agord_lc6_on_net]
					,[agord_lc6_on_fet]
					,[agord_pkg_ship]
					,[agord_un_ship]
					,[agord_ship_fet_amt]
					,[agord_ship_fet_rt]
					,[agord_ship_set_amt]
					,[agord_ship_set_rt]
					,[agord_ship_sst_amt]
					,[agord_ship_sst_rt]
					,[agord_ship_sst_pu]
					,[ship_sst_on_net]
					,[ship_sst_on_fet]
					,[ship_sst_on_set]
					,[ship_sst_on_lc1]
					,[ship_sst_on_lc2]
					,[ship_sst_on_lc3]
					,[ship_sst_on_lc4]
					,[ship_sst_on_lc5]
					,[ship_sst_on_lc6]
					,[agord_ship_lc1_amt]
					,[agord_ship_lc1_rt]
					,[agord_ship_lc1_pu]
					,[ship_lc1_on_net]
					,[ship_lc1_on_fet]
					,[agord_ship_lc2_amt]
					,[agord_ship_lc2_rt]
					,[agord_ship_lc2_pu]
					,[ship_lc2_on_net]
					,[ship_lc2_on_fet]
					,[agord_ship_lc3_amt]
					,[agord_ship_lc3_rt]
					,[agord_ship_lc3_pu]
					,[ship_lc3_on_net]
					,[ship_lc3_on_fet]
					,[agord_ship_lc4_amt]
					,[agord_ship_lc4_rt]
					,[agord_ship_lc4_pu]
					,[ship_lc4_on_net]
					,[ship_lc4_on_fet]
					,[agord_ship_lc5_amt]
					,[agord_ship_lc5_rt]
					,[agord_ship_lc5_pu]
					,[ship_lc5_on_net]
					,[ship_lc5_on_fet]
					,[agord_ship_lc6_amt]
					,[agord_ship_lc6_rt]
					,[agord_ship_lc6_pu]
					,[ship_lc6_on_net]
					,[ship_lc6_on_fet]
					,[agord_tax_state]
					,[agord_tax_auth_id1]
					,[agord_tax_auth_id2]
					,[agord_county]
					,[agord_ppd_dep_per_un]
					,[agord_lot_no_yn]
					,[agord_load_no]
					,[agord_bckord_yn]
					,[agord_cnt_cus_no]
					,[agord_cnt_no]
					,[agord_cnt_line_no]
					,[agord_blend_yn]
					,[agord_disc_amt]
					,[agord_ppd_cnt_yndm]
					,[agord_gl_acct]
					,[agord_applicator_no]
					,[agord_acct_stat]
					,[agord_sst_ynp]
					,[agord_un_cost]
					,[agord_src_sys]
					,[agord_pay_pat_yn]
					,[agord_prc_lvl]
					,[agord_dlvr_pkup_ind]
					,[agord_currency]
					,[agord_currency_rt]
					,[agord_currency_cnt]
					,[agord_hide_price_ynq]
					,[agord_order_taker]
					,[agord_xfer_exp_yn]
					,[agord_ingr_on_ivc_yn]
					,[agord_gb_updated_yn]
					,[agord_tm_mtr_read]
					,[agord_tm_perf_id]
					,[agord_nutri_file_name]
					,[agord_user_id]
					,[agord_user_rev_dt]
					,[agord_user_time]      
					,[agord_no_of_months]
					,[agord_final_due_dt]
					,[A4GLIdentity]	
					,[intId]
			FROM tmp_agordmstImport	
			) AS SourceData
			ON (1=0)
			WHEN NOT MATCHED THEN
			INSERT
			(
					[agord_ord_no]
					,[agord_loc_no]
					,[agord_line_no]
					,[agord_ivc_no]
					,[agord_batch_no]
					,[agord_ord_rev_dt]
					,[agord_req_ship_rev_dt]
					,[agord_ship_rev_dt]
					,[agord_type]
					,[agord_bill_to_cus]
					,[agord_bill_to_split]
					,[agord_cash_tendered]
					,[agord_order_total]
					,[agord_ship_total]
					,[agord_disc_total]
					,[agord_slsmn_id]
					,[agord_po_no]
					,[agord_terms_cd]
					,[agord_comments]
					,[agord_ship_type]
					,[agord_srv_chg_cd]
					,[agord_adj_inv_yn]
					,[agord_tank_no]
					,[agord_lp_pct_full]
					,[agord_itm_no]
					,[agord_dtl_comments]
					,[agord_un_prc]
					,[agord_pkg_sold]
					,[agord_un_sold]
					,[agord_fet_amt]
					,[agord_fet_rt]
					,[agord_set_amt]
					,[agord_set_rt]
					,[agord_sst_amt]
					,[agord_sst_rt]
					,[agord_sst_pu]
					,[agord_sst_on_net]
					,[agord_sst_on_fet]
					,[agord_sst_on_set]
					,[agord_sst_on_lc1]
					,[agord_sst_on_lc2]
					,[agord_sst_on_lc3]
					,[agord_sst_on_lc4]
					,[agord_sst_on_lc5]
					,[agord_sst_on_lc6]
					,[agord_lc1_amt]
					,[agord_lc1_rt]
					,[agord_lc1_pu]
					,[agord_lc1_on_net]
					,[agord_lc1_on_fet]
					,[agord_lc2_amt]
					,[agord_lc2_rt]
					,[agord_lc2_pu]
					,[agord_lc2_on_net]
					,[agord_lc2_on_fet]
					,[agord_lc3_amt]
					,[agord_lc3_rt]
					,[agord_lc3_pu]
					,[agord_lc3_on_net]
					,[agord_lc3_on_fet]
					,[agord_lc4_amt]
					,[agord_lc4_rt]
					,[agord_lc4_pu]
					,[agord_lc4_on_net]
					,[agord_lc4_on_fet]
					,[agord_lc5_amt]
					,[agord_lc5_rt]
					,[agord_lc5_pu]
					,[agord_lc5_on_net]
					,[agord_lc5_on_fet]
					,[agord_lc6_amt]
					,[agord_lc6_rt]
					,[agord_lc6_pu]
					,[agord_lc6_on_net]
					,[agord_lc6_on_fet]
					,[agord_pkg_ship]
					,[agord_un_ship]
					,[agord_ship_fet_amt]
					,[agord_ship_fet_rt]
					,[agord_ship_set_amt]
					,[agord_ship_set_rt]
					,[agord_ship_sst_amt]
					,[agord_ship_sst_rt]
					,[agord_ship_sst_pu]
					,[ship_sst_on_net]
					,[ship_sst_on_fet]
					,[ship_sst_on_set]
					,[ship_sst_on_lc1]
					,[ship_sst_on_lc2]
					,[ship_sst_on_lc3]
					,[ship_sst_on_lc4]
					,[ship_sst_on_lc5]
					,[ship_sst_on_lc6]
					,[agord_ship_lc1_amt]
					,[agord_ship_lc1_rt]
					,[agord_ship_lc1_pu]
					,[ship_lc1_on_net]
					,[ship_lc1_on_fet]
					,[agord_ship_lc2_amt]
					,[agord_ship_lc2_rt]
					,[agord_ship_lc2_pu]
					,[ship_lc2_on_net]
					,[ship_lc2_on_fet]
					,[agord_ship_lc3_amt]
					,[agord_ship_lc3_rt]
					,[agord_ship_lc3_pu]
					,[ship_lc3_on_net]
					,[ship_lc3_on_fet]
					,[agord_ship_lc4_amt]
					,[agord_ship_lc4_rt]
					,[agord_ship_lc4_pu]
					,[ship_lc4_on_net]
					,[ship_lc4_on_fet]
					,[agord_ship_lc5_amt]
					,[agord_ship_lc5_rt]
					,[agord_ship_lc5_pu]
					,[ship_lc5_on_net]
					,[ship_lc5_on_fet]
					,[agord_ship_lc6_amt]
					,[agord_ship_lc6_rt]
					,[agord_ship_lc6_pu]
					,[ship_lc6_on_net]
					,[ship_lc6_on_fet]
					,[agord_tax_state]
					,[agord_tax_auth_id1]
					,[agord_tax_auth_id2]
					,[agord_county]
					,[agord_ppd_dep_per_un]
					,[agord_lot_no_yn]
					,[agord_load_no]
					,[agord_bckord_yn]
					,[agord_cnt_cus_no]
					,[agord_cnt_no]
					,[agord_cnt_line_no]
					,[agord_blend_yn]
					,[agord_disc_amt]
					,[agord_ppd_cnt_yndm]
					,[agord_gl_acct]
					,[agord_applicator_no]
					,[agord_acct_stat]
					,[agord_sst_ynp]
					,[agord_un_cost]
					,[agord_src_sys]
					,[agord_pay_pat_yn]
					,[agord_prc_lvl]
					,[agord_dlvr_pkup_ind]
					,[agord_currency]
					,[agord_currency_rt]
					,[agord_currency_cnt]
					,[agord_hide_price_ynq]
					,[agord_order_taker]
					,[agord_xfer_exp_yn]
					,[agord_ingr_on_ivc_yn]
					,[agord_gb_updated_yn]
					,[agord_tm_mtr_read]
					,[agord_tm_perf_id]
					,[agord_nutri_file_name]
					,[agord_user_id]
					,[agord_user_rev_dt]
					,[agord_user_time]
					,[agord_no_of_months]
					,[agord_final_due_dt]
					,[A4GLIdentity]			 	
			)
			VALUES
			(
					[agord_ord_no]
					,[agord_loc_no]
					,[agord_line_no]
					,[agord_ivc_no]
					,[agord_batch_no]
					,[agord_ord_rev_dt]
					,[agord_req_ship_rev_dt]
					,[agord_ship_rev_dt]
					,[agord_type]
					,[agord_bill_to_cus]
					,[agord_bill_to_split]
					,[agord_cash_tendered]
					,[agord_order_total]
					,[agord_ship_total]
					,[agord_disc_total]
					,[agord_slsmn_id]
					,[agord_po_no]
					,[agord_terms_cd]
					,[agord_comments]
					,[agord_ship_type]
					,[agord_srv_chg_cd]
					,[agord_adj_inv_yn]
					,[agord_tank_no]
					,[agord_lp_pct_full]
					,[agord_itm_no]
					,[agord_dtl_comments]
					,[agord_un_prc]
					,[agord_pkg_sold]
					,[agord_un_sold]
					,[agord_fet_amt]
					,[agord_fet_rt]
					,[agord_set_amt]
					,[agord_set_rt]
					,[agord_sst_amt]
					,[agord_sst_rt]
					,[agord_sst_pu]
					,[agord_sst_on_net]
					,[agord_sst_on_fet]
					,[agord_sst_on_set]
					,[agord_sst_on_lc1]
					,[agord_sst_on_lc2]
					,[agord_sst_on_lc3]
					,[agord_sst_on_lc4]
					,[agord_sst_on_lc5]
					,[agord_sst_on_lc6]
					,[agord_lc1_amt]
					,[agord_lc1_rt]
					,[agord_lc1_pu]
					,[agord_lc1_on_net]
					,[agord_lc1_on_fet]
					,[agord_lc2_amt]
					,[agord_lc2_rt]
					,[agord_lc2_pu]
					,[agord_lc2_on_net]
					,[agord_lc2_on_fet]
					,[agord_lc3_amt]
					,[agord_lc3_rt]
					,[agord_lc3_pu]
					,[agord_lc3_on_net]
					,[agord_lc3_on_fet]
					,[agord_lc4_amt]
					,[agord_lc4_rt]
					,[agord_lc4_pu]
					,[agord_lc4_on_net]
					,[agord_lc4_on_fet]
					,[agord_lc5_amt]
					,[agord_lc5_rt]
					,[agord_lc5_pu]
					,[agord_lc5_on_net]
					,[agord_lc5_on_fet]
					,[agord_lc6_amt]
					,[agord_lc6_rt]
					,[agord_lc6_pu]
					,[agord_lc6_on_net]
					,[agord_lc6_on_fet]
					,[agord_pkg_ship]
					,[agord_un_ship]
					,[agord_ship_fet_amt]
					,[agord_ship_fet_rt]
					,[agord_ship_set_amt]
					,[agord_ship_set_rt]
					,[agord_ship_sst_amt]
					,[agord_ship_sst_rt]
					,[agord_ship_sst_pu]
					,[ship_sst_on_net]
					,[ship_sst_on_fet]
					,[ship_sst_on_set]
					,[ship_sst_on_lc1]
					,[ship_sst_on_lc2]
					,[ship_sst_on_lc3]
					,[ship_sst_on_lc4]
					,[ship_sst_on_lc5]
					,[ship_sst_on_lc6]
					,[agord_ship_lc1_amt]
					,[agord_ship_lc1_rt]
					,[agord_ship_lc1_pu]
					,[ship_lc1_on_net]
					,[ship_lc1_on_fet]
					,[agord_ship_lc2_amt]
					,[agord_ship_lc2_rt]
					,[agord_ship_lc2_pu]
					,[ship_lc2_on_net]
					,[ship_lc2_on_fet]
					,[agord_ship_lc3_amt]
					,[agord_ship_lc3_rt]
					,[agord_ship_lc3_pu]
					,[ship_lc3_on_net]
					,[ship_lc3_on_fet]
					,[agord_ship_lc4_amt]
					,[agord_ship_lc4_rt]
					,[agord_ship_lc4_pu]
					,[ship_lc4_on_net]
					,[ship_lc4_on_fet]
					,[agord_ship_lc5_amt]
					,[agord_ship_lc5_rt]
					,[agord_ship_lc5_pu]
					,[ship_lc5_on_net]
					,[ship_lc5_on_fet]
					,[agord_ship_lc6_amt]
					,[agord_ship_lc6_rt]
					,[agord_ship_lc6_pu]
					,[ship_lc6_on_net]
					,[ship_lc6_on_fet]
					,[agord_tax_state]
					,[agord_tax_auth_id1]
					,[agord_tax_auth_id2]
					,[agord_county]
					,[agord_ppd_dep_per_un]
					,[agord_lot_no_yn]
					,[agord_load_no]
					,[agord_bckord_yn]
					,[agord_cnt_cus_no]
					,[agord_cnt_no]
					,[agord_cnt_line_no]
					,[agord_blend_yn]
					,[agord_disc_amt]
					,[agord_ppd_cnt_yndm]
					,[agord_gl_acct]
					,[agord_applicator_no]
					,[agord_acct_stat]
					,[agord_sst_ynp]
					,[agord_un_cost]
					,[agord_src_sys]
					,[agord_pay_pat_yn]
					,[agord_prc_lvl]
					,[agord_dlvr_pkup_ind]
					,[agord_currency]
					,[agord_currency_rt]
					,[agord_currency_cnt]
					,[agord_hide_price_ynq]
					,[agord_order_taker]
					,[agord_xfer_exp_yn]
					,[agord_ingr_on_ivc_yn]
					,[agord_gb_updated_yn]
					,[agord_tm_mtr_read]
					,[agord_tm_perf_id]
					,[agord_nutri_file_name]
					,[agord_user_id]
					,[agord_user_rev_dt]
					,[agord_user_time]
					,[agord_no_of_months]
					,[agord_final_due_dt]
					,[A4GLIdentity]		
			)
			OUTPUT inserted.intId, SourceData.intId INTO #tmpUnostedInvoiceBackupId;

			SET @totalagordmst = @@ROWCOUNT;

			--UPDATE temp data for the back up link
			UPDATE A
				SET A.intBackupId = B.intBackupId
			FROM tmp_agordmstImport A
			INNER JOIN #tmpUnostedInvoiceBackupId B ON A.intId = B.intId

			DELETE A
			FROM agordmst A
			INNER JOIN tmp_agordmstImport B 
			ON A.[agord_cus_no] = B.[agord_cus_no] AND A.agord_ivc_no = B.agord_ivc_no AND A.A4GLIdentity = B.A4GLIdentity

			IF @transCount = 0 COMMIT TRANSACTION
			END TRY
			BEGIN CATCH
				DECLARE @errorBackingUp NVARCHAR(500) = ERROR_MESSAGE();
				IF @transCount = 0 AND XACT_STATE() <> 0 ROLLBACK TRANSACTION
				RAISERROR(@errorBackingUp, 16, 1);
			END CATCH
			')
	END
	ELSE
	BEGIN
		EXEC('
			CREATE PROCEDURE [dbo].[uspARImportInvoiceBackupAGORDMST]
				@DateFrom DATETIME = NULL,
				@DateTo DATETIME = NULL,
				@totalagordmst INT OUTPUT
			AS

			SET QUOTED_IDENTIFIER OFF
			SET ANSI_NULLS ON
			SET NOCOUNT ON
			SET XACT_ABORT ON
			SET ANSI_WARNINGS OFF

			BEGIN TRY

			DECLARE @transCount INT = @@TRANCOUNT;

			IF @transCount = 0 BEGIN TRANSACTION

			--BACK UP agordmst
			IF OBJECT_ID(''dbo.tmp_agordmstImport'') IS NOT NULL DROP TABLE tmp_agordmstImport

			CREATE TABLE tmp_agordmstImport(
				[agord_cus_no] [char](10) NOT NULL,
				[agord_ord_no] [char](8) NOT NULL,
				[agord_loc_no] [char](3) NOT NULL,
				[agord_line_no] [smallint] NOT NULL,
				[agord_ivc_no] [char](8) NOT NULL,
				[agord_batch_no] [smallint] NULL,
				[agord_ord_rev_dt] [int] NULL,
				[agord_req_ship_rev_dt] [int] NULL,
				[agord_ship_rev_dt] [int] NULL,
				[agord_type] [char](1) NULL,
				[agord_bill_to_cus] [char](10) NULL,
				[agord_bill_to_split] [char](4) NULL,
				[agord_cash_tendered] [decimal](11, 2) NULL,
				[agord_order_total] [decimal](11, 2) NULL,
				[agord_ship_total] [decimal](11, 2) NULL,
				[agord_disc_total] [decimal](9, 2) NULL,
				[agord_slsmn_id] [char](3) NULL,
				[agord_po_no] [char](15) NOT NULL,
				[agord_terms_cd] [tinyint] NULL,
				[agord_comments] [char](30) NULL,
				[agord_ship_type] [char](1) NULL,
				[agord_srv_chg_cd] [tinyint] NULL,
				[agord_adj_inv_yn] [char](1) NULL,
				[agord_tank_no] [char](4) NULL,
				[agord_lp_pct_full] [smallint] NULL,
				[agord_itm_no] [char](13) NOT NULL,
				[agord_dtl_comments] [char](33) NULL,
				[agord_un_prc] [decimal](11, 5) NULL,
				[agord_pkg_sold] [decimal](11, 4) NULL,
				[agord_un_sold] [decimal](11, 4) NULL,
				[agord_fet_amt] [decimal](11, 2) NULL,
				[agord_fet_rt] [decimal](9, 6) NULL,
				[agord_set_amt] [decimal](11, 2) NULL,
				[agord_set_rt] [decimal](9, 6) NULL,
				[agord_sst_amt] [decimal](11, 2) NULL,
				[agord_sst_rt] [decimal](9, 6) NULL,
				[agord_sst_pu] [char](1) NULL,
				[agord_sst_on_net] [decimal](11, 2) NULL,
				[agord_sst_on_fet] [decimal](11, 2) NULL,
				[agord_sst_on_set] [decimal](11, 2) NULL,
				[agord_sst_on_lc1] [decimal](11, 2) NULL,
				[agord_sst_on_lc2] [decimal](11, 2) NULL,
				[agord_sst_on_lc3] [decimal](11, 2) NULL,
				[agord_sst_on_lc4] [decimal](11, 2) NULL,
				[agord_sst_on_lc5] [decimal](11, 2) NULL,
				[agord_sst_on_lc6] [decimal](11, 2) NULL,
				[agord_lc1_amt] [decimal](11, 2) NULL,
				[agord_lc1_rt] [decimal](9, 6) NULL,
				[agord_lc1_pu] [char](1) NULL,
				[agord_lc1_on_net] [decimal](11, 2) NULL,
				[agord_lc1_on_fet] [decimal](11, 2) NULL,
				[agord_lc2_amt] [decimal](11, 2) NULL,
				[agord_lc2_rt] [decimal](9, 6) NULL,
				[agord_lc2_pu] [char](1) NULL,
				[agord_lc2_on_net] [decimal](11, 2) NULL,
				[agord_lc2_on_fet] [decimal](11, 2) NULL,
				[agord_lc3_amt] [decimal](11, 2) NULL,
				[agord_lc3_rt] [decimal](9, 6) NULL,
				[agord_lc3_pu] [char](1) NULL,
				[agord_lc3_on_net] [decimal](11, 2) NULL,
				[agord_lc3_on_fet] [decimal](11, 2) NULL,
				[agord_lc4_amt] [decimal](11, 2) NULL,
				[agord_lc4_rt] [decimal](9, 6) NULL,
				[agord_lc4_pu] [char](1) NULL,
				[agord_lc4_on_net] [decimal](11, 2) NULL,
				[agord_lc4_on_fet] [decimal](11, 2) NULL,
				[agord_lc5_amt] [decimal](11, 2) NULL,
				[agord_lc5_rt] [decimal](9, 6) NULL,
				[agord_lc5_pu] [char](1) NULL,
				[agord_lc5_on_net] [decimal](11, 2) NULL,
				[agord_lc5_on_fet] [decimal](11, 2) NULL,
				[agord_lc6_amt] [decimal](11, 2) NULL,
				[agord_lc6_rt] [decimal](9, 6) NULL,
				[agord_lc6_pu] [char](1) NULL,
				[agord_lc6_on_net] [decimal](11, 2) NULL,
				[agord_lc6_on_fet] [decimal](11, 2) NULL,
				[agord_pkg_ship] [decimal](11, 4) NULL,
				[agord_un_ship] [decimal](11, 4) NULL,
				[agord_ship_fet_amt] [decimal](11, 2) NULL,
				[agord_ship_fet_rt] [decimal](9, 6) NULL,
				[agord_ship_set_amt] [decimal](11, 2) NULL,
				[agord_ship_set_rt] [decimal](9, 6) NULL,
				[agord_ship_sst_amt] [decimal](11, 2) NULL,
				[agord_ship_sst_rt] [decimal](9, 6) NULL,
				[agord_ship_sst_pu] [char](1) NULL,
				[ship_sst_on_net] [decimal](11, 2) NULL,
				[ship_sst_on_fet] [decimal](11, 2) NULL,
				[ship_sst_on_set] [decimal](11, 2) NULL,
				[ship_sst_on_lc1] [decimal](11, 2) NULL,
				[ship_sst_on_lc2] [decimal](11, 2) NULL,
				[ship_sst_on_lc3] [decimal](11, 2) NULL,
				[ship_sst_on_lc4] [decimal](11, 2) NULL,
				[ship_sst_on_lc5] [decimal](11, 2) NULL,
				[ship_sst_on_lc6] [decimal](11, 2) NULL,
				[agord_ship_lc1_amt] [decimal](11, 2) NULL,
				[agord_ship_lc1_rt] [decimal](9, 6) NULL,
				[agord_ship_lc1_pu] [char](1) NULL,
				[ship_lc1_on_net] [decimal](11, 2) NULL,
				[ship_lc1_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc2_amt] [decimal](11, 2) NULL,
				[agord_ship_lc2_rt] [decimal](9, 6) NULL,
				[agord_ship_lc2_pu] [char](1) NULL,
				[ship_lc2_on_net] [decimal](11, 2) NULL,
				[ship_lc2_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc3_amt] [decimal](11, 2) NULL,
				[agord_ship_lc3_rt] [decimal](9, 6) NULL,
				[agord_ship_lc3_pu] [char](1) NULL,
				[ship_lc3_on_net] [decimal](11, 2) NULL,
				[ship_lc3_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc4_amt] [decimal](11, 2) NULL,
				[agord_ship_lc4_rt] [decimal](9, 6) NULL,
				[agord_ship_lc4_pu] [char](1) NULL,
				[ship_lc4_on_net] [decimal](11, 2) NULL,
				[ship_lc4_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc5_amt] [decimal](11, 2) NULL,
				[agord_ship_lc5_rt] [decimal](9, 6) NULL,
				[agord_ship_lc5_pu] [char](1) NULL,
				[ship_lc5_on_net] [decimal](11, 2) NULL,
				[ship_lc5_on_fet] [decimal](11, 2) NULL,
				[agord_ship_lc6_amt] [decimal](11, 2) NULL,
				[agord_ship_lc6_rt] [decimal](9, 6) NULL,
				[agord_ship_lc6_pu] [char](1) NULL,
				[ship_lc6_on_net] [decimal](11, 2) NULL,
				[ship_lc6_on_fet] [decimal](11, 2) NULL,
				[agord_tax_state] [char](2) NULL,
				[agord_tax_auth_id1] [char](3) NULL,
				[agord_tax_auth_id2] [char](3) NULL,
				[agord_county] [char](3) NULL,
				[agord_ppd_dep_per_un] [decimal](11, 5) NULL,
				[agord_lot_no_yn] [char](1) NULL,
				[agord_load_no] [char](8) NULL,
				[agord_bckord_yn] [char](1) NULL,
				[agord_cnt_cus_no] [char](10) NULL,
				[agord_cnt_no] [char](8) NULL,
				[agord_cnt_line_no] [smallint] NULL,
				[agord_blend_yn] [char](1) NULL,
				[agord_disc_amt] [decimal](9, 2) NULL,
				[agord_ppd_cnt_yndm] [char](1) NULL,
				[agord_gl_acct] [decimal](16, 8) NULL,
				[agord_applicator_no] [char](10) NULL,
				[agord_acct_stat] [char](1) NULL,
				[agord_sst_ynp] [char](1) NULL,
				[agord_un_cost] [decimal](11, 5) NULL,
				[agord_src_sys] [char](3) NULL,
				[agord_pay_pat_yn] [char](1) NULL,
				[agord_prc_lvl] [tinyint] NULL,
				[agord_dlvr_pkup_ind] [char](1) NULL,
				[agord_currency] [char](3) NULL,
				[agord_currency_rt] [decimal](15, 8) NULL,
				[agord_currency_cnt] [char](8) NULL,
				[agord_hide_price_ynq] [char](1) NULL,
				[agord_order_taker] [char](3) NULL,
				[agord_xfer_exp_yn] [char](1) NULL,
				[agord_ingr_on_ivc_yn] [char](1) NULL,
				[agord_gb_updated_yn] [char](1) NULL,
				[agord_tm_mtr_read] [decimal](11, 4) NULL,
				[agord_tm_perf_id] [char](3) NULL,
				[agord_nutri_file_name] [char](50) NULL,
				[agord_user_id] [char](16) NULL,
				[agord_user_rev_dt] [int] NULL,
				[agord_user_time] [int] NULL,
				[agord_no_of_months] [tinyint] NULL,[agord_final_due_dt] [int] NULL,
				[A4GLIdentity] [numeric](9, 0) NOT NULL,
				[intBackupId]			INT NULL, --Use this to update the linking between the back up and created voucher
				[intId]			INT IDENTITY(1,1) NOT NULL,
				CONSTRAINT [k_tmpagordmst] PRIMARY KEY NONCLUSTERED (
						[agord_cus_no] ASC,
						[agord_ord_no] ASC,
						[agord_loc_no] ASC,
						[agord_line_no] ASC
				)
			)

			--BACK UP RECORDS TO BE IMPORTED FROM agordmst
			IF @DateFrom IS NULL --ONE TIME IMPORT
			BEGIN
				INSERT INTO tmp_agordmstImport
				(      [agord_ord_no]                
						,[agord_loc_no]				 
						,[agord_line_no]				 
						,[agord_ivc_no]				 
						,[agord_batch_no]			     
						,[agord_ord_rev_dt]			 
						,[agord_req_ship_rev_dt]		 
						,[agord_ship_rev_dt]			 
						,[agord_type]				     
						,[agord_bill_to_cus]			 
						,[agord_bill_to_split]		 
						,[agord_cash_tendered]		 
						,[agord_order_total]		     
						,[agord_ship_total]			 
						,[agord_disc_total]			 
						,[agord_slsmn_id]				 
						,[agord_po_no]			     
						,[agord_terms_cd]				 
						,[agord_comments]				 
						,[agord_ship_type]			 
						,[agord_srv_chg_cd]		     
						,[agord_adj_inv_yn]			 
						,[agord_tank_no]				 
						,[agord_lp_pct_full]			 
						,[agord_itm_no]			     
						,[agord_dtl_comments]			 
						,[agord_un_prc]				 
						,[agord_pkg_sold]				 
						,[agord_un_sold]			     
						,[agord_fet_amt]				 
						,[agord_fet_rt]				 
						,[agord_set_amt]				 
						,[agord_set_rt]			     
						,[agord_sst_amt]				 
						,[agord_sst_rt]				 
						,[agord_sst_pu]				 
						,[agord_sst_on_net]		     
						,[agord_sst_on_fet]			 
						,[agord_sst_on_set]			 
						,[agord_sst_on_lc1]			 
						,[agord_sst_on_lc2]		     
						,[agord_sst_on_lc3]			 
						,[agord_sst_on_lc4]			 
						,[agord_sst_on_lc5]			 
						,[agord_sst_on_lc6]		     
						,[agord_lc1_amt]				 
						,[agord_lc1_rt]				 
						,[agord_lc1_pu]				 
						,[agord_lc1_on_net]		     
						,[agord_lc1_on_fet]			 
						,[agord_lc2_amt]				 
						,[agord_lc2_rt]				 
						,[agord_lc2_pu]			     
						,[agord_lc2_on_net]			 
						,[agord_lc2_on_fet]			 
						,[agord_lc3_amt]				 
						,[agord_lc3_rt]			     
						,[agord_lc3_pu]				 
						,[agord_lc3_on_net]			 
						,[agord_lc3_on_fet]			 
						,[agord_lc4_amt]			     
						,[agord_lc4_rt]				 
						,[agord_lc4_pu]				 
						,[agord_lc4_on_net]			 
						,[agord_lc4_on_fet]		     
						,[agord_lc5_amt]				 
						,[agord_lc5_rt]				 
						,[agord_lc5_pu]				 
						,[agord_lc5_on_net]		     
						,[agord_lc5_on_fet]			 
						,[agord_lc6_amt]				 
						,[agord_lc6_rt]				 
						,[agord_lc6_pu]			     
						,[agord_lc6_on_net]			 
						,[agord_lc6_on_fet]			 
						,[agord_pkg_ship]				 
						,[agord_un_ship]			     
						,[agord_ship_fet_amt]			 
						,[agord_ship_fet_rt]			 
						,[agord_ship_set_amt]			 
						,[agord_ship_set_rt]		     
						,[agord_ship_sst_amt]			 
						,[agord_ship_sst_rt]			 
						,[agord_ship_sst_pu]			 
						,[ship_sst_on_net]		     
						,[ship_sst_on_fet]			 
						,[ship_sst_on_set]			 
						,[ship_sst_on_lc1]			 
						,[ship_sst_on_lc2]		     
						,[ship_sst_on_lc3]			 
						,[ship_sst_on_lc4]			 
						,[ship_sst_on_lc5]			 
						,[ship_sst_on_lc6]		     
						,[agord_ship_lc1_amt]			 
						,[agord_ship_lc1_rt]			 
						,[agord_ship_lc1_pu]			 
						,[ship_lc1_on_net]		     
						,[ship_lc1_on_fet]			 
						,[agord_ship_lc2_amt]			 
						,[agord_ship_lc2_rt]			 
						,[agord_ship_lc2_pu]		     
						,[ship_lc2_on_net]			 
						,[ship_lc2_on_fet]			 
						,[agord_ship_lc3_amt]			 
						,[agord_ship_lc3_rt]		     
						,[agord_ship_lc3_pu]			 
						,[ship_lc3_on_net]			 
						,[ship_lc3_on_fet]			 
						,[agord_ship_lc4_amt]		     
						,[agord_ship_lc4_rt]			 
						,[agord_ship_lc4_pu]			 
						,[ship_lc4_on_net]			 
						,[ship_lc4_on_fet]		     
						,[agord_ship_lc5_amt]			 
						,[agord_ship_lc5_rt]			 
						,[agord_ship_lc5_pu]			 
						,[ship_lc5_on_net]		     
						,[ship_lc5_on_fet]			 
						,[agord_ship_lc6_amt]			 
						,[agord_ship_lc6_rt]			 
						,[agord_ship_lc6_pu]		     
						,[ship_lc6_on_net]			 
						,[ship_lc6_on_fet]			 
						,[agord_tax_state]			 
						,[agord_tax_auth_id1]		     
						,[agord_tax_auth_id2]			 
						,[agord_county]				 
						,[agord_ppd_dep_per_un]		 
						,[agord_lot_no_yn]		     
						,[agord_load_no]				 
						,[agord_bckord_yn]			 
						,[agord_cnt_cus_no]			 
						,[agord_cnt_no]			     
						,[agord_cnt_line_no]			 
						,[agord_blend_yn]				 
						,[agord_disc_amt]				 
						,[agord_ppd_cnt_yndm]		     
						,[agord_gl_acct]				 
						,[agord_applicator_no]		 
						,[agord_acct_stat]			 
						,[agord_sst_ynp]			     
						,[agord_un_cost]				 
						,[agord_src_sys]				 
						,[agord_pay_pat_yn]			 
						,[agord_prc_lvl]			     
						,[agord_dlvr_pkup_ind]		 
						,[agord_currency]				 
						,[agord_currency_rt]			 
						,[agord_currency_cnt]		     
						,[agord_hide_price_ynq]		 
						,[agord_order_taker]			 
						,[agord_xfer_exp_yn]			 
						,[agord_ingr_on_ivc_yn]	     
						,[agord_gb_updated_yn]		 
						,[agord_tm_mtr_read]			 
						,[agord_tm_perf_id]			 
						,[agord_nutri_file_name]	     
						,[agord_user_id]				 
						,[agord_user_rev_dt]			 
						,[agord_user_time]			 
						,[agord_no_of_months]		     
						,[agord_final_due_dt]			 
						,[A4GLIdentity])				 
										 
				SELECT
						[agord_ord_no]                =   A.[agord_ord_no]
						,[agord_loc_no]				 =	 A.[agord_loc_no]
						,[agord_line_no]				 =   A.[agord_line_no]
						,[agord_ivc_no]				 =	 A.[agord_ivc_no]
						,[agord_batch_no]			     =   A.[agord_batch_no]
						,[agord_ord_rev_dt]			 =	 A.[agord_ord_rev_dt]
						,[agord_req_ship_rev_dt]		 =   A.[agord_req_ship_rev_dt]
						,[agord_ship_rev_dt]			 =	 A.[agord_ship_rev_dt]
						,[agord_type]				     =   A.[agord_type]
						,[agord_bill_to_cus]			 =	 A.[agord_bill_to_cus]
						,[agord_bill_to_split]		 =   A.[agord_bill_to_split]
						,[agord_cash_tendered]		 =	 A.[agord_cash_tendered]
						,[agord_order_total]		     =   A.[agord_order_total]
						,[agord_ship_total]			 =	 A.[agord_ship_total]
						,[agord_disc_total]			 =   A.[agord_disc_total]
						,[agord_slsmn_id]				 =	 A.[agord_slsmn_id]
						,[agord_po_no]			     =   A.[agord_po_no]
						,[agord_terms_cd]				 =	 A.[agord_terms_cd]
						,[agord_comments]				 =   A.[agord_comments]
						,[agord_ship_type]			 =	 A.[agord_ship_type]
						,[agord_srv_chg_cd]		     =   A.[agord_srv_chg_cd]
						,[agord_adj_inv_yn]			 =	 A.[agord_adj_inv_yn]
						,[agord_tank_no]				 =   A.[agord_tank_no]
						,[agord_lp_pct_full]			 =	 A.[agord_lp_pct_full]
						,[agord_itm_no]			     =   A.[agord_itm_no]
						,[agord_dtl_comments]			 =	 A.[agord_dtl_comments]
						,[agord_un_prc]				 =   A.[agord_un_prc]
						,[agord_pkg_sold]				 =	 A.[agord_pkg_sold]
						,[agord_un_sold]			     =   A.[agord_un_sold]
						,[agord_fet_amt]				 =	 A.[agord_fet_amt]
						,[agord_fet_rt]				 =   A.[agord_fet_rt]
						,[agord_set_amt]				 =	 A.[agord_set_amt]
						,[agord_set_rt]			     =   A.[agord_set_rt]
						,[agord_sst_amt]				 =	 A.[agord_sst_amt]
						,[agord_sst_rt]				 =   A.[agord_sst_rt]
						,[agord_sst_pu]				 =	 A.[agord_sst_pu]
						,[agord_sst_on_net]		     =   A.[agord_sst_on_net]
						,[agord_sst_on_fet]			 =	 A.[agord_sst_on_fet]
						,[agord_sst_on_set]			 =   A.[agord_sst_on_set]
						,[agord_sst_on_lc1]			 =	 A.[agord_sst_on_lc1]
						,[agord_sst_on_lc2]		     =   A.[agord_sst_on_lc2]
						,[agord_sst_on_lc3]			 =	 A.[agord_sst_on_lc3]
						,[agord_sst_on_lc4]			 =   A.[agord_sst_on_lc4]
						,[agord_sst_on_lc5]			 =	 A.[agord_sst_on_lc5]
						,[agord_sst_on_lc6]		     =   A.[agord_sst_on_lc6]
						,[agord_lc1_amt]				 =	 A.[agord_lc1_amt]
						,[agord_lc1_rt]				 =   A.[agord_lc1_rt]
						,[agord_lc1_pu]				 =	 A.[agord_lc1_pu]
						,[agord_lc1_on_net]		     =   A.[agord_lc1_on_net]
						,[agord_lc1_on_fet]			 =	 A.[agord_lc1_on_fet]
						,[agord_lc2_amt]				 =   A.[agord_lc2_amt]
						,[agord_lc2_rt]				 =	 A.[agord_lc2_rt]
						,[agord_lc2_pu]			     =   A.[agord_lc2_pu]
						,[agord_lc2_on_net]			 =	 A.[agord_lc2_on_net]
						,[agord_lc2_on_fet]			 =   A.[agord_lc2_on_fet]
						,[agord_lc3_amt]				 =	 A.[agord_lc3_amt]
						,[agord_lc3_rt]			     =   A.[agord_lc3_rt]
						,[agord_lc3_pu]				 =	 A.[agord_lc3_pu]
						,[agord_lc3_on_net]			 =   A.[agord_lc3_on_net]
						,[agord_lc3_on_fet]			 =	 A.[agord_lc3_on_fet]
						,[agord_lc4_amt]			     =   A.[agord_lc4_amt]
						,[agord_lc4_rt]				 =	 A.[agord_lc4_rt]
						,[agord_lc4_pu]				 =   A.[agord_lc4_pu]
						,[agord_lc4_on_net]			 =	 A.[agord_lc4_on_net]
						,[agord_lc4_on_fet]		     =   A.[agord_lc4_on_fet]
						,[agord_lc5_amt]				 =	 A.[agord_lc5_amt]
						,[agord_lc5_rt]				 =   A.[agord_lc5_rt]
						,[agord_lc5_pu]				 =	 A.[agord_lc5_pu]
						,[agord_lc5_on_net]		     =   A.[agord_lc5_on_net]
						,[agord_lc5_on_fet]			 =	 A.[agord_lc5_on_fet]
						,[agord_lc6_amt]				 =   A.[agord_lc6_amt]
						,[agord_lc6_rt]				 =	 A.[agord_lc6_rt]
						,[agord_lc6_pu]			     =   A.[agord_lc6_pu]
						,[agord_lc6_on_net]			 =	 A.[agord_lc6_on_net]
						,[agord_lc6_on_fet]			 =   A.[agord_lc6_on_fet]
						,[agord_pkg_ship]				 =	 A.[agord_pkg_ship]
						,[agord_un_ship]			     =   A.[agord_un_ship]
						,[agord_ship_fet_amt]			 =	 A.[agord_ship_fet_amt]
						,[agord_ship_fet_rt]			 =   A.[agord_ship_fet_rt]
						,[agord_ship_set_amt]			 =	 A.[agord_ship_set_amt]
						,[agord_ship_set_rt]		     =   A.[agord_ship_set_rt]
						,[agord_ship_sst_amt]			 =	 A.[agord_ship_sst_amt]
						,[agord_ship_sst_rt]			 =   A.[agord_ship_sst_rt]
						,[agord_ship_sst_pu]			 =	 A.[agord_ship_sst_pu]
						,[ship_sst_on_net]		     =   A.[ship_sst_on_net]
						,[ship_sst_on_fet]			 =	 A.[ship_sst_on_fet]
						,[ship_sst_on_set]			 =   A.[ship_sst_on_set]
						,[ship_sst_on_lc1]			 =	 A.[ship_sst_on_lc1]
						,[ship_sst_on_lc2]		     =   A.[ship_sst_on_lc2]
						,[ship_sst_on_lc3]			 =	 A.[ship_sst_on_lc3]
						,[ship_sst_on_lc4]			 =   A.[ship_sst_on_lc4]
						,[ship_sst_on_lc5]			 =	 A.[ship_sst_on_lc5]
						,[ship_sst_on_lc6]		     =   A.[ship_sst_on_lc6]
						,[agord_ship_lc1_amt]			 =	 A.[agord_ship_lc1_amt]
						,[agord_ship_lc1_rt]			 =   A.[agord_ship_lc1_rt]
						,[agord_ship_lc1_pu]			 =	 A.[agord_ship_lc1_pu]
						,[ship_lc1_on_net]		     =   A.[ship_lc1_on_net]
						,[ship_lc1_on_fet]			 =	 A.[ship_lc1_on_fet]
						,[agord_ship_lc2_amt]			 =   A.[agord_ship_lc2_amt]
						,[agord_ship_lc2_rt]			 =	 A.[agord_ship_lc2_rt]
						,[agord_ship_lc2_pu]		     =   A.[agord_ship_lc2_pu]
						,[ship_lc2_on_net]			 =	 A.[ship_lc2_on_net]
						,[ship_lc2_on_fet]			 =   A.[ship_lc2_on_fet]
						,[agord_ship_lc3_amt]			 =	 A.[agord_ship_lc3_amt]
						,[agord_ship_lc3_rt]		     =   A.[agord_ship_lc3_rt]
						,[agord_ship_lc3_pu]			 =	 A.[agord_ship_lc3_pu]
						,[ship_lc3_on_net]			 =   A.[ship_lc3_on_net]
						,[ship_lc3_on_fet]			 =	 A.[ship_lc3_on_fet]
						,[agord_ship_lc4_amt]		     =   A.[agord_ship_lc4_amt]
						,[agord_ship_lc4_rt]			 =	 A.[agord_ship_lc4_rt]
						,[agord_ship_lc4_pu]			 =   A.[agord_ship_lc4_pu]
						,[ship_lc4_on_net]			 =	 A.[ship_lc4_on_net]
						,[ship_lc4_on_fet]		     =   A.[ship_lc4_on_fet]
						,[agord_ship_lc5_amt]			 =	 A.[agord_ship_lc5_amt]
						,[agord_ship_lc5_rt]			 =   A.[agord_ship_lc5_rt]
						,[agord_ship_lc5_pu]			 =	 A.[agord_ship_lc5_pu]
						,[ship_lc5_on_net]		     =   A.[ship_lc5_on_net]
						,[ship_lc5_on_fet]			 =	 A.[ship_lc5_on_fet]
						,[agord_ship_lc6_amt]			 =   A.[agord_ship_lc6_amt]
						,[agord_ship_lc6_rt]			 =	 A.[agord_ship_lc6_rt]
						,[agord_ship_lc6_pu]		     =   A.[agord_ship_lc6_pu]
						,[ship_lc6_on_net]			 =	 A.[ship_lc6_on_net]
						,[ship_lc6_on_fet]			 =   A.[ship_lc6_on_fet]
						,[agord_tax_state]			 =	 A.[agord_tax_state]
						,[agord_tax_auth_id1]		     =   A.[agord_tax_auth_id1]
						,[agord_tax_auth_id2]			 =	 A.[agord_tax_auth_id2]
						,[agord_county]				 =   A.[agord_county]
						,[agord_ppd_dep_per_un]		 =	 A.[agord_ppd_dep_per_un]
						,[agord_lot_no_yn]		     =   A.[agord_lot_no_yn]
						,[agord_load_no]				 =	 A.[agord_load_no]
						,[agord_bckord_yn]			 =   A.[agord_bckord_yn]
						,[agord_cnt_cus_no]			 =	 A.[agord_cnt_cus_no]
						,[agord_cnt_no]			     =   A.[agord_cnt_no]
						,[agord_cnt_line_no]			 =	 A.[agord_cnt_line_no]
						,[agord_blend_yn]				 =   A.[agord_blend_yn]
						,[agord_disc_amt]				 =	 A.[agord_disc_amt]
						,[agord_ppd_cnt_yndm]		     =   A.[agord_ppd_cnt_yndm]
						,[agord_gl_acct]				 =	 A.[agord_gl_acct]
						,[agord_applicator_no]		 =   A.[agord_applicator_no]
						,[agord_acct_stat]			 =	 A.[agord_acct_stat]
						,[agord_sst_ynp]			     =   A.[agord_sst_ynp]
						,[agord_un_cost]				 =	 A.[agord_un_cost]
						,[agord_src_sys]				 =   A.[agord_src_sys]
						,[agord_pay_pat_yn]			 =	 A.[agord_pay_pat_yn]
						,[agord_prc_lvl]			     =   A.[agord_prc_lvl]
						,[agord_dlvr_pkup_ind]		 =	 A.[agord_dlvr_pkup_ind]
						,[agord_currency]				 =   A.[agord_currency]
						,[agord_currency_rt]			 =	 A.[agord_currency_rt]
						,[agord_currency_cnt]		     =   A.[agord_currency_cnt]
						,[agord_hide_price_ynq]		 =	 A.[agord_hide_price_ynq]
						,[agord_order_taker]			 =   A.[agord_order_taker]
						,[agord_xfer_exp_yn]			 =	 A.[agord_xfer_exp_yn]
						,[agord_ingr_on_ivc_yn]	     =   A.[agord_ingr_on_ivc_yn]
						,[agord_gb_updated_yn]		 =	 A.[agord_gb_updated_yn]
						,[agord_tm_mtr_read]			 =   A.[agord_tm_mtr_read]
						,[agord_tm_perf_id]			 =	 A.[agord_tm_perf_id]
						,[agord_nutri_file_name]	     =   A.[agord_nutri_file_name]
						,[agord_user_id]				 =	 A.[agord_user_id]
						,[agord_user_rev_dt]			 =   A.[agord_user_rev_dt]
						,[agord_user_time]			 =	 A.[agord_user_time] 
						,[agord_no_of_months]			 =   NULL
						,[agord_final_due_dt]			 =   NULL
						,[A4GLIdentity]				 =   A.[A4GLIdentity]			
				FROM agordmst A
				WHERE A.agord_type <> ''O''
			END
			ELSE
			BEGIN
				INSERT INTO tmp_agordmstImport
				(      [agord_ord_no]
						,[agord_loc_no]
						,[agord_line_no]
						,[agord_ivc_no]
						,[agord_batch_no]
						,[agord_ord_rev_dt]
						,[agord_req_ship_rev_dt]
						,[agord_ship_rev_dt]
						,[agord_type]
						,[agord_bill_to_cus]
						,[agord_bill_to_split]
						,[agord_cash_tendered]
						,[agord_order_total]
						,[agord_ship_total]
						,[agord_disc_total]
						,[agord_slsmn_id]
						,[agord_po_no]
						,[agord_terms_cd]
						,[agord_comments]
						,[agord_ship_type]
						,[agord_srv_chg_cd]
						,[agord_adj_inv_yn]
						,[agord_tank_no]
						,[agord_lp_pct_full]
						,[agord_itm_no]
						,[agord_dtl_comments]
						,[agord_un_prc]
						,[agord_pkg_sold]
						,[agord_un_sold]
						,[agord_fet_amt]
						,[agord_fet_rt]
						,[agord_set_amt]
						,[agord_set_rt]
						,[agord_sst_amt]
						,[agord_sst_rt]
						,[agord_sst_pu]
						,[agord_sst_on_net]
						,[agord_sst_on_fet]
						,[agord_sst_on_set]
						,[agord_sst_on_lc1]
						,[agord_sst_on_lc2]
						,[agord_sst_on_lc3]
						,[agord_sst_on_lc4]
						,[agord_sst_on_lc5]
						,[agord_sst_on_lc6]
						,[agord_lc1_amt]
						,[agord_lc1_rt]
						,[agord_lc1_pu]
						,[agord_lc1_on_net]
						,[agord_lc1_on_fet]
						,[agord_lc2_amt]
						,[agord_lc2_rt]
						,[agord_lc2_pu]
						,[agord_lc2_on_net]
						,[agord_lc2_on_fet]
						,[agord_lc3_amt]
						,[agord_lc3_rt]
						,[agord_lc3_pu]
						,[agord_lc3_on_net]
						,[agord_lc3_on_fet]
						,[agord_lc4_amt]
						,[agord_lc4_rt]
						,[agord_lc4_pu]
						,[agord_lc4_on_net]
						,[agord_lc4_on_fet]
						,[agord_lc5_amt]
						,[agord_lc5_rt]
						,[agord_lc5_pu]
						,[agord_lc5_on_net]
						,[agord_lc5_on_fet]
						,[agord_lc6_amt]
						,[agord_lc6_rt]
						,[agord_lc6_pu]
						,[agord_lc6_on_net]
						,[agord_lc6_on_fet]
						,[agord_pkg_ship]
						,[agord_un_ship]
						,[agord_ship_fet_amt]
						,[agord_ship_fet_rt]
						,[agord_ship_set_amt]
						,[agord_ship_set_rt]
						,[agord_ship_sst_amt]
						,[agord_ship_sst_rt]
						,[agord_ship_sst_pu]
						,[ship_sst_on_net]
						,[ship_sst_on_fet]
						,[ship_sst_on_set]
						,[ship_sst_on_lc1]
						,[ship_sst_on_lc2]
						,[ship_sst_on_lc3]
						,[ship_sst_on_lc4]
						,[ship_sst_on_lc5]
						,[ship_sst_on_lc6]
						,[agord_ship_lc1_amt]
						,[agord_ship_lc1_rt]
						,[agord_ship_lc1_pu]
						,[ship_lc1_on_net]
						,[ship_lc1_on_fet]
						,[agord_ship_lc2_amt]
						,[agord_ship_lc2_rt]
						,[agord_ship_lc2_pu]
						,[ship_lc2_on_net]
						,[ship_lc2_on_fet]
						,[agord_ship_lc3_amt]
						,[agord_ship_lc3_rt]
						,[agord_ship_lc3_pu]
						,[ship_lc3_on_net]
						,[ship_lc3_on_fet]
						,[agord_ship_lc4_amt]
						,[agord_ship_lc4_rt]
						,[agord_ship_lc4_pu]
						,[ship_lc4_on_net]
						,[ship_lc4_on_fet]
						,[agord_ship_lc5_amt]
						,[agord_ship_lc5_rt]
						,[agord_ship_lc5_pu]
						,[ship_lc5_on_net]
						,[ship_lc5_on_fet]
						,[agord_ship_lc6_amt]
						,[agord_ship_lc6_rt]
						,[agord_ship_lc6_pu]
						,[ship_lc6_on_net]
						,[ship_lc6_on_fet]
						,[agord_tax_state]
						,[agord_tax_auth_id1]
						,[agord_tax_auth_id2]
						,[agord_county]
						,[agord_ppd_dep_per_un]
						,[agord_lot_no_yn]
						,[agord_load_no]
						,[agord_bckord_yn]
						,[agord_cnt_cus_no]
						,[agord_cnt_no]
						,[agord_cnt_line_no]
						,[agord_blend_yn]
						,[agord_disc_amt]
						,[agord_ppd_cnt_yndm]
						,[agord_gl_acct]
						,[agord_applicator_no]
						,[agord_acct_stat]
						,[agord_sst_ynp]
						,[agord_un_cost]
						,[agord_src_sys]
						,[agord_pay_pat_yn]
						,[agord_prc_lvl]
						,[agord_dlvr_pkup_ind]
						,[agord_currency]
						,[agord_currency_rt]
						,[agord_currency_cnt]
						,[agord_hide_price_ynq]
						,[agord_order_taker]
						,[agord_xfer_exp_yn]
						,[agord_ingr_on_ivc_yn]
						,[agord_gb_updated_yn]
						,[agord_tm_mtr_read]
						,[agord_tm_perf_id]
						,[agord_nutri_file_name]
						,[agord_user_id]
						,[agord_user_rev_dt]
						,[agord_user_time]
						,[agord_no_of_months]
						,[agord_final_due_dt]
						,[A4GLIdentity])

				SELECT
						[agord_ord_no]                =   A.[agord_ord_no]
						,[agord_loc_no]				 =	 A.[agord_loc_no]
						,[agord_line_no]				 =   A.[agord_line_no]
						,[agord_ivc_no]				 =	 A.[agord_ivc_no]
						,[agord_batch_no]			     =   A.[agord_batch_no]
						,[agord_ord_rev_dt]			 =	 A.[agord_ord_rev_dt]
						,[agord_req_ship_rev_dt]		 =   A.[agord_req_ship_rev_dt]
						,[agord_ship_rev_dt]			 =	 A.[agord_ship_rev_dt]
						,[agord_type]				     =   A.[agord_type]
						,[agord_bill_to_cus]			 =	 A.[agord_bill_to_cus]
						,[agord_bill_to_split]		 =   A.[agord_bill_to_split]
						,[agord_cash_tendered]		 =	 A.[agord_cash_tendered]
						,[agord_order_total]		     =   A.[agord_order_total]
						,[agord_ship_total]			 =	 A.[agord_ship_total]
						,[agord_disc_total]			 =   A.[agord_disc_total]
						,[agord_slsmn_id]				 =	 A.[agord_slsmn_id]
						,[agord_po_no]			     =   A.[agord_po_no]
						,[agord_terms_cd]				 =	 A.[agord_terms_cd]
						,[agord_comments]				 =   A.[agord_comments]
						,[agord_ship_type]			 =	 A.[agord_ship_type]
						,[agord_srv_chg_cd]		     =   A.[agord_srv_chg_cd]
						,[agord_adj_inv_yn]			 =	 A.[agord_adj_inv_yn]
						,[agord_tank_no]				 =   A.[agord_tank_no]
						,[agord_lp_pct_full]			 =	 A.[agord_lp_pct_full]
						,[agord_itm_no]			     =   A.[agord_itm_no]
						,[agord_dtl_comments]			 =	 A.[agord_dtl_comments]
						,[agord_un_prc]				 =   A.[agord_un_prc]
						,[agord_pkg_sold]				 =	 A.[agord_pkg_sold]
						,[agord_un_sold]			     =   A.[agord_un_sold]
						,[agord_fet_amt]				 =	 A.[agord_fet_amt]
						,[agord_fet_rt]				 =   A.[agord_fet_rt]
						,[agord_set_amt]				 =	 A.[agord_set_amt]
						,[agord_set_rt]			     =   A.[agord_set_rt]
						,[agord_sst_amt]				 =	 A.[agord_sst_amt]
						,[agord_sst_rt]				 =   A.[agord_sst_rt]
						,[agord_sst_pu]				 =	 A.[agord_sst_pu]
						,[agord_sst_on_net]		     =   A.[agord_sst_on_net]
						,[agord_sst_on_fet]			 =	 A.[agord_sst_on_fet]
						,[agord_sst_on_set]			 =   A.[agord_sst_on_set]
						,[agord_sst_on_lc1]			 =	 A.[agord_sst_on_lc1]
						,[agord_sst_on_lc2]		     =   A.[agord_sst_on_lc2]
						,[agord_sst_on_lc3]			 =	 A.[agord_sst_on_lc3]
						,[agord_sst_on_lc4]			 =   A.[agord_sst_on_lc4]
						,[agord_sst_on_lc5]			 =	 A.[agord_sst_on_lc5]
						,[agord_sst_on_lc6]		     =   A.[agord_sst_on_lc6]
						,[agord_lc1_amt]				 =	 A.[agord_lc1_amt]
						,[agord_lc1_rt]				 =   A.[agord_lc1_rt]
						,[agord_lc1_pu]				 =	 A.[agord_lc1_pu]
						,[agord_lc1_on_net]		     =   A.[agord_lc1_on_net]
						,[agord_lc1_on_fet]			 =	 A.[agord_lc1_on_fet]
						,[agord_lc2_amt]				 =   A.[agord_lc2_amt]
						,[agord_lc2_rt]				 =	 A.[agord_lc2_rt]
						,[agord_lc2_pu]			     =   A.[agord_lc2_pu]
						,[agord_lc2_on_net]			 =	 A.[agord_lc2_on_net]
						,[agord_lc2_on_fet]			 =   A.[agord_lc2_on_fet]
						,[agord_lc3_amt]				 =	 A.[agord_lc3_amt]
						,[agord_lc3_rt]			     =   A.[agord_lc3_rt]
						,[agord_lc3_pu]				 =	 A.[agord_lc3_pu]
						,[agord_lc3_on_net]			 =   A.[agord_lc3_on_net]
						,[agord_lc3_on_fet]			 =	 A.[agord_lc3_on_fet]
						,[agord_lc4_amt]			     =   A.[agord_lc4_amt]
						,[agord_lc4_rt]				 =	 A.[agord_lc4_rt]
						,[agord_lc4_pu]				 =   A.[agord_lc4_pu]
						,[agord_lc4_on_net]			 =	 A.[agord_lc4_on_net]
						,[agord_lc4_on_fet]		     =   A.[agord_lc4_on_fet]
						,[agord_lc5_amt]				 =	 A.[agord_lc5_amt]
						,[agord_lc5_rt]				 =   A.[agord_lc5_rt]
						,[agord_lc5_pu]				 =	 A.[agord_lc5_pu]
						,[agord_lc5_on_net]		     =   A.[agord_lc5_on_net]
						,[agord_lc5_on_fet]			 =	 A.[agord_lc5_on_fet]
						,[agord_lc6_amt]				 =   A.[agord_lc6_amt]
						,[agord_lc6_rt]				 =	 A.[agord_lc6_rt]
						,[agord_lc6_pu]			     =   A.[agord_lc6_pu]
						,[agord_lc6_on_net]			 =	 A.[agord_lc6_on_net]
						,[agord_lc6_on_fet]			 =   A.[agord_lc6_on_fet]
						,[agord_pkg_ship]				 =	 A.[agord_pkg_ship]
						,[agord_un_ship]			     =   A.[agord_un_ship]
						,[agord_ship_fet_amt]			 =	 A.[agord_ship_fet_amt]
						,[agord_ship_fet_rt]			 =   A.[agord_ship_fet_rt]
						,[agord_ship_set_amt]			 =	 A.[agord_ship_set_amt]
						,[agord_ship_set_rt]		     =   A.[agord_ship_set_rt]
						,[agord_ship_sst_amt]			 =	 A.[agord_ship_sst_amt]
						,[agord_ship_sst_rt]			 =   A.[agord_ship_sst_rt]
						,[agord_ship_sst_pu]			 =	 A.[agord_ship_sst_pu]
						,[ship_sst_on_net]		     =   A.[ship_sst_on_net]
						,[ship_sst_on_fet]			 =	 A.[ship_sst_on_fet]
						,[ship_sst_on_set]			 =   A.[ship_sst_on_set]
						,[ship_sst_on_lc1]			 =	 A.[ship_sst_on_lc1]
						,[ship_sst_on_lc2]		     =   A.[ship_sst_on_lc2]
						,[ship_sst_on_lc3]			 =	 A.[ship_sst_on_lc3]
						,[ship_sst_on_lc4]			 =   A.[ship_sst_on_lc4]
						,[ship_sst_on_lc5]			 =	 A.[ship_sst_on_lc5]
						,[ship_sst_on_lc6]		     =   A.[ship_sst_on_lc6]
						,[agord_ship_lc1_amt]			 =	 A.[agord_ship_lc1_amt]
						,[agord_ship_lc1_rt]			 =   A.[agord_ship_lc1_rt]
						,[agord_ship_lc1_pu]			 =	 A.[agord_ship_lc1_pu]
						,[ship_lc1_on_net]		     =   A.[ship_lc1_on_net]
						,[ship_lc1_on_fet]			 =	 A.[ship_lc1_on_fet]
						,[agord_ship_lc2_amt]			 =   A.[agord_ship_lc2_amt]
						,[agord_ship_lc2_rt]			 =	 A.[agord_ship_lc2_rt]
						,[agord_ship_lc2_pu]		     =   A.[agord_ship_lc2_pu]
						,[ship_lc2_on_net]			 =	 A.[ship_lc2_on_net]
						,[ship_lc2_on_fet]			 =   A.[ship_lc2_on_fet]
						,[agord_ship_lc3_amt]			 =	 A.[agord_ship_lc3_amt]
						,[agord_ship_lc3_rt]		     =   A.[agord_ship_lc3_rt]
						,[agord_ship_lc3_pu]			 =	 A.[agord_ship_lc3_pu]
						,[ship_lc3_on_net]			 =   A.[ship_lc3_on_net]
						,[ship_lc3_on_fet]			 =	 A.[ship_lc3_on_fet]
						,[agord_ship_lc4_amt]		     =   A.[agord_ship_lc4_amt]
						,[agord_ship_lc4_rt]			 =	 A.[agord_ship_lc4_rt]
						,[agord_ship_lc4_pu]			 =   A.[agord_ship_lc4_pu]
						,[ship_lc4_on_net]			 =	 A.[ship_lc4_on_net]
						,[ship_lc4_on_fet]		     =   A.[ship_lc4_on_fet]
						,[agord_ship_lc5_amt]			 =	 A.[agord_ship_lc5_amt]
						,[agord_ship_lc5_rt]			 =   A.[agord_ship_lc5_rt]
						,[agord_ship_lc5_pu]			 =	 A.[agord_ship_lc5_pu]
						,[ship_lc5_on_net]		     =   A.[ship_lc5_on_net]
						,[ship_lc5_on_fet]			 =	 A.[ship_lc5_on_fet]
						,[agord_ship_lc6_amt]			 =   A.[agord_ship_lc6_amt]
						,[agord_ship_lc6_rt]			 =	 A.[agord_ship_lc6_rt]
						,[agord_ship_lc6_pu]		     =   A.[agord_ship_lc6_pu]
						,[ship_lc6_on_net]			 =	 A.[ship_lc6_on_net]
						,[ship_lc6_on_fet]			 =   A.[ship_lc6_on_fet]
						,[agord_tax_state]			 =	 A.[agord_tax_state]
						,[agord_tax_auth_id1]		     =   A.[agord_tax_auth_id1]
						,[agord_tax_auth_id2]			 =	 A.[agord_tax_auth_id2]
						,[agord_county]				 =   A.[agord_county]
						,[agord_ppd_dep_per_un]		 =	 A.[agord_ppd_dep_per_un]
						,[agord_lot_no_yn]		     =   A.[agord_lot_no_yn]
						,[agord_load_no]				 =	 A.[agord_load_no]
						,[agord_bckord_yn]			 =   A.[agord_bckord_yn]
						,[agord_cnt_cus_no]			 =	 A.[agord_cnt_cus_no]
						,[agord_cnt_no]			     =   A.[agord_cnt_no]
						,[agord_cnt_line_no]			 =	 A.[agord_cnt_line_no]
						,[agord_blend_yn]				 =   A.[agord_blend_yn]
						,[agord_disc_amt]				 =	 A.[agord_disc_amt]
						,[agord_ppd_cnt_yndm]		     =   A.[agord_ppd_cnt_yndm]
						,[agord_gl_acct]				 =	 A.[agord_gl_acct]
						,[agord_applicator_no]		 =   A.[agord_applicator_no]
						,[agord_acct_stat]			 =	 A.[agord_acct_stat]
						,[agord_sst_ynp]			     =   A.[agord_sst_ynp]
						,[agord_un_cost]				 =	 A.[agord_un_cost]
						,[agord_src_sys]				 =   A.[agord_src_sys]
						,[agord_pay_pat_yn]			 =	 A.[agord_pay_pat_yn]
						,[agord_prc_lvl]			     =   A.[agord_prc_lvl]
						,[agord_dlvr_pkup_ind]		 =	 A.[agord_dlvr_pkup_ind]
						,[agord_currency]				 =   A.[agord_currency]
						,[agord_currency_rt]			 =	 A.[agord_currency_rt]
						,[agord_currency_cnt]		     =   A.[agord_currency_cnt]
						,[agord_hide_price_ynq]		 =	 A.[agord_hide_price_ynq]
						,[agord_order_taker]			 =   A.[agord_order_taker]
						,[agord_xfer_exp_yn]			 =	 A.[agord_xfer_exp_yn]
						,[agord_ingr_on_ivc_yn]	     =   A.[agord_ingr_on_ivc_yn]
						,[agord_gb_updated_yn]		 =	 A.[agord_gb_updated_yn]
						,[agord_tm_mtr_read]			 =   A.[agord_tm_mtr_read]
						,[agord_tm_perf_id]			 =	 A.[agord_tm_perf_id]
						,[agord_nutri_file_name]	     =   A.[agord_nutri_file_name]
						,[agord_user_id]				 =	 A.[agord_user_id]
						,[agord_user_rev_dt]			 =   A.[agord_user_rev_dt]
						,[agord_user_time]			 =	 A.[agord_user_time]
						,[agord_no_of_months]			 =   NULL
						,[agord_final_due_dt]			 =   NULL
						,[A4GLIdentity]				 =   A.[A4GLIdentity]			
				FROM agordmst A
				WHERE A.agord_type <> ''O''
				AND 1 = (CASE WHEN CONVERT(DATE, CAST(A.agord_ord_rev_dt AS CHAR(12)), 112) BETWEEN @DateFrom AND @DateTo THEN 1 ELSE 0 END)
			END

			IF OBJECT_ID(''tempdb..#tmpUnostedInvoiceBackupId'') IS NOT NULL DROP TABLE #tmpUnostedInvoiceBackupId
			CREATE TABLE #tmpUnostedInvoiceBackupId(intBackupId INT, intId INT)

			MERGE INTO tblARagordmst AS destination
			USING
			(
			SELECT 
					[agord_ord_no]
					,[agord_loc_no]
					,[agord_line_no]
					,[agord_ivc_no]
					,[agord_batch_no]
					,[agord_ord_rev_dt]
					,[agord_req_ship_rev_dt]
					,[agord_ship_rev_dt]
					,[agord_type]
					,[agord_bill_to_cus]
					,[agord_bill_to_split]
					,[agord_cash_tendered]
					,[agord_order_total]
					,[agord_ship_total]
					,[agord_disc_total]
					,[agord_slsmn_id]
					,[agord_po_no]
					,[agord_terms_cd]
					,[agord_comments]
					,[agord_ship_type]
					,[agord_srv_chg_cd]
					,[agord_adj_inv_yn]
					,[agord_tank_no]
					,[agord_lp_pct_full]
					,[agord_itm_no]
					,[agord_dtl_comments]
					,[agord_un_prc]
					,[agord_pkg_sold]
					,[agord_un_sold]
					,[agord_fet_amt]
					,[agord_fet_rt]
					,[agord_set_amt]
					,[agord_set_rt]
					,[agord_sst_amt]
					,[agord_sst_rt]
					,[agord_sst_pu]
					,[agord_sst_on_net]
					,[agord_sst_on_fet]
					,[agord_sst_on_set]
					,[agord_sst_on_lc1]
					,[agord_sst_on_lc2]
					,[agord_sst_on_lc3]
					,[agord_sst_on_lc4]
					,[agord_sst_on_lc5]
					,[agord_sst_on_lc6]
					,[agord_lc1_amt]
					,[agord_lc1_rt]
					,[agord_lc1_pu]
					,[agord_lc1_on_net]
					,[agord_lc1_on_fet]
					,[agord_lc2_amt]
					,[agord_lc2_rt]
					,[agord_lc2_pu]
					,[agord_lc2_on_net]
					,[agord_lc2_on_fet]
					,[agord_lc3_amt]
					,[agord_lc3_rt]
					,[agord_lc3_pu]
					,[agord_lc3_on_net]
					,[agord_lc3_on_fet]
					,[agord_lc4_amt]
					,[agord_lc4_rt]
					,[agord_lc4_pu]
					,[agord_lc4_on_net]
					,[agord_lc4_on_fet]
					,[agord_lc5_amt]
					,[agord_lc5_rt]
					,[agord_lc5_pu]
					,[agord_lc5_on_net]
					,[agord_lc5_on_fet]
					,[agord_lc6_amt]
					,[agord_lc6_rt]
					,[agord_lc6_pu]
					,[agord_lc6_on_net]
					,[agord_lc6_on_fet]
					,[agord_pkg_ship]
					,[agord_un_ship]
					,[agord_ship_fet_amt]
					,[agord_ship_fet_rt]
					,[agord_ship_set_amt]
					,[agord_ship_set_rt]
					,[agord_ship_sst_amt]
					,[agord_ship_sst_rt]
					,[agord_ship_sst_pu]
					,[ship_sst_on_net]
					,[ship_sst_on_fet]
					,[ship_sst_on_set]
					,[ship_sst_on_lc1]
					,[ship_sst_on_lc2]
					,[ship_sst_on_lc3]
					,[ship_sst_on_lc4]
					,[ship_sst_on_lc5]
					,[ship_sst_on_lc6]
					,[agord_ship_lc1_amt]
					,[agord_ship_lc1_rt]
					,[agord_ship_lc1_pu]
					,[ship_lc1_on_net]
					,[ship_lc1_on_fet]
					,[agord_ship_lc2_amt]
					,[agord_ship_lc2_rt]
					,[agord_ship_lc2_pu]
					,[ship_lc2_on_net]
					,[ship_lc2_on_fet]
					,[agord_ship_lc3_amt]
					,[agord_ship_lc3_rt]
					,[agord_ship_lc3_pu]
					,[ship_lc3_on_net]
					,[ship_lc3_on_fet]
					,[agord_ship_lc4_amt]
					,[agord_ship_lc4_rt]
					,[agord_ship_lc4_pu]
					,[ship_lc4_on_net]
					,[ship_lc4_on_fet]
					,[agord_ship_lc5_amt]
					,[agord_ship_lc5_rt]
					,[agord_ship_lc5_pu]
					,[ship_lc5_on_net]
					,[ship_lc5_on_fet]
					,[agord_ship_lc6_amt]
					,[agord_ship_lc6_rt]
					,[agord_ship_lc6_pu]
					,[ship_lc6_on_net]
					,[ship_lc6_on_fet]
					,[agord_tax_state]
					,[agord_tax_auth_id1]
					,[agord_tax_auth_id2]
					,[agord_county]
					,[agord_ppd_dep_per_un]
					,[agord_lot_no_yn]
					,[agord_load_no]
					,[agord_bckord_yn]
					,[agord_cnt_cus_no]
					,[agord_cnt_no]
					,[agord_cnt_line_no]
					,[agord_blend_yn]
					,[agord_disc_amt]
					,[agord_ppd_cnt_yndm]
					,[agord_gl_acct]
					,[agord_applicator_no]
					,[agord_acct_stat]
					,[agord_sst_ynp]
					,[agord_un_cost]
					,[agord_src_sys]
					,[agord_pay_pat_yn]
					,[agord_prc_lvl]
					,[agord_dlvr_pkup_ind]
					,[agord_currency]
					,[agord_currency_rt]
					,[agord_currency_cnt]
					,[agord_hide_price_ynq]
					,[agord_order_taker]
					,[agord_xfer_exp_yn]
					,[agord_ingr_on_ivc_yn]
					,[agord_gb_updated_yn]
					,[agord_tm_mtr_read]
					,[agord_tm_perf_id]
					,[agord_nutri_file_name]
					,[agord_user_id]
					,[agord_user_rev_dt]
					,[agord_user_time]      
					,[agord_no_of_months]
					,[agord_final_due_dt]
					,[A4GLIdentity]	
					,[intId]
			FROM tmp_agordmstImport	
			) AS SourceData
			ON (1=0)
			WHEN NOT MATCHED THEN
			INSERT
			(
					[agord_ord_no]
					,[agord_loc_no]
					,[agord_line_no]
					,[agord_ivc_no]
					,[agord_batch_no]
					,[agord_ord_rev_dt]
					,[agord_req_ship_rev_dt]
					,[agord_ship_rev_dt]
					,[agord_type]
					,[agord_bill_to_cus]
					,[agord_bill_to_split]
					,[agord_cash_tendered]
					,[agord_order_total]
					,[agord_ship_total]
					,[agord_disc_total]
					,[agord_slsmn_id]
					,[agord_po_no]
					,[agord_terms_cd]
					,[agord_comments]
					,[agord_ship_type]
					,[agord_srv_chg_cd]
					,[agord_adj_inv_yn]
					,[agord_tank_no]
					,[agord_lp_pct_full]
					,[agord_itm_no]
					,[agord_dtl_comments]
					,[agord_un_prc]
					,[agord_pkg_sold]
					,[agord_un_sold]
					,[agord_fet_amt]
					,[agord_fet_rt]
					,[agord_set_amt]
					,[agord_set_rt]
					,[agord_sst_amt]
					,[agord_sst_rt]
					,[agord_sst_pu]
					,[agord_sst_on_net]
					,[agord_sst_on_fet]
					,[agord_sst_on_set]
					,[agord_sst_on_lc1]
					,[agord_sst_on_lc2]
					,[agord_sst_on_lc3]
					,[agord_sst_on_lc4]
					,[agord_sst_on_lc5]
					,[agord_sst_on_lc6]
					,[agord_lc1_amt]
					,[agord_lc1_rt]
					,[agord_lc1_pu]
					,[agord_lc1_on_net]
					,[agord_lc1_on_fet]
					,[agord_lc2_amt]
					,[agord_lc2_rt]
					,[agord_lc2_pu]
					,[agord_lc2_on_net]
					,[agord_lc2_on_fet]
					,[agord_lc3_amt]
					,[agord_lc3_rt]
					,[agord_lc3_pu]
					,[agord_lc3_on_net]
					,[agord_lc3_on_fet]
					,[agord_lc4_amt]
					,[agord_lc4_rt]
					,[agord_lc4_pu]
					,[agord_lc4_on_net]
					,[agord_lc4_on_fet]
					,[agord_lc5_amt]
					,[agord_lc5_rt]
					,[agord_lc5_pu]
					,[agord_lc5_on_net]
					,[agord_lc5_on_fet]
					,[agord_lc6_amt]
					,[agord_lc6_rt]
					,[agord_lc6_pu]
					,[agord_lc6_on_net]
					,[agord_lc6_on_fet]
					,[agord_pkg_ship]
					,[agord_un_ship]
					,[agord_ship_fet_amt]
					,[agord_ship_fet_rt]
					,[agord_ship_set_amt]
					,[agord_ship_set_rt]
					,[agord_ship_sst_amt]
					,[agord_ship_sst_rt]
					,[agord_ship_sst_pu]
					,[ship_sst_on_net]
					,[ship_sst_on_fet]
					,[ship_sst_on_set]
					,[ship_sst_on_lc1]
					,[ship_sst_on_lc2]
					,[ship_sst_on_lc3]
					,[ship_sst_on_lc4]
					,[ship_sst_on_lc5]
					,[ship_sst_on_lc6]
					,[agord_ship_lc1_amt]
					,[agord_ship_lc1_rt]
					,[agord_ship_lc1_pu]
					,[ship_lc1_on_net]
					,[ship_lc1_on_fet]
					,[agord_ship_lc2_amt]
					,[agord_ship_lc2_rt]
					,[agord_ship_lc2_pu]
					,[ship_lc2_on_net]
					,[ship_lc2_on_fet]
					,[agord_ship_lc3_amt]
					,[agord_ship_lc3_rt]
					,[agord_ship_lc3_pu]
					,[ship_lc3_on_net]
					,[ship_lc3_on_fet]
					,[agord_ship_lc4_amt]
					,[agord_ship_lc4_rt]
					,[agord_ship_lc4_pu]
					,[ship_lc4_on_net]
					,[ship_lc4_on_fet]
					,[agord_ship_lc5_amt]
					,[agord_ship_lc5_rt]
					,[agord_ship_lc5_pu]
					,[ship_lc5_on_net]
					,[ship_lc5_on_fet]
					,[agord_ship_lc6_amt]
					,[agord_ship_lc6_rt]
					,[agord_ship_lc6_pu]
					,[ship_lc6_on_net]
					,[ship_lc6_on_fet]
					,[agord_tax_state]
					,[agord_tax_auth_id1]
					,[agord_tax_auth_id2]
					,[agord_county]
					,[agord_ppd_dep_per_un]
					,[agord_lot_no_yn]
					,[agord_load_no]
					,[agord_bckord_yn]
					,[agord_cnt_cus_no]
					,[agord_cnt_no]
					,[agord_cnt_line_no]
					,[agord_blend_yn]
					,[agord_disc_amt]
					,[agord_ppd_cnt_yndm]
					,[agord_gl_acct]
					,[agord_applicator_no]
					,[agord_acct_stat]
					,[agord_sst_ynp]
					,[agord_un_cost]
					,[agord_src_sys]
					,[agord_pay_pat_yn]
					,[agord_prc_lvl]
					,[agord_dlvr_pkup_ind]
					,[agord_currency]
					,[agord_currency_rt]
					,[agord_currency_cnt]
					,[agord_hide_price_ynq]
					,[agord_order_taker]
					,[agord_xfer_exp_yn]
					,[agord_ingr_on_ivc_yn]
					,[agord_gb_updated_yn]
					,[agord_tm_mtr_read]
					,[agord_tm_perf_id]
					,[agord_nutri_file_name]
					,[agord_user_id]
					,[agord_user_rev_dt]
					,[agord_user_time]
					,[agord_no_of_months]
					,[agord_final_due_dt]
					,[A4GLIdentity]			 	
			)
			VALUES
			(
					[agord_ord_no]
					,[agord_loc_no]
					,[agord_line_no]
					,[agord_ivc_no]
					,[agord_batch_no]
					,[agord_ord_rev_dt]
					,[agord_req_ship_rev_dt]
					,[agord_ship_rev_dt]
					,[agord_type]
					,[agord_bill_to_cus]
					,[agord_bill_to_split]
					,[agord_cash_tendered]
					,[agord_order_total]
					,[agord_ship_total]
					,[agord_disc_total]
					,[agord_slsmn_id]
					,[agord_po_no]
					,[agord_terms_cd]
					,[agord_comments]
					,[agord_ship_type]
					,[agord_srv_chg_cd]
					,[agord_adj_inv_yn]
					,[agord_tank_no]
					,[agord_lp_pct_full]
					,[agord_itm_no]
					,[agord_dtl_comments]
					,[agord_un_prc]
					,[agord_pkg_sold]
					,[agord_un_sold]
					,[agord_fet_amt]
					,[agord_fet_rt]
					,[agord_set_amt]
					,[agord_set_rt]
					,[agord_sst_amt]
					,[agord_sst_rt]
					,[agord_sst_pu]
					,[agord_sst_on_net]
					,[agord_sst_on_fet]
					,[agord_sst_on_set]
					,[agord_sst_on_lc1]
					,[agord_sst_on_lc2]
					,[agord_sst_on_lc3]
					,[agord_sst_on_lc4]
					,[agord_sst_on_lc5]
					,[agord_sst_on_lc6]
					,[agord_lc1_amt]
					,[agord_lc1_rt]
					,[agord_lc1_pu]
					,[agord_lc1_on_net]
					,[agord_lc1_on_fet]
					,[agord_lc2_amt]
					,[agord_lc2_rt]
					,[agord_lc2_pu]
					,[agord_lc2_on_net]
					,[agord_lc2_on_fet]
					,[agord_lc3_amt]
					,[agord_lc3_rt]
					,[agord_lc3_pu]
					,[agord_lc3_on_net]
					,[agord_lc3_on_fet]
					,[agord_lc4_amt]
					,[agord_lc4_rt]
					,[agord_lc4_pu]
					,[agord_lc4_on_net]
					,[agord_lc4_on_fet]
					,[agord_lc5_amt]
					,[agord_lc5_rt]
					,[agord_lc5_pu]
					,[agord_lc5_on_net]
					,[agord_lc5_on_fet]
					,[agord_lc6_amt]
					,[agord_lc6_rt]
					,[agord_lc6_pu]
					,[agord_lc6_on_net]
					,[agord_lc6_on_fet]
					,[agord_pkg_ship]
					,[agord_un_ship]
					,[agord_ship_fet_amt]
					,[agord_ship_fet_rt]
					,[agord_ship_set_amt]
					,[agord_ship_set_rt]
					,[agord_ship_sst_amt]
					,[agord_ship_sst_rt]
					,[agord_ship_sst_pu]
					,[ship_sst_on_net]
					,[ship_sst_on_fet]
					,[ship_sst_on_set]
					,[ship_sst_on_lc1]
					,[ship_sst_on_lc2]
					,[ship_sst_on_lc3]
					,[ship_sst_on_lc4]
					,[ship_sst_on_lc5]
					,[ship_sst_on_lc6]
					,[agord_ship_lc1_amt]
					,[agord_ship_lc1_rt]
					,[agord_ship_lc1_pu]
					,[ship_lc1_on_net]
					,[ship_lc1_on_fet]
					,[agord_ship_lc2_amt]
					,[agord_ship_lc2_rt]
					,[agord_ship_lc2_pu]
					,[ship_lc2_on_net]
					,[ship_lc2_on_fet]
					,[agord_ship_lc3_amt]
					,[agord_ship_lc3_rt]
					,[agord_ship_lc3_pu]
					,[ship_lc3_on_net]
					,[ship_lc3_on_fet]
					,[agord_ship_lc4_amt]
					,[agord_ship_lc4_rt]
					,[agord_ship_lc4_pu]
					,[ship_lc4_on_net]
					,[ship_lc4_on_fet]
					,[agord_ship_lc5_amt]
					,[agord_ship_lc5_rt]
					,[agord_ship_lc5_pu]
					,[ship_lc5_on_net]
					,[ship_lc5_on_fet]
					,[agord_ship_lc6_amt]
					,[agord_ship_lc6_rt]
					,[agord_ship_lc6_pu]
					,[ship_lc6_on_net]
					,[ship_lc6_on_fet]
					,[agord_tax_state]
					,[agord_tax_auth_id1]
					,[agord_tax_auth_id2]
					,[agord_county]
					,[agord_ppd_dep_per_un]
					,[agord_lot_no_yn]
					,[agord_load_no]
					,[agord_bckord_yn]
					,[agord_cnt_cus_no]
					,[agord_cnt_no]
					,[agord_cnt_line_no]
					,[agord_blend_yn]
					,[agord_disc_amt]
					,[agord_ppd_cnt_yndm]
					,[agord_gl_acct]
					,[agord_applicator_no]
					,[agord_acct_stat]
					,[agord_sst_ynp]
					,[agord_un_cost]
					,[agord_src_sys]
					,[agord_pay_pat_yn]
					,[agord_prc_lvl]
					,[agord_dlvr_pkup_ind]
					,[agord_currency]
					,[agord_currency_rt]
					,[agord_currency_cnt]
					,[agord_hide_price_ynq]
					,[agord_order_taker]
					,[agord_xfer_exp_yn]
					,[agord_ingr_on_ivc_yn]
					,[agord_gb_updated_yn]
					,[agord_tm_mtr_read]
					,[agord_tm_perf_id]
					,[agord_nutri_file_name]
					,[agord_user_id]
					,[agord_user_rev_dt]
					,[agord_user_time]
					,[agord_no_of_months]
					,[agord_final_due_dt]
					,[A4GLIdentity]		
			)
			OUTPUT inserted.intId, SourceData.intId INTO #tmpUnostedInvoiceBackupId;

			SET @totalagordmst = @@ROWCOUNT;

			--UPDATE temp data for the back up link
			UPDATE A
				SET A.intBackupId = B.intBackupId
			FROM tmp_agordmstImport A
			INNER JOIN #tmpUnostedInvoiceBackupId B ON A.intId = B.intId

			DELETE A
			FROM agordmst A
			INNER JOIN tmp_agordmstImport B 
			ON A.[agord_cus_no] = B.[agord_cus_no] AND A.agord_ivc_no = B.agord_ivc_no AND A.A4GLIdentity = B.A4GLIdentity

			IF @transCount = 0 COMMIT TRANSACTION
			END TRY
			BEGIN CATCH
				DECLARE @errorBackingUp NVARCHAR(500) = ERROR_MESSAGE();
				IF @transCount = 0 AND XACT_STATE() <> 0 ROLLBACK TRANSACTION
				RAISERROR(@errorBackingUp, 16, 1);
			END CATCH
			')
	END
END

END

GO



 