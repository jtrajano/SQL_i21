StartTest (function (t) {
    new iRely.FunctionalTest().start(t)

        //region Scenario 1: Add Lotted Yes Serial Item
        .displayText('===== Scenario 1: Add Lotted Yes Serial Item =====')
        .clickMenuFolder('Inventory','Folder')
        .clickMenuScreen('Items','Screen')
        .clickButton('New')
        .enterData('Text Field','ItemNo','001 - CLTI')
        .enterData('Text Field','Description','001 - CRUD Lotted Item Serial')
        .selectComboBoxRowValue('Category', 'Grains', 'Category',0)
        .selectComboBoxRowValue('Commodity', 'Corn', 'Commodity',0)
        .selectComboBoxRowNumber('LotTracking',2,0)
        .verifyData('Combo Box','Tracking','Lot Level')

        .displayText('===== Setup Item UOM=====')
        .selectGridComboBoxRowValue('UnitOfMeasure',1,'strUnitMeasure','LB','strUnitMeasure')
        .selectGridComboBoxRowValue('UnitOfMeasure',2,'strUnitMeasure','50 lb bag','strUnitMeasure')
        .selectGridComboBoxRowValue('UnitOfMeasure',3,'strUnitMeasure','Bushels','strUnitMeasure')
        .selectGridComboBoxRowValue('UnitOfMeasure',4,'strUnitMeasure','25 kg bag','strUnitMeasure')
        .clickGridCheckBox('UnitOfMeasure', 'strUnitMeasure', 'LB', 'ysnStockUnit', true)
        .waitTillLoaded()
        .verifyGridData('UnitOfMeasure', 1, 'colDetailUnitQty', '1')
        .verifyGridData('UnitOfMeasure', 2, 'colDetailUnitQty', '50')
        .verifyGridData('UnitOfMeasure', 3, 'colDetailUnitQty', '56')
        .verifyGridData('UnitOfMeasure', 4, 'colDetailUnitQty', '55.1156')
        .logSuccess('Setup Item UOM Successful!')

        .displayText('===== Setup Item GL Accounts=====')
        .clickTab('Setup')
        .clickButton('AddRequiredAccounts')
        .verifyGridData('GlAccounts', 1, 'colGLAccountCategory', 'AP Clearing')
        .verifyGridData('GlAccounts', 2, 'colGLAccountCategory', 'Inventory')
        .verifyGridData('GlAccounts', 3, 'colGLAccountCategory', 'Cost of Goods')
        .verifyGridData('GlAccounts', 4, 'colGLAccountCategory', 'Sales Account')
        .verifyGridData('GlAccounts', 5, 'colGLAccountCategory', 'Inventory In-Transit')
        .verifyGridData('GlAccounts', 6, 'colGLAccountCategory', 'Inventory Adjustment')
        .verifyGridData('GlAccounts', 7, 'colGLAccountCategory', 'Auto-Variance')
        .selectGridComboBoxRowValue('GlAccounts', 1, 'strAccountId', '21000-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 2, 'strAccountId', '16000-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 3, 'strAccountId', '50000-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 4, 'strAccountId', '40010-0001-006', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 5, 'strAccountId', '16050-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 6, 'strAccountId', '16040-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 7, 'strAccountId', '16010-0000-000', 'strAccountId')
        .logSuccess('Setup Item GL Accounts Successful!')

        .displayText('===== Setup Item Location=====')
        .clickTab('Location')
        .clickButton('AddLocation')
        .waitTillLoaded()
        .selectComboBoxRowValue('SubLocation', 'Raw Station', 'SubLocation',0)
        .selectComboBoxRowValue('StorageLocation', 'RM Storage', 'StorageLocation',0)
        .selectComboBoxRowValue('IssueUom', 'LB', 'IssueUom',0)
        .selectComboBoxRowValue('ReceiveUom', 'LB', 'ReceiveUom',0)
        .clickButton('Save')
        .clickButton('Close')
        .logSuccess('Setup Item Location Successful!')

        .displayText('===== Setup Item Pricing=====')
        .clickTab('Pricing')
        .waitTillLoaded()
        .verifyGridData('Pricing', 1, 'strLocationName', '0001 - Fort Wayne')
        .enterGridData('Pricing', 1, 'dblLastCost', '10')
        .enterGridData('Pricing', 1, 'dblStandardCost', '10')
        .selectGridComboBoxRowNumber('Pricing', 1, 'strPricingMethod',3)
        .enterGridData('Pricing', 1, 'dblAmountPercent', '40')
        .clickButton('Save')
        .clickButton('Close')
        .logSuccess('Setup Item Pricing Successful!')


        //region Scenario 2: Add Lotted Yes Manual Item
        .displayText('===== Scenario 2: Add Lotted Yes Manual Item =====')
        .clickButton('New')
        .enterData('Text Field','ItemNo','002 - CLTI')
        .enterData('Text Field','Description','002 - CRUD Lotted Item Manual')
        .selectComboBoxRowValue('Category', 'Grains', 'Category',0)
        .selectComboBoxRowValue('Commodity', 'Corn', 'Commodity',0)
        .selectComboBoxRowNumber('LotTracking',1,0)
        .verifyData('Combo Box','Tracking','Lot Level')

        .displayText('===== Setup Item UOM=====')
        .selectGridComboBoxRowValue('UnitOfMeasure',1,'strUnitMeasure','LB','strUnitMeasure')
        .selectGridComboBoxRowValue('UnitOfMeasure',2,'strUnitMeasure','50 lb bag','strUnitMeasure')
        .selectGridComboBoxRowValue('UnitOfMeasure',3,'strUnitMeasure','Bushels','strUnitMeasure')
        .selectGridComboBoxRowValue('UnitOfMeasure',4,'strUnitMeasure','25 kg bag','strUnitMeasure')
        .clickGridCheckBox('UnitOfMeasure', 'strUnitMeasure', 'LB', 'ysnStockUnit', true)
        .waitTillLoaded()
        .verifyGridData('UnitOfMeasure', 1, 'colDetailUnitQty', '1')
        .verifyGridData('UnitOfMeasure', 2, 'colDetailUnitQty', '50')
        .verifyGridData('UnitOfMeasure', 3, 'colDetailUnitQty', '56')
        .verifyGridData('UnitOfMeasure', 4, 'colDetailUnitQty', '55.1156')
        .logSuccess('Setup Item UOM Successful!')

        .displayText('===== Setup Item GL Accounts=====')
        .clickTab('Setup')
        .clickButton('AddRequiredAccounts')
        .verifyGridData('GlAccounts', 1, 'colGLAccountCategory', 'AP Clearing')
        .verifyGridData('GlAccounts', 2, 'colGLAccountCategory', 'Inventory')
        .verifyGridData('GlAccounts', 3, 'colGLAccountCategory', 'Cost of Goods')
        .verifyGridData('GlAccounts', 4, 'colGLAccountCategory', 'Sales Account')
        .verifyGridData('GlAccounts', 5, 'colGLAccountCategory', 'Inventory In-Transit')
        .verifyGridData('GlAccounts', 6, 'colGLAccountCategory', 'Inventory Adjustment')
        .verifyGridData('GlAccounts', 7, 'colGLAccountCategory', 'Auto-Variance')
        .selectGridComboBoxRowValue('GlAccounts', 1, 'strAccountId', '21000-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 2, 'strAccountId', '16000-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 3, 'strAccountId', '50000-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 4, 'strAccountId', '40010-0001-006', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 5, 'strAccountId', '16050-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 6, 'strAccountId', '16040-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 7, 'strAccountId', '16010-0000-000', 'strAccountId')
        .logSuccess('Setup Item GL Accounts Successful!')

        .displayText('===== Setup Item Location=====')
        .clickTab('Location')
        .clickButton('AddLocation')
        .waitTillLoaded()
        .selectComboBoxRowValue('SubLocation', 'Raw Station', 'SubLocation',0)
        .selectComboBoxRowValue('StorageLocation', 'RM Storage', 'StorageLocation',0)
        .selectComboBoxRowValue('IssueUom', 'LB', 'IssueUom',0)
        .selectComboBoxRowValue('ReceiveUom', 'LB', 'ReceiveUom',0)
        .clickButton('Save')
        .clickButton('Close')
        .logSuccess('Setup Item Location Successful!')

        .displayText('===== Setup Item Pricing=====')
        .clickTab('Pricing')
        .waitTillLoaded()
        .verifyGridData('Pricing', 1, 'strLocationName', '0001 - Fort Wayne')
        .enterGridData('Pricing', 1, 'dblLastCost', '10')
        .enterGridData('Pricing', 1, 'dblStandardCost', '10')
        .selectGridComboBoxRowNumber('Pricing', 1, 'strPricingMethod',3)
        .enterGridData('Pricing', 1, 'dblAmountPercent', '40')
        .clickButton('Save')
        .clickButton('Close')
        .logSuccess('Setup Item Pricing Successful!')



        //region Scenario 3: Add Non Lotted Item
        .displayText('===== Scenario 3: Add Non Lotted Item =====')
        .clickButton('New')
        .enterData('Text Field','ItemNo','001 - CNLTI')
        .enterData('Text Field','Description','001 - CRUD Non Lotted Item')
        .selectComboBoxRowValue('Category', 'Grains', 'Category',0)
        .selectComboBoxRowValue('Commodity', 'Corn', 'Commodity',0)
        .selectComboBoxRowNumber('LotTracking',3,0)
        .verifyData('Combo Box','Tracking','Item Level')

        .displayText('===== Setup Item UOM=====')
        .selectGridComboBoxRowValue('UnitOfMeasure',1,'strUnitMeasure','LB','strUnitMeasure')
        .selectGridComboBoxRowValue('UnitOfMeasure',2,'strUnitMeasure','50 lb bag','strUnitMeasure')
        .selectGridComboBoxRowValue('UnitOfMeasure',3,'strUnitMeasure','Bushels','strUnitMeasure')
        .selectGridComboBoxRowValue('UnitOfMeasure',4,'strUnitMeasure','25 kg bag','strUnitMeasure')
        .clickGridCheckBox('UnitOfMeasure', 'strUnitMeasure', 'LB', 'ysnStockUnit', true)
        .waitTillLoaded()
        .verifyGridData('UnitOfMeasure', 1, 'colDetailUnitQty', '1')
        .verifyGridData('UnitOfMeasure', 2, 'colDetailUnitQty', '50')
        .verifyGridData('UnitOfMeasure', 3, 'colDetailUnitQty', '56')
        .verifyGridData('UnitOfMeasure', 4, 'colDetailUnitQty', '55.1156')
        .logSuccess('Setup Item UOM Successful!')

        .displayText('===== Setup Item GL Accounts=====')
        .clickTab('Setup')
        .clickButton('AddRequiredAccounts')
        .verifyGridData('GlAccounts', 1, 'colGLAccountCategory', 'AP Clearing')
        .verifyGridData('GlAccounts', 2, 'colGLAccountCategory', 'Inventory')
        .verifyGridData('GlAccounts', 3, 'colGLAccountCategory', 'Cost of Goods')
        .verifyGridData('GlAccounts', 4, 'colGLAccountCategory', 'Sales Account')
        .verifyGridData('GlAccounts', 5, 'colGLAccountCategory', 'Inventory In-Transit')
        .verifyGridData('GlAccounts', 6, 'colGLAccountCategory', 'Inventory Adjustment')
        .verifyGridData('GlAccounts', 7, 'colGLAccountCategory', 'Auto-Variance')
        .selectGridComboBoxRowValue('GlAccounts', 1, 'strAccountId', '21000-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 2, 'strAccountId', '16000-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 3, 'strAccountId', '50000-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 4, 'strAccountId', '40010-0001-006', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 5, 'strAccountId', '16050-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 6, 'strAccountId', '16040-0000-000', 'strAccountId')
        .selectGridComboBoxRowValue('GlAccounts', 7, 'strAccountId', '16010-0000-000', 'strAccountId')
        .logSuccess('Setup Item GL Accounts Successful!')

        .displayText('===== Setup Item Location=====')
        .clickTab('Location')
        .clickButton('AddLocation')
        .waitTillLoaded()
        .selectComboBoxRowValue('SubLocation', 'Raw Station', 'SubLocation',0)
        .selectComboBoxRowValue('StorageLocation', 'RM Storage', 'StorageLocation',0)
        .selectComboBoxRowValue('IssueUom', 'LB', 'IssueUom',0)
        .selectComboBoxRowValue('ReceiveUom', 'LB', 'ReceiveUom',0)
        .clickButton('Save')
        .clickButton('Close')
        .logSuccess('Setup Item Location Successful!')

        .displayText('===== Setup Item Pricing=====')
        .clickTab('Pricing')
        .waitTillLoaded()
        .verifyGridData('Pricing', 1, 'strLocationName', '0001 - Fort Wayne')
        .enterGridData('Pricing', 1, 'dblLastCost', '10')
        .enterGridData('Pricing', 1, 'dblStandardCost', '10')
        .selectGridComboBoxRowNumber('Pricing', 1, 'strPricingMethod',3)
        .enterGridData('Pricing', 1, 'dblAmountPercent', '40')
        .clickButton('Save')
        .clickButton('Close')
        .logSuccess('Setup Item Pricing Successful!')


        //region Scenario 4: Update an Item
        .displayText('===== Scenario 4: Update an Item =====')
        .clickMenuScreen('Items','Screen')
        .selectSearchRowNumber(1)
        .clickButton('OpenSelected')
        .enterData('Text Field','Description','001 - CRUD Lotted Item - Updated')
        .selectGridComboBoxRowValue('UnitOfMeasure',5,'strUnitMeasure','40 lb bag','strUnitMeasure')
        .waitTillLoaded('')
        .verifyGridData('UnitOfMeasure', 5, 'colDetailUnitQty', '40')
        .verifyStatusMessage('Edited')
        .clickButton('Save')
        .verifyStatusMessage('Saved')
        .clickButton('Close')

        /*.displayText('===== Check Updated Fields Item =====')
        .selectSearchRowNumber(1)
        .clickButton('OpenSelected')
        .verifyData('Text Field','Description','001 - CRUD Lotted Item - Updated')
        .verifyGridData('UnitOfMeasure', 1, 'colDetailUnitMeasure', '40 lb bag')
        .verifyGridData('UnitOfMeasure', 1, 'colDetailUnitQty', '40')
        .clickButton('Close')
        .logSuccess('Update an Item Successful!')*/
        //endregion


        //region Scenario 5: Duplicate an Item
        .displayText('===== Scenario 5: Duplicate an Item =====')
        .selectSearchRowNumber(1)
        .clickButton('OpenSelected')
        .clickButton('Duplicate')
        .verifyData('Text Field','ItemNo','001 - CLTI-copy')
        .verifyData('Text Field','Description','001 - CRUD Lotted Item - Updated')
        .verifyData('Combo Box','LotTracking','Yes - Serial Number')
        .verifyData('Combo Box','Category','Grains')
        .verifyData('Combo Box','Commodity','Corn')
        .verifyGridData('UnitOfMeasure', 1, 'colDetailUnitQty', '40')
        .verifyGridData('UnitOfMeasure', 2, 'colDetailUnitQty', '55.1156')
        .verifyGridData('UnitOfMeasure', 3, 'colDetailUnitQty', '50')
        .verifyGridData('UnitOfMeasure', 4, 'colDetailUnitQty', '1')
        .verifyGridData('UnitOfMeasure', 5, 'colDetailUnitQty', '56')

        .clickTab('Setup')
        .verifyGridData('GlAccounts', 1, 'colGLAccountCategory', 'Auto-Variance')
        .verifyGridData('GlAccounts', 2, 'colGLAccountCategory', 'Inventory Adjustment')
        .verifyGridData('GlAccounts', 3, 'colGLAccountCategory', 'Inventory In-Transit')
        .verifyGridData('GlAccounts', 4, 'colGLAccountCategory', 'Sales Account')
        .verifyGridData('GlAccounts', 5, 'colGLAccountCategory', 'Cost of Goods')
        .verifyGridData('GlAccounts', 6, 'colGLAccountCategory', 'Inventory')
        .verifyGridData('GlAccounts', 7, 'colGLAccountCategory', 'AP Clearing')

        .verifyGridData('GlAccounts', 7, 'colGLAccountId', '21000-0000-000')
        .verifyGridData('GlAccounts', 6, 'colGLAccountId', '16000-0000-000')
        .verifyGridData('GlAccounts', 5, 'colGLAccountId', '50000-0000-000')
        .verifyGridData('GlAccounts', 4, 'colGLAccountId', '40010-0001-006')
        .verifyGridData('GlAccounts', 3, 'colGLAccountId', '16050-0000-000')
        .verifyGridData('GlAccounts', 2, 'colGLAccountId', '16040-0000-000')
        .verifyGridData('GlAccounts', 1, 'colGLAccountId', '16010-0000-000')

        .clickTab('Location')
        .verifyGridData('LocationStore', 1, 'colLocationLocation', '0001 - Fort Wayne')

        .clickTab('Pricing')
        .waitTillLoaded()
        .verifyGridData('Pricing', 1, 'strLocationName', '0001 - Fort Wayne')
        .verifyGridData('Pricing', 1, 'strPricingMethod', 'Markup Standard Cost')
        .verifyGridData('Pricing', 1, 'dblAmountPercent', '40')
        .clickButton('Close')
        //endregion


        //region Scenario 6: Check Required Fields
        .displayText('===== Scenario 6: Check Required Fields =====')
        .clickButton('New')
        .clickButton('Save')
        .clickButton('Close')
        .verifyMessageBox('iRely i21','Do you want to save the changes you made?','yesnocancel','question')
        .clickMessageBoxButton('no')
        //endregion

        //region Scenario 7: Save Duplicate Item No.
        .displayText('===== Scenario 7: Save Duplicate Item No. =====')
        .clickMenuScreen('Items','Screen')
        .clickButton('New')
        .enterData('Text Field','ItemNo','001 - CLTI')
        .enterData('Text Field','Description','001 - CRUD Lotted Item Serial')
        .selectComboBoxRowValue('Category', 'Grains', 'Category',0)
        .selectComboBoxRowValue('Commodity', 'Corn', 'Commodity',0)
        .selectComboBoxRowNumber('LotTracking',2,0)
        .clickButton('Save')
        .verifyMessageBox('iRely i21','Item No must be unique.','ok','error')
        .clickMessageBoxButton('ok')
        .clickButton('Close')
        .verifyMessageBox('iRely i21','Do you want to save the changes you made?','yesnocancel','question')
        .clickMessageBoxButton('yes')
        .waitTillLoaded()
        .verifyMessageBox('iRely i21','Item No must be unique.','ok','error')
        .clickMessageBoxButton('ok')
        .waitTillLoaded()
        .enterData('Text Field','ItemNo','003 - CLTI')
        .enterData('Text Field','Description','003 - CRUD Lotted Item Serial')
        .clickButton('Save')
        .clickButton('Close')



        .done();

})