/**
 * Created by RQuidato on 4/24/2017.
 */
StartTest (function (t) {
    var commonGL = Ext.create('GeneralLedger.commonGL');
    var commonIC = Ext.create('Inventory.CommonIC');

    new iRely.FunctionalTest().start(t)


        //Unrealized Gain or Loss Foreign Currency
        //Account ID, Account description, Account Group, Account Category
        //36000, Unrealized Gain or Loss AP, Other Equities, Unrealized Gain or Loss Accounts Payable
        //36001, Unrealized Gain or Loss AR, Other Equities, Unrealized Gain or Loss Accounts Receivable
        //36002, Unrealized Gain or Loss IC, Other Equities, Unrealized Gain or Loss Inventory
        //36003, Unrealized Gain or Loss CP, Other Equities, Unrealized Gain or Loss Contract Purchase
        //36004, Unrealized Gain or Loss CS, Other Equities, Unrealized Gain or Loss Contract Sales
        //36005, Unrealized Gain or Loss Cash, Other Equities, Unrealized Gain or Loss Cash Management

        //Unrealized Gain or Loss Foreign Currency Offset
        //20040, Unrealized Gain or Loss OFFSET AP, Payables, Unrealized Gain or Loss Offset AP
        //12040, Unrealized Gain or Loss OFFSET AR, Receivables, Unrealized Gain or Loss Offset AR
        //16140, Unrealized Gain or Loss OFFSET IC, Inventories, Unrealized Gain or Loss Offset Inventory
        //20041, Unrealized Gain or Loss OFFSET CP, Other Payables, Unrealized Gain or Loss Offset Contract Purchase
        //12041, Unrealized Gain or Loss OFFSET CS, Other Assets, Unrealized Gain or Loss Offset Contract Sales
        //10020, Unrealized Gain or Loss OFFSET Cash, Cash Accounts, Unrealized Gain or Loss Offset CM

        //Realized Gain or Loss Accounts
        //50040, Gain or Loss AP, Other Expenses, Realized Gain or Loss Payables
        //50041, Gain or Loss AR, Other Expenses, Realized Gain or Loss Receivables



        .displayText('===== 1. Add GL Accounts =====')
        .clickMenuFolder('General Ledger')
        .waitUntilLoaded()
        .clickMenuScreen('GL Account Detail')
        .waitUntilLoaded()
        .addResult('GL Account Detail opened')

        .clickButton('Segments')
        .waitUntilLoaded()
        .verifyScreenShown('glsegmentaccounts')
        .addResult('Segment Accounts screen opened')

        .clickButton('AddSegment')
        .displayText('Add 36000 - Unrealized Gain or Loss AP Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '36000'},{column: 'strDescription',data: 'Unrealized Gain or Loss AP'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Equities','Account Group',1)
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Accounts Payable', 'Account Category',1)
        .addResult('----Add 36000- Unrealized Gain or Loss AP Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 36001 - Unrealized Gain or Loss AR Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '36001'},{column: 'strDescription',data: 'Unrealized Gain or Loss AR'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Equities','Account Group',1)
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Accounts Receivable', 'Account Category',3)
        .addResult('----Add 36001 - Unrealized Gain or Loss AR Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 36002 - Unrealized Gain or Loss IC Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '36002'},{column: 'strDescription',data: 'Unrealized Gain or Loss IC'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Equities','Account Group',1)
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Inventory', 'Account Category',1)
        .addResult('----Add 36002 - Unrealized Gain or Loss IC Primary Account Done---')

        .clickButton('AddSegment')
        .displayText('Add 36003 - Unrealized Gain or Loss CP Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '36003'},{column: 'strDescription',data: 'Unrealized Gain or Loss CP'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Equities','Account Group',2)
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Contract Purchase', 'Account Category',1)
        .addResult('----Add 36003 - Unrealized Gain or Loss CP Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 36004 - Unrealized Gain or Loss CS Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '36004'},{column: 'strDescription',data: 'Unrealized Gain or Loss CS'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Equities','Account Group',1)
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Contract Sales', 'Account Category',1)
        .addResult('----Add 36004 - Unrealized Gain or Loss CS Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 36005 - Unrealized Gain or Loss Cash Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '36005'},{column: 'strDescription',data: 'Unrealized Gain or Loss Cash'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Equities','Account Group',1)
        .waitUntilLoaded()
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Cash Management', 'Account Category',1)
        .waitUntilLoaded()
        .addResult('----Add 36005 - Unrealized Gain or Loss Cash Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 20040 - Unrealized Gain or Loss OFFSET AP Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '20040'},{column: 'strDescription',data: 'Unrealized Gain or Loss OFFSET AP'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Payables','Account Group',1)
        .waitUntilLoaded()
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Offset AP', 'Account Category',1)
        .waitUntilLoaded()
        .addResult('----Add 20040 - Unrealized Gain or Loss OFFSET AP Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 12040 - Unrealized Gain or Loss OFFSET AR Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '12040'},{column: 'strDescription',data: 'Unrealized Gain or Loss OFFSET AR'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Receivables','Account Group',1)
        .waitUntilLoaded()
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Offset AR', 'Account Category',1)
        .waitUntilLoaded()
        .addResult('----Add 12040 - Unrealized Gain or Loss OFFSET AR Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 16140 - Unrealized Gain or Loss OFFSET IC Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '16140'},{column: 'strDescription',data: 'Unrealized Gain or Loss OFFSET IC'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Inventories','Account Group',1)
        .waitUntilLoaded()
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Offset Inventory', 'Account Category',1)
        .waitUntilLoaded()
        .addResult('----Add 16140 - Unrealized Gain or Loss OFFSET IC Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 20041 - Unrealized Gain or Loss OFFSET CP Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '20041'},{column: 'strDescription',data: 'Unrealized Gain or Loss OFFSET CP'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Payables','Account Group',1)
        .waitUntilLoaded()
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Offset Contract Purchase', 'Account Category',1)
        .waitUntilLoaded()
        .addResult('----Add 20041 - Unrealized Gain or Loss OFFSET CP Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 12041 - Unrealized Gain or Loss OFFSET CS Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '12041'},{column: 'strDescription',data: 'Unrealized Gain or Loss OFFSET CS'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Assets','Account Group',1)
        .waitUntilLoaded()
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Offset Contract Sales', 'Account Category',1)
        .waitUntilLoaded()
        .addResult('----Add 12041 - Unrealized Gain or Loss OFFSET CS Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 10020 - Unrealized Gain or Loss OFFSET Cash Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '10020'},{column: 'strDescription',data: 'Unrealized Gain or Loss OFFSET Cash'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Cash Accounts','Account Group',1)
        .waitUntilLoaded()
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Unrealized Gain or Loss Offset CM', 'Account Category',1)
        .waitUntilLoaded()
        .addResult('----Add 10020 - Unrealized Gain or Loss OFFSET Cash Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 50040 - Gain or Loss AP Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '50040'},{column: 'strDescription',data: 'Gain or Loss AP'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Expenses','Account Group',1)
        .waitUntilLoaded()
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Realized Gain or Loss Payables', 'Account Category',1)
        .waitUntilLoaded()
        .addResult('----Add 50040 - Gain or Loss AP Primary Account Done----')

        .clickButton('AddSegment')
        .displayText('Add 50041 - Gain or Loss AR Primary Account')
        .waitUntilLoaded()
        .enterGridNewRow('SegmentAccounts', [{column: 'strCode',data: '50041'},{column: 'strDescription',data: 'Gain or Loss AR'}])
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountGroup','Other Expenses','Account Group',1)
        .waitUntilLoaded()
        .selectGridComboBoxBottomRowValue('SegmentAccounts','strAccountCategory','Realized Gain or Loss Receivables', 'Account Category',1)
        .waitUntilLoaded()
        .addResult('----Add 50041 - Gain or Loss AR Primary Account Done----')

        .clickButton('Save')
        .clickButton('Close')

        //code, location, lob, desc, account group, account category, location name, lob bame, currency
//        .addFunction(function(next){commonGL.buildAccount(t, next, '36000', '0001', '001', 'Unrealized Gain or Loss AP', 'Other Equities','Unrealized Gain or Loss Accounts Payable', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '36001', '0001', '001', 'Unrealized Gain or Loss AR', 'Other Equities','Unrealized Gain or Loss Accounts Receivable', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '36002', '0001', '001', 'Unrealized Gain or Loss IC', 'Other Equities','Unrealized Gain or Loss Inventory', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '36003', '0001', '001', 'Unrealized Gain or Loss CP', 'Other Equities','Unrealized Gain or Loss Contract Purchase', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '36004', '0001', '001', 'Unrealized Gain or Loss CS', 'Other Equities','Unrealized Gain or Loss Contract Sales', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '36005', '0001', '001', 'Unrealized Gain or Loss Cash', 'Other Equities','Unrealized Gain or Loss Cash Management', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '20040', '0001', '001', 'Unrealized Gain or Loss OFFSET AP', 'Payables','Unrealized Gain or Loss Offset AP', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '12040', '0001', '001', 'Unrealized Gain or Loss OFFSET AR', 'Receivables','Unrealized Gain or Loss Offset AR', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '16140', '0001', '001', 'Unrealized Gain or Loss OFFSET IC', 'Inventories','Unrealized Gain or Loss Offset Inventory', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '20041', '0001', '001', 'Unrealized Gain or Loss OFFSET CP', 'Other Payables','Unrealized Gain or Loss Offset Contract Purchase', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '12041', '0001', '001', 'Unrealized Gain or Loss OFFSET CS', 'Other Assets','Unrealized Gain or Loss Offset Contract Sale', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '10020', '0001', '001', 'Unrealized Gain or Loss OFFSET Cash', 'Cash Accounts','Unrealized Gain or Loss Offset Contract CM', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '50040', '0001', '001', 'Gain or Loss AP', 'Other Expenses','Realized Gain or Loss Payables', 'Fort Wayne','Grains','USD',1,1)})
//        .addFunction(function(next){commonGL.buildAccount(t, next, '50041', '0001', '001', 'Gain or Loss AR', 'Other Expenses','Realized Gain or Loss Receivables', 'Fort Wayne','Grains','USD',1,1)})

        .addFunction(function(next){commonGL.buildAccount(t, next, '36000', '0002', '001', 'Unrealized Gain or Loss AP', 'Other Equities','Unrealized Gain or Loss Accounts Payable', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '36001', '0002', '001', 'Unrealized Gain or Loss AR', 'Other Equities','Unrealized Gain or Loss Accounts Receivable', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '36002', '0002', '001', 'Unrealized Gain or Loss IC', 'Other Equities','Unrealized Gain or Loss Inventory', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '36003', '0002', '001', 'Unrealized Gain or Loss CP', 'Other Equities','Unrealized Gain or Loss Contract Purchase', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '36004', '0002', '001', 'Unrealized Gain or Loss CS', 'Other Equities','Unrealized Gain or Loss Contract Sales', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '36005', '0002', '001', 'Unrealized Gain or Loss Cash', 'Other Equities','Unrealized Gain or Loss Cash Management', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '20040', '0002', '001', 'Unrealized Gain or Loss OFFSET AP', 'Payables','Unrealized Gain or Loss Offset AP', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '12040', '0002', '001', 'Unrealized Gain or Loss OFFSET AR', 'Receivables','Unrealized Gain or Loss Offset AR', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '16140', '0002', '001', 'Unrealized Gain or Loss OFFSET IC', 'Inventories','Unrealized Gain or Loss Offset Inventory', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '20041', '0002', '001', 'Unrealized Gain or Loss OFFSET CP', 'Other Payables','Unrealized Gain or Loss Offset Contract Purchase', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '12041', '0002', '001', 'Unrealized Gain or Loss OFFSET CS', 'Other Assets','Unrealized Gain or Loss Offset Contract Sale', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '10020', '0002', '001', 'Unrealized Gain or Loss OFFSET Cash', 'Cash Accounts','Unrealized Gain or Loss Offset Contract CM', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '50040', '0002', '001', 'Gain or Loss AP', 'Other Expenses','Realized Gain or Loss Payables', 'Indianapolis','Grains','USD',1,1)})
        .addFunction(function(next){commonGL.buildAccount(t, next, '50041', '0002', '001', 'Gain or Loss AR', 'Other Expenses','Realized Gain or Loss Receivables', 'Indianapolis','Grains','USD',1,1)})

        .displayText('===== 1. Add GL Accounts DONE =====')
        .clickMenuFolder('General Ledger')
        .waitUntilLoaded()

        .displayText('===== 2. Set Default Location to 0002 - Indianapolis  =====')
        .clickMenuFolder('System Manager','Folder')
        .waitUntilLoaded('',3000)
        .clickMenuScreen('Users','Screen')
        .waitUntilLoaded('',3000)
        .doubleClickSearchRowValue('irelyadmin', 1)
        .waitUntilLoaded('ementity',3000)
        .waitUntilLoaded('ementity',3000)
        .waitUntilLoaded('ementity',3000)
        .waitUntilLoaded('ementity',3000)
        .addResult('User record opened',3000)
        .clickTab('User')
        .waitUntilLoaded('',3000)
        .selectComboBoxRowValue('UserDefaultLocation', '0002 - Indianapolis', 'Location Name',1)
        .clickButton('Save')
        .waitUntilLoaded('',3000)
        .waitUntilLoaded('',3000)
        .waitUntilLoaded('',3000)
        .clickButton('Close')
        .waitUntilLoaded('',3000)
        .waitUntilLoaded('',3000)
        .displayText('===== 2. Set Default Location to 0002 - Indianapolis DONE =====')
        .clickMenuFolder('System Manager','Folder')
        .waitUntilLoaded()

        //3. Configure Currency Exchange Rate Type


        .displayText('===== 4. Configure Currency Exchange Rates =====')
        .clickMenuFolder('Common Info','Folder')
        .waitUntilLoaded('',3000)
        .clickMenuScreen('Currency Exchange Rates','Screen')
        .waitUntilLoaded('smcurrencyexchangerate',3000)

        .displayText('===== 4a. Add EUR > USD =====')
        .selectGridComboBoxRowValue('CurrencyExchangeRate',5,'colFromCurrency','EUR','strFromCurrency',1)
        .selectGridComboBoxRowValue('CurrencyExchangeRate',5,'colToCurrency','USD','strToCurrency',1)
        .enterGridData('CurrencyExchangeRateDetail', 1, 'dblRate', '1.08')
        .selectGridComboBoxRowValue('CurrencyExchangeRateDetail',1,'colRateType','Spot','strRateType',1)
        .enterGridData('CurrencyExchangeRateDetail', 1, 'dtmValidFromDate', '4/30/2016')

        .enterGridData('CurrencyExchangeRateDetail', 2, 'dblRate', '1.06115')
        .selectGridComboBoxRowValue('CurrencyExchangeRateDetail',2,'colRateType','Spot','strRateType',1)
        .addFunction (function (next){
        var date = new Date().toLocaleDateString();
        new iRely.FunctionalTest().start(t, next)
            .selectGridComboBoxRowValue('CurrencyExchangeRateDetail',2,'colEffectiveDate',date,'dtmValidFromDate', 0, 10)
            .done();
    })
        .displayText('===== 4a. Add EUR > USD DONE =====')

        .displayText('===== 4b. Add GBP > USD =====')
        .selectGridComboBoxRowValue('CurrencyExchangeRate',6,'colFromCurrency','GBP','strFromCurrency',1)
        .selectGridComboBoxRowValue('CurrencyExchangeRate',6,'colToCurrency','USD','strToCurrency',1)
        .enterGridData('CurrencyExchangeRateDetail', 1, 'dblRate', '1.24553')
        .selectGridComboBoxRowValue('CurrencyExchangeRateDetail',1,'colRateType','Spot','strRateType',1)
        .addFunction (function (next){
        var date = new Date().toLocaleDateString();
        new iRely.FunctionalTest().start(t, next)
            .selectGridComboBoxRowValue('CurrencyExchangeRateDetail',1,'colEffectiveDate',date,'dtmValidFromDate', 0, 10)
            .done();
    })
        .displayText('===== 4b. Add GBP > USD DONE =====')

        .displayText('===== 4c. Add GBP > EUR =====')
        .selectGridComboBoxRowValue('CurrencyExchangeRate',7,'colFromCurrency','GBP','strFromCurrency',1)
        .selectGridComboBoxRowValue('CurrencyExchangeRate',7,'colToCurrency','EUR','strToCurrency',1)
        .enterGridData('CurrencyExchangeRateDetail', 1, 'dblRate', '1.17797323')
        .selectGridComboBoxRowValue('CurrencyExchangeRateDetail',1,'colRateType','Spot','strRateType',1)
        .addFunction (function (next){
        var date = new Date().toLocaleDateString();
        new iRely.FunctionalTest().start(t, next)
            .selectGridComboBoxRowValue('CurrencyExchangeRateDetail',1,'colEffectiveDate',date,'dtmValidFromDate', 0, 10)
            .done();
    })
        .displayText('===== 4c. Add GBP > EUR DONE =====')
        .clickButton('Save')
        .waitUntilLoaded('',3000)
        .clickButton('Close')
        .waitUntilLoaded('',3000)
        .displayText('===== 4. Configure Currency Exchange Rates DONE =====')
        .clickMenuFolder('Common Info','Folder')

        .displayText('===== 5. Assign default AR account in the Company Configuration  =====')
        .clickMenuFolder('System Manager','Folder')
        .waitUntilLoaded('',3000)
        .clickMenuScreen('Company Configuration','Screen')
        .waitUntilLoaded('smcompanypreference',3000)
        .waitUntilLoaded('smcompanypreference',3000)
        .waitUntilLoaded('smcompanypreference',3000)
        .waitUntilLoaded('smcompanypreference',3000)
        .selectGridRowNumber('Settings',1)
        .waitUntilLoaded('',3000)
        .clickTab('System Manager')
        .clickTab('Details')
        .selectComboBoxRowValue('Currency','USD', 'DefaultCurrencyId', 1,1)
        .selectComboBoxRowNumber('CurrencyDecimals',7)
        .clickTab('Multi Currency')
        .displayText('===== 5a. Set Default Rate Types  =====')
        .selectComboBoxRowValue('AccountsPayableRateType','Spot', 'AccountsPayableRateTypeId', 1,1)
        .selectComboBoxRowValue('CashManagementRateType','Spot', 'CashManagementRateTypeId', 1,1)
        .selectComboBoxRowValue('InventoryRateType','Spot', 'InventoryRateTypeId', 1,1)
        .selectComboBoxRowValue('ContractRateType','Spot', 'ContractRateTypeId', 1,1)
        .selectComboBoxRowValue('AccountsReceivableRateType','Spot', 'AccountsReceivableRateTypeId', 1,1)
        .selectComboBoxRowValue('GeneralJournalRateType','Spot', 'GeneralJournalRateTypeId', 1,1)
        .displayText('===== 5a. Set Default Rate Types Done  =====')

        .displayText('===== 5b. Set Unrealized Gain or Loss Foreign Currency  =====')
        .selectComboBoxRowValue('AccountsPayableUnrealized','36000-0002-001', 'AccountsPayableUnrealizedId', 1,1)
        .selectComboBoxRowValue('AccountsReceivableUnrealized','36001-0002-001', 'AccountsReceivableUnrealizedId', 1,1)
        .selectComboBoxRowValue('InventoryUnrealized','36002-0002-001', 'InventoryUnrealizedId', 1,1)
        .selectComboBoxRowValue('ContractPurchaseUnrealized','36003-0002-001', 'ContractPurchaseUnrealizedId', 1,1)
        .selectComboBoxRowValue('ContractSaleUnrealized','36004-0002-001', 'ContractSaleUnrealizedId', 1,1)
        .selectComboBoxRowValue('CashManagementUnrealized','36005-0002-001', 'CashManagementUnrealizedId', 1,1)
        .displayText('===== 5b. Set Unrealized Gain or Loss Foreign Currency Done  =====')

        .displayText('===== 5c. Set Unrealized Gain or Loss Foreign Currency Offset =====')

        .selectComboBoxRowValue('AccountsPayableOffset','20040-0002-001', 'AccountsPayableOffsetId', 1,1)
        .selectComboBoxRowValue('AccountsReceivableOffset','12040-0002-001', 'AccountsReceivableOffsetId', 1,1)
        .selectComboBoxRowValue('InventoryOffset','16140-0002-001', 'InventoryOffsetId', 1,1)
        .selectComboBoxRowValue('ContractPurchaseOffset','20041-0002-001', 'ContractPurchaseOffsetId', 1,1)
        .selectComboBoxRowValue('ContractSaleOffset','12041-0002-001', 'ContractSaleOffsetId', 1,1)
        .selectComboBoxRowValue('CashManagementOffset','10020-0002-001', 'CashManagementOffsetId', 1,1)
        .displayText('===== 5c. Set Unrealized Gain or Loss Foreign Currency Offset DONE  =====')

        .displayText('===== 5d. Set Realized Gain or Loss Accounts =====')
        .selectComboBoxRowValue('AccountsPayableRealized','50040-0002-001', 'AccountsPayableRealizedId', 1,1)
        .selectComboBoxRowValue('AccountsReceivableRealized','50041-0002-001', 'AccountsReceivableRealizedId', 1,1)
        .displayText('===== 5d. Set Realized Gain or Loss Accounts Done  =====')

        .clickButton('Ok')
        .waitUntilLoaded('',3000)
        .displayText('===== 5. Assign default AR account in the Company Configuration DONE =====')
        .clickMenuFolder('System Manager','Folder')
        .waitUntilLoaded()


        //Add Vendors
        .displayText('===== 6. Add MC Vendors =====')
        .displayText('===== 6a. Create ItemVendor MC-1 =====')
        .clickMenuFolder('Purchasing (Accounts Payable)')
        .waitUntilLoaded('',3000)
        .clickMenuScreen('Vendors')
        .waitUntilLoaded('',3000)
        .clickButton('New')
        .waitUntilLoaded('emcreatenewentity',3000)
        .enterData('Text Field','Name','ItemVendor MC-1')
        .enterData('Text Field','Contact','ItemVendor MC-1-C1')
        .enterData('Text Field','Phone','1234567890')
        .enterData('Text Field','Email','rufil.cabangal@gmail.com')
        .enterData('Text Field','Address','123 Wide Street')
        .enterData('Text Field','City','Richmond')
        .enterData('Text Field','State','IN')
        .enterData('Text Field','ZipCode','47374')
        .selectComboBoxRowValue('Timezone', '(UTC-05:00) Indiana (East)', 'Timezone',0)
        .clickButton('Match')
        .waitUntilLoaded('emduplicateentities',3000)
        .clickButton('Add')
        .enterData('Text Field','Location','Vendor MC-1-Loc1')
        .clickTab('Vendor')
        .waitUntilLoaded('')
        .selectComboBoxRowValue('VendorCurrency', 'EUR', 'CurrencyId',1)
        .selectGridComboBoxRowValue('VendorTerm',1,'colVendorTerms','Net 30','strTerm',5)
        .selectComboBoxRowValue('VendorTerms', 'Net 30', 'VendorTerms',5)
        .clickButton('Save')
        .waitUntilLoaded('',3000)
        .displayText('===== 6a. Create ItemVendor MC-1 Done =====')

        .displayText('===== 6b. Create Trucker Vendor MC-1 =====')
        .clickButton('New')
        .waitUntilLoaded('emcreatenewentity',3000)
        .enterData('Text Field','Name','Trucker MC-1')
        .enterData('Text Field','Contact','Trucker MC-1-C1')
        .enterData('Text Field','Phone','1234567890')
        .enterData('Text Field','Email','rufil.cabangal@gmail.com')
        .enterData('Text Field','Address','123 Wide Street')
        .enterData('Text Field','City','Richmond')
        .enterData('Text Field','State','IN')
        .enterData('Text Field','ZipCode','47374')
        .selectComboBoxRowValue('Timezone', '(UTC-05:00) Indiana (East)', 'Timezone',0)
        .clickButton('Match')
        .waitUntilLoaded('emduplicateentities',3000)
        .clickButton('Add')
        .enterData('Text Field','Location','Trucker MC-1-Loc1')
        .clickTab('Vendor')
        .waitUntilLoaded('')
        .selectComboBoxRowValue('VendorCurrency', 'EUR', 'CurrencyId',1)
        .selectGridComboBoxRowValue('VendorTerm',1,'colVendorTerms','Net 30','strTerm',5)
        .selectComboBoxRowValue('VendorTerms', 'Net 30', 'VendorTerms',5)
        .clickButton('Save')
        .waitUntilLoaded('',3000)
        .clickButton('Close')
        .waitUntilLoaded('',3000)
        .displayText('===== 6b. Create Trucker Vendor MC-1 Done =====')
        .clickMenuFolder('Purchasing (Accounts Payable)')
        .displayText('===== 6. Add MC Vendors DONE =====')


        .displayText('===== 7. Create Customer =====')
        .clickMenuFolder('Sales (Accounts Receivable)')
        .waitUntilLoaded('',3000)
        .clickMenuScreen('Customers')
        .waitUntilLoaded('',3000)
        .clickButton('New')
        .waitUntilLoaded('emcreatenewentity',3000)
        .enterData('Text Field','Name','Customer MC-1')
        .enterData('Text Field','Contact','Customer MC-1-C1')
        .enterData('Text Field','Phone','0123456789')
        .enterData('Text Field','Email','rufil.cabangal@gmail.com')
        .enterData('Text Field','Address','456 Flower Drive')
        .enterData('Text Field','City','Richmond')
        .enterData('Text Field','State','IN')
        .enterData('Text Field','ZipCode','47374')
        .selectComboBoxRowValue('Timezone', '(UTC-05:00) Indiana (East)', 'Timezone',0)
        .clickButton('Match')
        .waitUntilLoaded('emduplicateentities',3000)
        .clickButton('Add')
        .enterData('Text Field','Location','Customer MC-1-Loc1')
        .clickTab('Customer')
        .waitUntilLoaded('',3000)
        .selectComboBoxRowValue('CustomerCurrency', 'EUR', 'CurrencyId',1)
        .selectComboBoxRowValue('CustomerTerms', 'Net 30', 'CustomerTerms',5)
        .selectComboBoxRowNumber('CustomerSalesperson',1,0)
        .clickTab('Locations')
        .selectGridRowNumber('Location',1)
        .clickButton('EditLoc')
        .waitUntilLoaded('',3000)
        .selectComboBoxRowValue('Country', 'United States', 'Country',1)
        .selectComboBoxRowValue('ShipVia', 'UPS', 'ShipVia',1)
        //.selectComboBoxRowValue('TaxGroup', 'Test Group 1', 'TaxGroup',0)
        .selectComboBoxRowValue('Terms', 'Net 30', 'Terms',5)
        .selectComboBoxRowValue('Warehouse', '0002 - Indianapolis', 'Warehouse',1)
        .selectComboBoxRowValue('FreightTerm', 'Deliver', 'FreightTerm',1)
        .clickButton('Save')
        .waitUntilLoaded('',3000)
        .clickButton('Close')
        .waitUntilLoaded('',3000)
        .clickButton('Save')
        .waitUntilLoaded('',3000)
        .clickButton('Close')
        .waitUntilLoaded('',3000)
        .displayText('===== 7. Create Customer DONE =====')
        .clickMenuFolder('Sales (Accounts Receivable)')



        //Add Category - Inventory Type
        .displayText('===== 8. Add New Category - Inventory Type =====')
        .clickMenuFolder('Inventory','Folder')
        .clickMenuScreen('Categories','Screen')
        .waitUntilLoaded('',3000)
        .clickButton('New')
        .waitUntilLoaded('iccategory',3000)
        .enterData('Text Field','CategoryCode','MC Category-1')
        .enterData('Text Field','Description','MC Category-1 desc')
        .selectComboBoxRowNumber('InventoryType',2,0)
        .selectComboBoxRowNumber('CostingMethod',2,0)

        .displayText('===== Setup GL Accounts=====')
        .clickTab('GL Accounts')
        .waitUntilLoaded('',3000)
        .clickButton('AddRequired')
        .waitUntilLoaded('',3000)
        .verifyGridData('GlAccounts', 1, 'colAccountCategory', 'AP Clearing')
        .verifyGridData('GlAccounts', 2, 'colAccountCategory', 'Inventory')
        .verifyGridData('GlAccounts', 3, 'colAccountCategory', 'Cost of Goods')
        .verifyGridData('GlAccounts', 4, 'colAccountCategory', 'Sales Account')
        .verifyGridData('GlAccounts', 5, 'colAccountCategory', 'Inventory In-Transit')
        .verifyGridData('GlAccounts', 6, 'colAccountCategory', 'Inventory Adjustment')
//        .verifyGridData('GlAccounts', 7, 'colAccountCategory', 'Auto-Variance')
        .selectGridComboBoxRowValue('GlAccounts', 1, 'colAccountId', '20022-0001-001', 'strAccountId',1)
        .selectGridComboBoxRowValue('GlAccounts', 2, 'colAccountId', '15012-0001-001', 'strAccountId',1)
        .selectGridComboBoxRowValue('GlAccounts', 3, 'colAccountId', '50012-0001-001', 'strAccountId',1)
        .selectGridComboBoxRowValue('GlAccounts', 4, 'colAccountId', '40012-0001-001', 'strAccountId',1)
        .selectGridComboBoxRowValue('GlAccounts', 5, 'colAccountId', '16012-0001-001', 'strAccountId',1)
        .selectGridComboBoxRowValue('GlAccounts', 6, 'colAccountId', '50022-0001-001', 'strAccountId',1)
//        .selectGridComboBoxRowValue('GlAccounts', 7, 'colAccountId', '50032-0001-001', 'strAccountId',1)
        .clickButton('Save')
        .waitUntilLoaded('',3000)
        .clickButton('Close')
        .waitUntilLoaded('',3000)
        .displayText('===== 8. Add New Category - Inventory Type DONE =====')


        //Add Item
        .displayText('===== 9. Add Item =====')
        .clickMenuFolder('Inventory','Folder')
        .clickMenuScreen('Items','Screen')
        .waitUntilLoaded('',3000)
        .clickButton('New')
        .waitUntilLoaded('icitem',3000)
        .enterData('Text Field','ItemNo','Item MC-1')
        .enterData('Text Field','Description','Item MC-1 desc')
        .selectComboBoxRowValue('Type', 'Inventory', 'Type',1)
        .selectComboBoxRowValue('Category', 'MC Category-1', 'Category',1)
        .selectComboBoxRowValue('Commodity', 'Commodity1', 'Commodity',1)
        .selectComboBoxRowNumber('LotTracking',4,0)
        .verifyData('Combo Box','Tracking','Item Level')

        .displayText('===== Setup Item UOM =====')
        .verifyGridData('UnitOfMeasure', 1, 'colDetailUnitQty', '1.000000')
        .verifyGridData('UnitOfMeasure', 2, 'colDetailUnitQty', '10.000000')
        .verifyGridData('UnitOfMeasure', 3, 'colDetailUnitQty', '2.204620')


        .displayText('===== Setup Item Location=====')
        .clickTab('Setup')
        .waitUntilLoaded('',3000)
        .clickTab('Location')
        .clickButton('AddLocation')
        .waitUntilLoaded('icitemlocation',3000)
        .selectComboBoxRowValue('Location', '0002 - Indianapolis', 'Location',0)
        .selectComboBoxRowValue('SubLocation', 'Indy', 'SubLocation',0)
        .selectComboBoxRowValue('StorageLocation', 'Indy Storage', 'StorageLocation',0)
        .selectComboBoxRowValue('IssueUom', 'lb1', 'IssueUom',0)
        .selectComboBoxRowValue('ReceiveUom', 'lb1', 'ReceiveUom',0)
        .clickButton('Save')
        .waitUntilLoaded('',3000)
        .clickButton('Close')
        .waitUntilLoaded('',3000)
        .displayText('===== Setup Item Location - 0002 Done=====')

        .displayText('===== Setup Item Pricing=====')
        .clickTab('Pricing')
        .waitUntilLoaded('')
        .verifyGridData('Pricing', 1, 'strLocationName', '0002 - Indianapolis')
        .enterGridData('Pricing', 1, 'dblLastCost', '10')
        .enterGridData('Pricing', 1, 'dblStandardCost', '10')
        .selectGridComboBoxRowNumber('Pricing', 1, 'strPricingMethod',3)
        .enterGridData('Pricing', 1, 'dblAmountPercent', '40')
        .waitUntilLoaded('')
        .verifyGridData('Pricing', 1, 'dblSalePrice', '14')

        .clickButton('Save')
        .waitUntilLoaded('',3000)
        .clickButton('Close')
        .waitUntilLoaded('',3000)
        .displayText('===== Setup Item Pricing Done=====')
        .displayText('===== 9. Add Item DONE =====')

        .done()
});