CREATE VIEW vyuQMContractSamplesMonitoring AS 

WITH QUERY AS
(
   SELECT
      strAllocationNumber,
      intAllocationDetailId,
      dtmStartDateP,
      dtmEndDateP,
      intSequenceP,
      intSequenceS,
      dtmStartDateS,
      dtmEndDateS,
      intContractDetailIdP,
      strContractNumberP,
      intContractDetailIdS,
      strContractNumberS,
      dblSAllocatedQty,
      dblPAllocatedQty,
      intSampleIdP,
      strEntityNameP,
      dblSampleQtyP,
      strSampleUOMP,
      dblNetWeightP,
      strNetWeightUOMP,
      dblRepresentingQtyP,
      strItemNoP,
      strDescriptionP,
      strSampleNumberP,
      strSampleTypeP,
      strSamplingCriteriaP,
      dtmSamplingEndDateP,
      dtmRequestedDateP,
      dtmSampleSentDateP,
      strCourierP,
      dtmSampleReceivedDateP,
      strStatusP,
      strLotNumberP,
      strFreightTermP,
      strINCOLocationP,
      intContractStatusIdP,
      intContractHeaderIdP,
      intSampleIdS,
      dblSampleQtyS,
      strSampleUOMS,
      dblRepresentingQtyS,
      strItemNoS,
      strDescriptionS,
      strSampleNumberS,
      strSampleTypeS,
      strSamplingCriteriaS,
      dtmSamplingEndDateS,
      dtmRequestedDateS,
      dtmSampleSentDateS,
      strCourierS,
      dtmSampleReceivedDateS,
      strStatusS,
      strLotNumberS,
      strEntityNameS,
      dblNetWeightS,
      strNetWeightUOMS,
      strFreightTermS,
      strINCOLocationS,
      intContractStatusIdS,
      intContractHeaderIdS 
   FROM
      vyuQMPurchaseSampleLinked
   UNION
   SELECT
      strAllocationNumber,
      intAllocationDetailId,
      dtmStartDateP,
      dtmEndDateP,
      intSequenceP,
      intSequenceS,
      dtmStartDateS,
      dtmEndDateS,
      intContractDetailIdP,
      strContractNumberP,
      intContractDetailIdS,
      strContractNumberS,
      dblSAllocatedQty,
      dblPAllocatedQty,
      intSampleIdP,
      strEntityNameP,
      dblSampleQtyP,
      strSampleUOMP,
      dblNetWeightP,
      strNetWeightUOMP,
      dblRepresentingQtyP,
      strDescriptionP,
      strItemNoP,
      strSampleNumberP,
      strSampleTypeP,
      strSamplingCriteriaP,
      dtmSamplingEndDateP,
      dtmRequestedDateP,
      dtmSampleSentDateP,
      strCourierP,
      dtmSampleReceivedDateP,
      strStatusP,
      strLotNumberP,
      strFreightTermP,
      strINCOLocationP,
      intContractStatusIdP,
      intContractHeaderIdP,
      intSampleIdS,
      dblSampleQtyS,
      strSampleUOMS,
      dblRepresentingQtyS,
      strItemNoS,
      strDescriptionS,
      strSampleNumberS,
      strSampleTypeS,
      strSamplingCriteriaS,
      dtmSamplingEndDateS,
      dtmRequestedDateS,
      dtmSampleSentDateS,
      strCourierS,
      dtmSampleReceivedDateS,
      strStatusS,
      strLotNumberS,
      strEntityNameS,
      dblNetWeightS,
      strNetWeightUOMS,
      strFreightTermS,
      strINCOLocationS,
      intContractStatusIdS,
      intContractHeaderIdS 
   FROM
      vyuQMSaleSampleNotLinked 
),
_orderQuery as(
SELECT
   CAST(ROW_NUMBER () OVER (
ORDER BY intContractDetailIdP DESC, intContractDetailIdS DESC) AS INT)  rowId, * 
FROM
   QUERY
)

SELECT * FROM _orderQuery