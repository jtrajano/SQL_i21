CREATE TABLE [dbo].[tblSMUserSecurity] (
    --[intEntityUserSecurityId] INT            IDENTITY (1, 1) NOT NULL,
	[intEntityId]		INT NOT NULL,
    [intUserRoleID]					INT NULL,
	[intCompanyLocationId]			INT NULL,
	[intSecurityPolicyId]			INT NULL,
    [strUserName]					NVARCHAR (50)  COLLATE Latin1_General_CI_AS DEFAULT ('') NOT NULL,
	[strJIRAUserName]				NVARCHAR (50)  COLLATE Latin1_General_CI_AS DEFAULT ('') NOT NULL,
    [strFullName]					NVARCHAR (50)  COLLATE Latin1_General_CI_AS DEFAULT ('') NOT NULL,
    [strPassword]					NVARCHAR (MAX)  COLLATE Latin1_General_CI_AS DEFAULT ('') NOT NULL,
	[strOverridePassword]			NVARCHAR (50)  COLLATE Latin1_General_CI_AS DEFAULT ('') NULL,
	[strDashboardRole]				NVARCHAR (50)  COLLATE Latin1_General_CI_AS DEFAULT ('') NULL,
    [strFirstName]					NVARCHAR (50)  COLLATE Latin1_General_CI_AS DEFAULT ('') NULL,
    [strMiddleName]					NVARCHAR (50)  COLLATE Latin1_General_CI_AS NULL DEFAULT (''),
    [strLastName]					NVARCHAR (50)  COLLATE Latin1_General_CI_AS DEFAULT ('') NULL,
    [strPhone]						NVARCHAR (50)  COLLATE Latin1_General_CI_AS NULL DEFAULT (''),
    [strDepartment]					NVARCHAR (50)  COLLATE Latin1_General_CI_AS NULL DEFAULT (''),
    [strLocation]					NVARCHAR (50)  COLLATE Latin1_General_CI_AS NULL DEFAULT (''),
    [strEmail]						NVARCHAR (50)  COLLATE Latin1_General_CI_AS NULL,
    [strMenuPermission]				NVARCHAR (MAX) COLLATE Latin1_General_CI_AS NULL DEFAULT (''),
    [strMenu]						NVARCHAR (MAX) COLLATE Latin1_General_CI_AS DEFAULT ('') NULL,
    [strForm]						NVARCHAR (MAX) COLLATE Latin1_General_CI_AS NULL DEFAULT (''),
    [strFavorite]					NVARCHAR (MAX) COLLATE Latin1_General_CI_AS DEFAULT ('') NULL,
    [ysnDisabled]					BIT DEFAULT ((0)) NOT NULL,
    [ysnAdmin]						BIT	DEFAULT ((0)) NOT NULL,
	[ysnRequirePurchasingApproval]	BIT	DEFAULT ((0)) NOT NULL,
    [strDateFormat]					NVARCHAR(100) COLLATE Latin1_General_CI_AS NULL,
    [strNumberFormat]				NVARCHAR(100) COLLATE Latin1_General_CI_AS NULL,
	[intInvalidAttempt]				INT NOT NULL DEFAULT 0,
	[ysnLockedOut]					BIT NOT NULL DEFAULT 0,
	[dtmLockOutTime]				DATETIME NULL,
	[strEmployeeOriginId]			NVARCHAR(10) COLLATE Latin1_General_CI_AS NULL,
	[ysnStoreManager]				BIT NOT NULL DEFAULT(0), 

	[dtmScaleDate]					DATE NULL,
	[intEntityScaleOperatorId]		INT  NULL,

    [intConcurrencyId]				INT	DEFAULT (1) NOT NULL,
	[intEntityIdOld]				INT NULL,
	[intUserSecurityIdOld]			INT NULL,
	[ysnSecurityPolicyUpdated]		BIT DEFAULT ((0)) NOT NULL,
    CONSTRAINT [PK_User] PRIMARY KEY CLUSTERED ([intEntityId] ASC),
    CONSTRAINT [FK_UserSecurity_tblSMSecurityPolicy] FOREIGN KEY ([intSecurityPolicyId]) REFERENCES [dbo].[tblSMSecurityPolicy] ([intSecurityPolicyId]),
    CONSTRAINT [FK_UserSecurity_UserRole] FOREIGN KEY ([intUserRoleID]) REFERENCES [dbo].[tblSMUserRole] ([intUserRoleID]),
	CONSTRAINT [FK_UserSecurity_Entity] FOREIGN KEY ([intEntityId]) REFERENCES [dbo].tblEMEntity ([intEntityId]) ON DELETE CASCADE,
	CONSTRAINT [FK_UserSecurity_CompanyLocation] FOREIGN KEY ([intCompanyLocationId]) REFERENCES [dbo].[tblSMCompanyLocation] ([intCompanyLocationId]), 
    CONSTRAINT [AK_tblSMUserSecurity_strUserName] UNIQUE ([strUserName]) --this use in an sp named uspEMMergeEntity, any change in name should also be applied there MCG 
);


GO
