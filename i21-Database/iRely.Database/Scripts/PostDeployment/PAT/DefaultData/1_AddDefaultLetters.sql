GO
PRINT N'*** BEGIN - INSERT DEFAULT PATRONAGE LETTER ***'
GO
SET IDENTITY_INSERT [dbo].[tblSMLetter] ON 

DECLARE @intLetterID INT
DECLARE @recordCount INT

SELECT @recordCount = COUNT(*) FROM tblSMLetter  

IF EXISTS (SELECT * FROM tblSMLetter WHERE strName  = 'Patronage Refund Letter')
	BEGIN
		UPDATE [dbo].[tblSMLetter] 
		SET [strName]				= 'Patronage Refund Letter'
			, [strDescription]		= 'Refund Letter'
			, [blbMessage]			= 0x3C703E0A0944656172266E6273703B5B456E746974794E616D655D2C3C2F703E3C703E0A0954686520656E636C6F73656420636865636B20697320796F7572207368617265206F66206361736820706174726F6E6167652070616964206261636B20746F206F7572206D656D6265727320666F72207468652066697363616C20796561722E3C2F703E3C703E0A095468616E6B732C0A093C62723E0A09436F6F703C2F703E
			, [ysnSystemDefined]	= 1
			, [strModuleName]		= 'Patronage'
			, [intConcurrencyId]	= 0			
		WHERE 
			strName  = 'Patronage Refund Letter'
	END
ELSE
	BEGIN
		SELECT @intLetterID = MAX(intLetterId) + 1 FROM tblSMLetter 
		INSERT [dbo].[tblSMLetter] 
		(
			[intLetterId]
			, [strName]
			, [strDescription]
			, [blbMessage]
			, [ysnSystemDefined]
			, [strModuleName]
			, [intConcurrencyId]
		) 
		VALUES 
		(
			@intLetterID
			, N'Patronage Refund Letter'
			, N'Refund Letter'
			, 0x3C703E0A0944656172266E6273703B5B456E746974794E616D655D2C3C2F703E3C703E0A0954686520656E636C6F73656420636865636B20697320796F7572207368617265206F66206361736820706174726F6E6167652070616964206261636B20746F206F7572206D656D6265727320666F72207468652066697363616C20796561722E3C2F703E3C703E0A095468616E6B732C0A093C62723E0A09436F6F703C2F703E
			, 1
			, N'Patronage'
			, 0
		)
	END

SET IDENTITY_INSERT [dbo].[tblSMLetter] OFF
GO
PRINT N'*** END - INSERT DEFAULT PATRONAGE LETTER ***'
GO